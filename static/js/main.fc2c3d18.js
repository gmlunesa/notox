/*! For license information please see main.fc2c3d18.js.LICENSE.txt */
!function(){var e={110:function(e,t,n){"use strict";var r=n(309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var a=d(n);a&&a!==p&&e(t,a,r)}var o=l(n);f&&(o=o.concat(f(n)));for(var s=u(t),v=u(n),m=0;m<o.length;++m){var g=o[m];if(!i[g]&&(!r||!r[g])&&(!v||!v[g])&&(!s||!s[g])){var y=h(n,g);try{c(t,g,y)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case i:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case c:case h:case m:case v:case u:return e;default:return t}}case a:return t}}}function k(e){return w(e)===f}t.AsyncMode=l,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=h,t.Fragment=i,t.Lazy=m,t.Memo=v,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return k(e)||w(e)===l},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===v},t.isPortal=function(e){return w(e)===a},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===d},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===f||e===s||e===o||e===d||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===g)},t.typeOf=w},309:function(e,t,n){"use strict";e.exports=n(746)},463:function(e,t,n){"use strict";var r=n(791),a=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(p,e)||!f.call(d,e)&&(h.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),_=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var F,L=Object.assign;function B(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function z(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case k:return"Portal";case C:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return j(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ee=null,Se=null;function Ce(e){if(e=ba(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Ie(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function _e(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Te(e,t){return e(t)}function Ne(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Te(e,t,n)}finally{Re=!1,(null!==Ee||null!==Se)&&(Ne(),_e())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(l)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(le){De=!1}function Me(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Fe=!1,Le=null,Be=!1,Ue=null,Ve={onError:function(e){Fe=!0,Le=e}};function ze(e,t,n,r,a,i,o,s,u){Fe=!1,Le=null,Me.apply(Ve,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(je(e)!==e)throw Error(i(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return He(a),e;if(o===r)return He(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,$e=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Ye=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ft(s):0!==(i&=o)&&(r=ft(i))}else 0!==(o=n&~a)?r=ft(o):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Et,St,Ct,It=!1,_t=[],Tt=null,Nt=null,Rt=null,At=new Map,Ot=new Map,Dt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Ft(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Ct(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ut(e,t,n){Bt(e)&&n.delete(t)}function Vt(){It=!1,null!==Tt&&Bt(Tt)&&(Tt=null),null!==Nt&&Bt(Nt)&&(Nt=null),null!==Rt&&Bt(Rt)&&(Rt=null),At.forEach(Ut),Ot.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function jt(e){function t(t){return zt(t,e)}if(0<_t.length){zt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&zt(Tt,e),null!==Nt&&zt(Nt,e),null!==Rt&&zt(Rt,e),At.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Dt.shift()}var Wt=x.ReactCurrentBatchConfig,Ht=!0;function qt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,Wt.transition=i}}function Gt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,Wt.transition=i}}function Kt(e,t,n,r){if(Ht){var a=$t(e,t,n,r);if(null===a)Hr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Tt=Ft(Tt,e,t,n,r,a),!0;case"dragenter":return Nt=Ft(Nt,e,t,n,r,a),!0;case"mouseover":return Rt=Ft(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Ft(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ot.set(i,Ft(Ot.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=$t(e,t,n,r))&&Hr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function $t(e,t,n,r){if(Xt=null,null!==(e=ya(e=we(r))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,a="value"in Yt?Yt.value:Yt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=L({},cn,{view:0,detail:0}),hn=an(fn),dn=L({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(dn),vn=an(L({},dn,{dataTransfer:0})),mn=an(L({},fn,{relatedTarget:0})),gn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Cn(){return Sn}var In=L({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(In),Tn=an(L({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(L({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=L({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(An),Dn=[9,13,27,32],Pn=l&&"CompositionEvent"in window,Mn=null;l&&"documentMode"in document&&(Mn=document.documentMode);var Fn=l&&"TextEvent"in window&&!Mn,Ln=l&&(!Pn||Mn&&8<Mn&&11>=Mn),Bn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){Ie(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Xn(e){Br(e,0)}function $n(e){if(K(xa(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(l){var Jn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&$n(Kn)){var t=[];qn(t,Kn,e,we(e)),Ae(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Kn)}function ir(e,t){if("click"===e)return $n(t)}function or(e,t){if("input"===e||"change"===e)return $n(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!f.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Gr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Er={},Sr={};function Cr(e){if(Er[e])return Er[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Er[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ir=Cr("animationend"),_r=Cr("animationiteration"),Tr=Cr("animationstart"),Nr=Cr("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Rr.set(e,t),u(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Pr=Ar[Dr];Or(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Or(Ir,"onAnimationEnd"),Or(_r,"onAnimationIteration"),Or(Tr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(ze.apply(this,arguments),Fe){if(!Fe)throw Error(i(198));var l=Le;Fe=!1,Le=null,Be||(Be=!0,Ue=l)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}}}if(Be)throw e=Ue,Be=!1,Ue=null,e}function Ur(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function jr(e){if(!e[zr]){e[zr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Vr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Qt(t)){case 1:var a=qt;break;case 4:a=Gt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=we(n),o=[];e:{var s=Rr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=_n;break;case"focusin":c="focus",u=mn;break;case"focusout":c="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Nn;break;case Ir:case _r:case Tr:u=gn;break;case Nr:u=Rn;break;case"scroll":u=hn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Tn}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==h&&(null!=(v=Oe(p,h))&&l.push(qr(p,v,d)))),f)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(f=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Tn,v="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==u?s:xa(u),d=null==c?s:xa(c),(s=new l(v,p+"leave",u,n,a)).target=f,s.relatedTarget=d,v=null,ya(a)===r&&((l=new l(h,p+"enter",c,n,a)).target=d,l.relatedTarget=f,v=l),f=v,u&&c)e:{for(h=c,p=0,d=l=u;d;d=Kr(d))p++;for(d=0,v=h;v;v=Kr(v))d++;for(;0<p-d;)l=Kr(l),p--;for(;0<d-p;)h=Kr(h),d--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=Kr(l),h=Kr(h)}l=null}else l=null;null!==u&&Xr(o,s,u,l,!1),null!==c&&null!==f&&Xr(o,f,c,l,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Qn;else if(Hn(s))if(Yn)m=or;else{m=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?qn(o,m,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?xa(r):window,e){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(jn||"onCompositionStart"!==b?"onCompositionEnd"===b&&jn&&(y=en()):(Jt="value"in(Yt=a)?Yt.value:Yt.textContent,jn=!0)),0<(g=Gr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Bn);case"textInput":return(e=t.data)===Bn&&Un?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!Pn&&Vn(e,t)?(e=en(),Zt=Jt=Yt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Br(o,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Oe(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Oe(n,i))&&o.unshift(qr(n,u,s)):a||null!=(u=Oe(n,i))&&o.push(qr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var $r=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);jt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),ha="__reactFiber$"+fa,da="__reactProps$"+fa,pa="__reactContainer$"+fa,va="__reactEvents$"+fa,ma="__reactListeners$"+fa,ga="__reactHandles$"+fa;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[ha])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[da]||null}var ka=[],Ea=-1;function Sa(e){return{current:e}}function Ca(e){0>Ea||(e.current=ka[Ea],ka[Ea]=null,Ea--)}function Ia(e,t){Ea++,ka[Ea]=e.current,e.current=t}var _a={},Ta=Sa(_a),Na=Sa(!1),Ra=_a;function Aa(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ca(Na),Ca(Ta)}function Pa(e,t,n){if(Ta.current!==_a)throw Error(i(168));Ia(Ta,t),Ia(Na,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,W(e)||"Unknown",a));return L({},n,r)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Ra=Ta.current,Ia(Ta,e),Ia(Na,Na.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ma(e,t,Ra),r.__reactInternalMemoizedMergedChildContext=e,Ca(Na),Ca(Ta),Ia(Ta,e)):Ca(Na),Ia(Na,n)}var Ba=null,Ua=!1,Va=!1;function za(e){null===Ba?Ba=[e]:Ba.push(e)}function ja(){if(!Va&&null!==Ba){Va=!0;var e=0,t=bt;try{var n=Ba;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ba=null,Ua=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Ke(Ze,ja),a}finally{bt=t,Va=!1}}return null}var Wa=[],Ha=0,qa=null,Ga=0,Ka=[],Xa=0,$a=null,Qa=1,Ya="";function Ja(e,t){Wa[Ha++]=Ga,Wa[Ha++]=qa,qa=e,Ga=t}function Za(e,t,n){Ka[Xa++]=Qa,Ka[Xa++]=Ya,Ka[Xa++]=$a,$a=e;var r=Qa;e=Ya;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Qa=1<<32-ot(t)+a|n<<a|r,Ya=i+e}else Qa=1<<i|n<<a|r,Ya=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===qa;)qa=Wa[--Ha],Wa[Ha]=null,Ga=Wa[--Ha],Wa[Ha]=null;for(;e===$a;)$a=Ka[--Xa],Ka[Xa]=null,Ya=Ka[--Xa],Ka[Xa]=null,Qa=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$a?{id:Qa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function fi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw hi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function di(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var vi=x.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gi=Sa(null),yi=null,bi=null,xi=null;function wi(){xi=bi=yi=null}function ki(e){var t=gi.current;Ca(gi),e._currentValue=t}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ci(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ii=null;function _i(e){null===Ii?Ii=[e]:Ii.push(e)}function Ti(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,_i(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ni(e,r)}function Ni(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function Ai(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ni(e,n)}return null===(a=r.interleaved)?(t.next=t,_i(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ni(e,n)}function Mi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Fi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var a=e.updateQueue;Ri=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var f=a.baseState;for(o=0,l=c=u=null,s=i;;){var h=s.lane,d=s.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(d,f,h):p)||void 0===h)break e;f=L({},f,h);break e;case 2:Ri=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else d={eventTime:d,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=f):l=l.next=d,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===l&&(u=f),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Fu|=o,e.lanes=o,e.memoizedState=f}}function Bi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Ui=(new r.Component).refs;function Vi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var zi={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,a))&&(nc(t,e,a,r),Mi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,a))&&(nc(t,e,a,r),Mi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Pi(e,a,r))&&(nc(t,e,r,n),Mi(t,e,r))}};function ji(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function Wi(e,t,n){var r=!1,a=_a,i=t.contextType;return"object"===typeof i&&null!==i?i=Ci(i):(a=Oa(t)?Ra:Ta.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):_a),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Hi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&zi.enqueueReplaceState(t,t.state,null)}function qi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Ui,Ai(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ci(i):(i=Oa(t)?Ra:Ta.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Vi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&zi.enqueueReplaceState(a,a.state,null),Li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Ui&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ki(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function $i(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===E?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Xi(i)===t.type)?((r=a(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=Pc(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case k:return(t=Bc(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mc(t,e.mode,n,null)).return=e,t;Ki(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?l(e,t,n,r):null;case O:return d(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:f(e,t,n,r,null);Ki(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return f(t,e=e.get(n)||null,r,a,null);Ki(t,r)}return null}function v(a,i,s,u){for(var c=null,l=null,f=i,v=i=0,m=null;null!==f&&v<s.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var g=d(a,f,s[v],u);if(null===g){null===f&&(f=m);break}e&&f&&null===g.alternate&&t(a,f),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g,f=m}if(v===s.length)return n(a,f),ai&&Ja(a,v),c;if(null===f){for(;v<s.length;v++)null!==(f=h(a,s[v],u))&&(i=o(f,i,v),null===l?c=f:l.sibling=f,l=f);return ai&&Ja(a,v),c}for(f=r(a,f);v<s.length;v++)null!==(m=p(f,a,v,s[v],u))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m);return e&&f.forEach((function(e){return t(a,e)})),ai&&Ja(a,v),c}function m(a,s,u,c){var l=M(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var f=l=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=d(a,v,y.value,c);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,m),null===f?l=b:f.sibling=b,f=b,v=g}if(y.done)return n(a,v),ai&&Ja(a,m),l;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=h(a,y.value,c))&&(s=o(y,s,m),null===f?l=y:f.sibling=y,f=y);return ai&&Ja(a,m),l}for(v=r(a,v);!y.done;m++,y=u.next())null!==(y=p(v,a,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===f?l=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Ja(a,m),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===E){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Xi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Gi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===E?((i=Mc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Pc(o.type,o.key,o.props,null,r.mode,u)).ref=Gi(r,i,o),u.return=r,r=u)}return s(r);case k:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bc(o,r.mode,u)).return=r,r=i}return s(r);case O:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(M(o))return m(r,i,o,u);Ki(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Lc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Qi=$i(!0),Yi=$i(!1),Ji={},Zi=Sa(Ji),eo=Sa(Ji),to=Sa(Ji);function no(e){if(e===Ji)throw Error(i(174));return e}function ro(e,t){switch(Ia(to,t),Ia(eo,e),Ia(Zi,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Zi),Ia(Zi,t)}function ao(){Ca(Zi),Ca(eo),Ca(to)}function io(e){no(to.current);var t=no(Zi.current),n=ue(t,e.type);t!==n&&(Ia(eo,e),Ia(Zi,n))}function oo(e){eo.current===e&&(Ca(Zi),Ca(eo))}var so=Sa(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=x.ReactCurrentDispatcher,ho=x.ReactCurrentBatchConfig,po=0,vo=null,mo=null,go=null,yo=!1,bo=!1,xo=0,wo=0;function ko(){throw Error(i(321))}function Eo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function So(e,t,n,r,a,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,go=mo=null,t.updateQueue=null,fo.current=cs,e=n(r,a)}while(bo)}if(fo.current=os,t=null!==mo&&null!==mo.next,po=0,go=mo=vo=null,yo=!1,t)throw Error(i(300));return e}function Co(){var e=0!==xo;return xo=0,e}function Io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?vo.memoizedState=go=e:go=go.next=e,go}function _o(){if(null===mo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===go?vo.memoizedState:go.next;if(null!==t)go=t,mo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===go?vo.memoizedState=go=e:go=go.next=e}return go}function To(e,t){return"function"===typeof t?t(e):t}function No(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=mo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=h,s=r):c=c.next=h,vo.lanes|=f,Fu|=f}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Fu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Oo(e,t){var n=vo,r=_o(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Ho(Mo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Uo(9,Po.bind(null,n,r,a,t),void 0,null),null===Nu)throw Error(i(349));0!==(30&po)||Do(n,t,a)}return a}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Po(e,t,n,r){t.value=n,t.getSnapshot=r,Fo(t)&&Lo(e)}function Mo(e,t,n){return n((function(){Fo(t)&&Lo(e)}))}function Fo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Lo(e){var t=Ni(e,1);null!==t&&nc(t,e,1,-1)}function Bo(e){var t=Io();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function Uo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Vo(){return _o().memoizedState}function zo(e,t,n,r){var a=Io();vo.flags|=e,a.memoizedState=Uo(1|t,n,void 0,void 0===r?null:r)}function jo(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==mo){var o=mo.memoizedState;if(i=o.destroy,null!==r&&Eo(r,o.deps))return void(a.memoizedState=Uo(t,n,i,r))}vo.flags|=e,a.memoizedState=Uo(1|t,n,i,r)}function Wo(e,t){return zo(8390656,8,e,t)}function Ho(e,t){return jo(2048,8,e,t)}function qo(e,t){return jo(4,2,e,t)}function Go(e,t){return jo(4,4,e,t)}function Ko(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,jo(4,4,Ko.bind(null,t,e),n)}function $o(){}function Qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Fu|=n,e.baseState=!0),t)}function Zo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{bt=n,ho.transition=r}}function es(){return _o().memoizedState}function ts(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ti(e,t,n,r))){nc(n,e,r,ec()),is(n,t,r)}}function ns(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,_i(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ti(e,t,a,r))&&(nc(n,e,r,a=ec()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ci,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},ss={readContext:Ci,useCallback:function(e,t){return Io().memoizedState=[e,void 0===t?null:t],e},useContext:Ci,useEffect:Wo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4194308,4,Ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zo(4194308,4,e,t)},useInsertionEffect:function(e,t){return zo(4,2,e,t)},useMemo:function(e,t){var n=Io();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Io();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Io().memoizedState=e},useState:Bo,useDebugValue:$o,useDeferredValue:function(e){return Io().memoizedState=e},useTransition:function(){var e=Bo(!1),t=e[0];return e=Zo.bind(null,e[1]),Io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=Io();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Nu)throw Error(i(349));0!==(30&po)||Do(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Wo(Mo.bind(null,r,o,e),[e]),r.flags|=2048,Uo(9,Po.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Io(),t=Nu.identifierPrefix;if(ai){var n=Ya;t=":"+t+"R"+(n=(Qa&~(1<<32-ot(Qa)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ci,useCallback:Qo,useContext:Ci,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:qo,useLayoutEffect:Go,useMemo:Yo,useReducer:No,useRef:Vo,useState:function(){return No(To)},useDebugValue:$o,useDeferredValue:function(e){return Jo(_o(),mo.memoizedState,e)},useTransition:function(){return[No(To)[0],_o().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ci,useCallback:Qo,useContext:Ci,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:qo,useLayoutEffect:Go,useMemo:Yo,useReducer:Ro,useRef:Vo,useState:function(){return Ro(To)},useDebugValue:$o,useDeferredValue:function(e){var t=_o();return null===mo?t.memoizedState=e:Jo(t,mo.memoizedState,e)},useTransition:function(){return[Ro(To)[0],_o().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function fs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,qu=r),hs(0,t)},n}function vs(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===Gu?Gu=new Set([this]):Gu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,Pi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?Yi(t,null,n,r):Qi(t,e.child,n,r)}function ks(e,t,n,r,a){n=n.render;var i=t.ref;return Si(t,a),r=So(e,t,n,r,i,a),n=Co(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Es(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Oc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Dc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return _s(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ia(Du,Ou),Ou|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ia(Du,Ou),Ou|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ia(Du,Ou),Ou|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ia(Du,Ou),Ou|=r;return ws(e,t,a,n),t.child}function Is(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _s(e,t,n,r,a){var i=Oa(n)?Ra:Ta.current;return i=Aa(t,i),Si(t,a),n=So(e,t,n,r,i,a),r=Co(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Ts(e,t,n,r,a){if(Oa(n)){var i=!0;Fa(t)}else i=!1;if(Si(t,a),null===t.stateNode)Ws(e,t),Wi(t,n,r),qi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ci(c):c=Aa(t,c=Oa(n)?Ra:Ta.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Hi(t,o,r,c),Ri=!1;var h=t.memoizedState;o.state=h,Li(t,r,o,a),u=t.memoizedState,s!==r||h!==u||Na.current||Ri?("function"===typeof l&&(Vi(t,n,l,r),u=t.memoizedState),(s=Ri||ji(t,n,s,r,h,u,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Oi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:mi(t.type,s),o.props=c,f=t.pendingProps,h=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ci(u):u=Aa(t,u=Oa(n)?Ra:Ta.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==f||h!==u)&&Hi(t,o,r,u),Ri=!1,h=t.memoizedState,o.state=h,Li(t,r,o,a);var p=t.memoizedState;s!==f||h!==p||Na.current||Ri?("function"===typeof d&&(Vi(t,n,d,r),p=t.memoizedState),(c=Ri||ji(t,n,c,r,h,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ns(e,t,n,r,i,a)}function Ns(e,t,n,r,a,i){Is(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Qi(t,e.child,null,i),t.child=Qi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Pa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pa(0,t.context,!1),ro(e,t.containerInfo)}function As(e,t,n,r,a){return di(),pi(a),t.flags|=256,ws(e,t,n,r),t.child}var Os,Ds,Ps,Ms={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ia(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Fc(u,a,0,null),e=Mc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=Ms,e):Bs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,r=fs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Fc({mode:"visible",children:r.children},a,0,null),(o=Mc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Qi(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Ms,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Us(e,t,s,r=fs(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=Nu)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ni(e,a),nc(r,e,a,-1))}return vc(),Us(e,t,s,r=fs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Xa++]=Qa,Ka[Xa++]=Ya,Ka[Xa++]=$a,Qa=e.id,Ya=e.overflow,$a=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Dc(r,s):(s=Mc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?Fs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ms,a}return e=(s=e.child).sibling,a=Dc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,r){return null!==r&&pi(r),Qi(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function zs(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function js(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,n,t);else if(19===e.tag)Vs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ia(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),zs(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}zs(t,!0,n,null,i);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Oa(t.type)&&Da(),Gs(t),null;case 3:return r=t.stateNode,ao(),Ca(Na),Ca(Ta),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),Gs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Gs(t),null}if(e=no(Zi.current),fi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ha]=t,r[da]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)Ur(Mr[a],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Q(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ae(r,o),Ur("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Ur("scroll",r)}switch(n){case"input":G(r),Z(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[ha]=t,e[da]=r,Os(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),a=r;break;case"iframe":case"object":case"embed":Ur("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)Ur(Mr[a],e);a=r;break;case"source":Ur("error",e),a=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),a=r;break;case"details":Ur("toggle",e),a=r;break;case"input":Q(e,r),a=$(e,r),Ur("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Ur("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Ur("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Ps(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no(Zi.current),fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Gs(t),null;case 13:if(Ca(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),di(),t.flags|=98560,o=!1;else if(o=fi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[ha]=t}else di(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Pu&&(Pu=3):vc())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return ao(),null===e&&jr(t.stateNode.containerInfo),Gs(t),null;case 10:return ki(t.type._context),Gs(t),null;case 19:if(Ca(so),null===(o=t.memoizedState))return Gs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)qs(o,!1);else{if(0!==Pu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,qs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ia(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>ju&&(t.flags|=128,r=!0,qs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return Gs(t),null}else 2*Ye()-o.renderingStartTime>ju&&1073741824!==n&&(t.flags|=128,r=!0,qs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=so.current,Ia(so,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ou)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xs(e,t){switch(ti(t),t.tag){case 1:return Oa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Ca(Na),Ca(Ta),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ca(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));di()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(so),null;case 4:return ao(),null;case 10:return ki(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Os=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no(Zi.current);var i,o=null;switch(n){case"input":a=$(e,a),r=$(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Ur("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ps=function(e,t,n,r){n!==r&&(t.flags|=4)};var $s=!1,Qs=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Js=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function eu(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var tu=!1;function nu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&eu(t,n,i)}a=a.next}while(a!==r)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function au(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[da],delete t[va],delete t[ma],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function su(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}var lu=null,fu=!1;function hu(e,t,n){for(n=n.child;null!==n;)du(e,t,n),n=n.sibling}function du(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||Zs(n,t);case 6:var r=lu,a=fu;lu=null,hu(e,t,n),fu=a,null!==(lu=r)&&(fu?(e=lu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):lu.removeChild(n.stateNode));break;case 18:null!==lu&&(fu?(e=lu,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),jt(e)):ua(lu,n.stateNode));break;case 4:r=lu,a=fu,lu=n.stateNode.containerInfo,fu=!0,hu(e,t,n),lu=r,fu=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&eu(n,t,o),a=a.next}while(a!==r)}hu(e,t,n);break;case 1:if(!Qs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sc(n,t,s)}hu(e,t,n);break;case 21:hu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,hu(e,t,n),Qs=r):hu(e,t,n);break;default:hu(e,t,n)}}function pu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:lu=u.stateNode,fu=!1;break e;case 3:case 4:lu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===lu)throw Error(i(160));du(o,s,a),lu=null,fu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Sc(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),gu(e),4&r){try{nu(3,e,e.return),ru(3,e)}catch(m){Sc(e,e.return,m)}try{nu(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:vu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(vu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Y(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var f=c[s],h=c[s+1];"style"===f?me(a,h):"dangerouslySetInnerHTML"===f?fe(a,h):"children"===f?he(a,h):b(a,f,h,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[da]=o}catch(m){Sc(e,e.return,m)}}break;case 6:if(vu(t,e),gu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Sc(e,e.return,m)}}break;case 3:if(vu(t,e),gu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:vu(t,e),gu(e);break;case 13:vu(t,e),gu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(zu=Ye())),4&r&&pu(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||f,vu(t,e),Qs=l):vu(t,e),gu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for(Js=e,f=e.child;null!==f;){for(h=Js=f;null!==Js;){switch(p=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:nu(4,d,d.return);break;case 1:Zs(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:Zs(d,d.return);break;case 22:if(null!==d.memoizedState){wu(h);continue}}null!==p?(p.return=d,Js=p):wu(h)}f=f.sibling}e:for(f=null,h=e;;){if(5===h.tag){if(null===f){f=h;try{a=h.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(m){Sc(e,e.return,m)}}}else if(6===h.tag){if(null===f)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vu(t,e),gu(e),4&r&&pu(e);case 21:}}function gu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ou(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cu(e,su(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;uu(e,su(e),o);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yu(e,t,n){Js=e,bu(e,t,n)}function bu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var a=Js,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||$s;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=$s;var c=Qs;if($s=o,(Qs=u)&&!c)for(Js=a;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?ku(a):null!==u?(u.return=o,Js=u):ku(a);for(;null!==i;)Js=i,bu(i,t,n),i=i.sibling;Js=a,$s=s,Qs=c}xu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Js=i):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||ru(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var h=f.dehydrated;null!==h&&jt(h)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&au(t)}catch(d){Sc(t,t.return,d)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function wu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(u){Sc(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Sc(t,a,u)}}var i=t.return;try{au(t)}catch(u){Sc(t,i,u)}break;case 5:var o=t.return;try{au(t)}catch(u){Sc(t,o,u)}}}catch(u){Sc(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Eu,Su=Math.ceil,Cu=x.ReactCurrentDispatcher,Iu=x.ReactCurrentOwner,_u=x.ReactCurrentBatchConfig,Tu=0,Nu=null,Ru=null,Au=0,Ou=0,Du=Sa(0),Pu=0,Mu=null,Fu=0,Lu=0,Bu=0,Uu=null,Vu=null,zu=0,ju=1/0,Wu=null,Hu=!1,qu=null,Gu=null,Ku=!1,Xu=null,$u=0,Qu=0,Yu=null,Ju=-1,Zu=0;function ec(){return 0!==(6&Tu)?Ye():-1!==Ju?Ju:Ju=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tu)&&0!==Au?Au&-Au:null!==vi.transition?(0===Zu&&(Zu=vt()),Zu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,n,r){if(50<Qu)throw Qu=0,Yu=null,Error(i(185));gt(e,n,r),0!==(2&Tu)&&e===Nu||(e===Nu&&(0===(2&Tu)&&(Lu|=n),4===Pu&&sc(e,Au)),rc(e,r),1===n&&0===Tu&&0===(1&t.mode)&&(ju=Ye()+500,Ua&&ja()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=dt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===Nu?Au:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ua=!0,za(e)}(uc.bind(null,e)):za(uc.bind(null,e)),oa((function(){0===(6&Tu)&&ja()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ju=-1,Zu=0,0!==(6&Tu))throw Error(i(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ht(e,e===Nu?Au:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Tu;Tu|=2;var o=pc();for(Nu===e&&Au===t||(Wu=null,ju=Ye()+500,hc(e,t));;)try{yc();break}catch(u){dc(e,u)}wi(),Cu.current=o,Tu=a,null!==Ru?t=0:(Nu=null,Au=0,t=Pu)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Mu,hc(e,0),sc(e,r),rc(e,Ye()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Mu,hc(e,0),sc(e,r),rc(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Vu,Wu);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=zu+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Vu,Wu),t);break}wc(e,Vu,Wu);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Su(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Vu,Wu),r);break}wc(e,Vu,Wu);break;default:throw Error(i(329))}}}return rc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Uu;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Vu,Vu=n,null!==t&&oc(t)),e}function oc(e){null===Vu?Vu=e:Vu.push.apply(Vu,e)}function sc(e,t){for(t&=~Bu,t&=~Lu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Tu))throw Error(i(327));kc();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Mu,hc(e,0),sc(e,t),rc(e,Ye()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Vu,Wu),rc(e,Ye()),null}function cc(e,t){var n=Tu;Tu|=1;try{return e(t)}finally{0===(Tu=n)&&(ju=Ye()+500,Ua&&ja())}}function lc(e){null!==Xu&&0===Xu.tag&&0===(6&Tu)&&kc();var t=Tu;Tu|=1;var n=_u.transition,r=bt;try{if(_u.transition=null,bt=1,e)return e()}finally{bt=r,_u.transition=n,0===(6&(Tu=t))&&ja()}}function fc(){Ou=Du.current,Ca(Du)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ru)for(n=Ru.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:ao(),Ca(Na),Ca(Ta),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ca(so);break;case 10:ki(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Nu=e,Ru=e=Dc(e.current,null),Au=Ou=t,Pu=0,Mu=null,Bu=Lu=Fu=0,Vu=Uu=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(r=(n=Ii[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ii=null}return e}function dc(e,t){for(;;){var n=Ru;try{if(wi(),fo.current=os,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(po=0,go=mo=vo=null,bo=!1,xo=0,Iu.current=null,null===n||null===n.return){Pu=1,Mu=t,Ru=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Au,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=u,h=f.tag;if(0===(1&f.mode)&&(0===h||11===h||15===h)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,ys(p,s,u,0,t),1&p.mode&&ms(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){ms(o,l,t),vc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,u,0,t),pi(ls(c,u));break e}}o=c=ls(c,u),4!==Pu&&(Pu=2),null===Uu?Uu=[o]:Uu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,ps(0,c,t));break e;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gu||!Gu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Ru===n&&null!==n&&(Ru=n=n.return);continue}break}}function pc(){var e=Cu.current;return Cu.current=os,null===e?os:e}function vc(){0!==Pu&&3!==Pu&&2!==Pu||(Pu=4),null===Nu||0===(268435455&Fu)&&0===(268435455&Lu)||sc(Nu,Au)}function mc(e,t){var n=Tu;Tu|=2;var r=pc();for(Nu===e&&Au===t||(Wu=null,hc(e,t));;)try{gc();break}catch(a){dc(e,a)}if(wi(),Tu=n,Cu.current=r,null!==Ru)throw Error(i(261));return Nu=null,Au=0,Pu}function gc(){for(;null!==Ru;)bc(Ru)}function yc(){for(;null!==Ru&&!$e();)bc(Ru)}function bc(e){var t=Eu(e.alternate,e,Ou);e.memoizedProps=e.pendingProps,null===t?xc(e):Ru=t,Iu.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Ou)))return void(Ru=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Ru=n);if(null===e)return Pu=6,void(Ru=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ru=t);Ru=t=e}while(null!==t);0===Pu&&(Pu=5)}function wc(e,t,n){var r=bt,a=_u.transition;try{_u.transition=null,bt=1,function(e,t,n,r){do{kc()}while(null!==Xu);if(0!==(6&Tu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Nu&&(Ru=Nu=null,Au=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ku||(Ku=!0,Nc(tt,(function(){return kc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=_u.transition,_u.transition=null;var s=bt;bt=1;var u=Tu;Tu|=4,Iu.current=null,function(e,t){if(ea=Ht,dr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,u=-1,c=-1,l=0,f=0,h=e,d=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(u=s+a),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)d=h,h=p;for(;;){if(h===e)break t;if(d===n&&++l===a&&(u=s),d===o&&++f===r&&(c=s),null!==(p=h.nextSibling))break;d=(h=d).parentNode}h=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=tu,tu=!1}(e,n),mu(n,e),pr(ta),Ht=!!ea,ta=ea=null,e.current=n,yu(n,e,a),Qe(),Tu=u,bt=s,_u.transition=o}else e.current=n;if(Ku&&(Ku=!1,Xu=e,$u=a),o=e.pendingLanes,0===o&&(Gu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((a=t[n]).value,{componentStack:a.stack,digest:a.digest});if(Hu)throw Hu=!1,e=qu,qu=null,e;0!==(1&$u)&&0!==e.tag&&kc(),o=e.pendingLanes,0!==(1&o)?e===Yu?Qu++:(Qu=0,Yu=e):Qu=0,ja()}(e,t,n,r)}finally{_u.transition=a,bt=r}return null}function kc(){if(null!==Xu){var e=xt($u),t=_u.transition,n=bt;try{if(_u.transition=null,bt=16>e?16:e,null===Xu)var r=!1;else{if(e=Xu,Xu=null,$u=0,0!==(6&Tu))throw Error(i(331));var a=Tu;for(Tu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var f=Js;switch(f.tag){case 0:case 11:case 15:nu(8,f,o)}var h=f.child;if(null!==h)h.return=f,Js=h;else for(;null!==Js;){var d=(f=Js).sibling,p=f.return;if(iu(f),f===l){Js=null;break}if(null!==d){d.return=p,Js=d;break}Js=p}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:nu(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Js=y;break e}Js=o.return}}var b=e.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(k){Sc(u,u.return,k)}if(u===s){Js=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,Js=w;break e}Js=u.return}}if(Tu=a,ja(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{bt=n,_u.transition=t}}return!1}function Ec(e,t,n){e=Pi(e,t=ps(0,t=ls(n,t),1),1),t=ec(),null!==e&&(gt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gu||!Gu.has(r))){t=Pi(t,e=vs(t,e=ls(n,e),1),1),e=ec(),null!==t&&(gt(t,1,e),rc(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Nu===e&&(Au&n)===n&&(4===Pu||3===Pu&&(130023424&Au)===Au&&500>Ye()-zu?hc(e,0):Bu|=n),rc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=ec();null!==(e=Ni(e,t))&&(gt(e,t,n),rc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ic(e,n)}function Nc(e,t){return Ke(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Rc(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Oc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Mc(n.children,a,o,t);case S:s=8,a|=8;break;case C:return(e=Ac(12,n,t,2|a)).elementType=C,e.lanes=o,e;case N:return(e=Ac(13,n,t,a)).elementType=N,e.lanes=o,e;case R:return(e=Ac(19,n,t,a)).elementType=R,e.lanes=o,e;case D:return Fc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case _:s=9;break e;case T:s=11;break e;case A:s=14;break e;case O:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ac(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,a,i,o,s,u){return e=new Uc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ac(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ai(i),e}function zc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function jc(e){if(!e)return _a;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Oa(n))return Ma(e,n,t)}return t}function Wc(e,t,n,r,a,i,o,s,u){return(e=Vc(n,r,!0,e,0,i,0,s,u)).context=jc(null),n=e.current,(i=Di(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Pi(n,i,a),e.current.lanes=a,gt(e,a,r),rc(e,r),e}function Hc(e,t,n,r){var a=t.current,i=ec(),o=tc(a);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Pi(a,t,o))&&(nc(e,a,o,i),Mi(e,a,o)),o}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Eu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),di();break;case 5:io(t);break;case 1:Oa(t.type)&&Fa(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ia(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ia(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ls(e,t,n):(Ia(so,1&so.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ia(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return js(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ia(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&Za(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ws(e,t),e=t.pendingProps;var a=Aa(t,Ta.current);Si(t,n),a=So(null,t,r,e,a,n);var o=Co();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(o=!0,Fa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ai(t),a.updater=zi,t.stateNode=a,a._reactInternals=t,qi(t,r,e,n),t=Ns(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===A)return 14}return 2}(r),e=mi(r,e),a){case 0:t=_s(null,t,r,e,n);break e;case 1:t=Ts(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Es(null,t,r,mi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 3:e:{if(Rs(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Oi(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Yi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(di(),r===a){t=Hs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Is(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Ls(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ks(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ia(gi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Na.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Di(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ei(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ei(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Si(t,n),r=r(a=Ci(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=mi(r=t.type,t.pendingProps),Es(e,t,r,a=mi(r.type,a),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:mi(r,a),Ws(e,t),t.tag=1,Oa(r)?(e=!0,Fa(t)):e=!1,Si(t,n),Wi(t,r,a),qi(t,r,a,n),Ns(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Cs(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=qc(o);s.call(e)}}Hc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=qc(o);i.call(e)}}var o=Wc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[pa]=o.current,jr(8===e.nodeType?e.parentNode:e),lc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=qc(u);s.call(e)}}var u=Vc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=u,e[pa]=u.current,jr(8===e.nodeType?e.parentNode:e),lc((function(){Hc(t,u,n,r)})),u}(n,t,e,a,r);return qc(o)}Qc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Qc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lc((function(){Hc(null,e,null,null)})),t[pa]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ye()),0===(6&Tu)&&(ju=Ye()+500,ja()))}break;case 13:lc((function(){var t=Ni(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Kc(e,1)}},kt=function(e){if(13===e.tag){var t=Ni(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),n=Ni(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},St=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ne=lc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,wa,Ie,_e,cc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(i(200));return zc(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(i(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,jr(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return lc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,a,0,o,s),e[pa]=t.current,jr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(lc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},372:function(e,t){"use strict";var n=60103,r=60106,a=60107,i=60108,o=60114,s=60109,u=60110,c=60112,l=60113,f=60120,h=60115,d=60116,p=60121,v=60122,m=60117,g=60129,y=60131;if("function"===typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),r=b("react.portal"),a=b("react.fragment"),i=b("react.strict_mode"),o=b("react.profiler"),s=b("react.provider"),u=b("react.context"),c=b("react.forward_ref"),l=b("react.suspense"),f=b("react.suspense_list"),h=b("react.memo"),d=b("react.lazy"),p=b("react.block"),v=b("react.server.block"),m=b("react.fundamental"),g=b("react.debug_trace_mode"),y=b("react.legacy_hidden")}function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case a:case o:case i:case l:case f:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case h:case s:return e;default:return t}}case r:return t}}}t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===o||e===g||e===i||e===l||e===f||e===y||"object"===typeof e&&null!==e&&(e.$$typeof===d||e.$$typeof===h||e.$$typeof===s||e.$$typeof===u||e.$$typeof===c||e.$$typeof===m||e.$$typeof===p||e[0]===v)},t.typeOf=x},441:function(e,t,n){"use strict";e.exports=n(372)},374:function(e,t,n){"use strict";var r=n(791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,v(x,g.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:E.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+T(u,0):i,w(o)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),N(o,t,a,"",(function(e){return e}))):null!=o&&(I(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var l=i+T(s=e[c],c);u+=N(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=N(s=s.value,t,a,l=i+T(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)k.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],f=1,h=null,d=3,p=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(m=!1,x(e),!v)if(null!==r(c))v=!0,D(k);else{var t=r(l);null!==t&&P(w,t.startTime-e)}}function k(e,n){v=!1,m&&(m=!1,y(I),I=-1),p=!0;var i=d;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var u=!0;else{var f=r(l);null!==f&&P(w,f.startTime-n),u=!1}return u}finally{h=null,d=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,C=null,I=-1,_=5,T=-1;function N(){return!(t.unstable_now()-T<_)}function R(){if(null!==C){var e=t.unstable_now();T=e;var n=!0;try{n=C(!0,e)}finally{n?E():(S=!1,C=null)}}else S=!1}if("function"===typeof b)E=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,O=A.port2;A.port1.onmessage=R,E=function(){O.postMessage(null)}}else E=function(){g(R,0)};function D(e){C=e,S||(S=!0,E())}function P(e,n){I=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(m?(y(I),I=-1):m=!0,P(w,i-o))):(e.sortIndex=s,n(c,e),v||p||(v=!0,D(k))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},613:function(e){e.exports=function(e,t,n,r){var a=n?n.call(r,e,t):void 0;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),u=0;u<i.length;u++){var c=i[u];if(!s(c))return!1;var l=e[c],f=t[c];if(!1===(a=n?n.call(r,l,f,c):void 0)||void 0===a&&l!==f)return!1}return!0}},902:function(){},522:function(){},753:function(){}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/notox/",n.nc=void 0,function(){"use strict";var e,t=n(791),r=n.t(t,2),a=n(250);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,a=l}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===l(t)?t:String(t)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VC){return!1}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){if(t&&("object"===l(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function x(e){var t=g();return function(){var n,r=m(e);if(t){var a=m(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b(this,n)}}function w(e,t,n){return w=g()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&p(a,n.prototype),a},w.apply(null,arguments)}function k(e){var t="function"===typeof Map?new Map:void 0;return k=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return w(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,e)},k(e)}function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var S,C="popstate";function I(e){return{usr:e.state,key:e.key}}function _(e,t,n,r){return void 0===n&&(n=null),E({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?N(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function T(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function N(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function R(e){var t="undefined"!==typeof window&&"undefined"!==typeof window.location&&"null"!==window.location.origin?window.location.origin:"unknown://unknown",n="string"===typeof e?e:T(e);return new URL(n,t)}function A(t,n,r,a){void 0===a&&(a={});var i=a,o=i.window,s=void 0===o?document.defaultView:o,u=i.v5Compat,c=void 0!==u&&u,l=s.history,f=e.Pop,h=null;function d(){f=e.Pop,h&&h({action:f,location:p.location})}var p={get action(){return f},get location(){return t(s,l)},listen:function(e){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(C,d),h=e,function(){s.removeEventListener(C,d),h=null}},createHref:function(e){return n(s,e)},encodeLocation:function(e){var t=R("string"===typeof e?e:T(e));return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){f=e.Push;var a=_(p.location,t,n);r&&r(a,t);var i=I(a),o=p.createHref(a);try{l.pushState(i,"",o)}catch(u){s.location.assign(o)}c&&h&&h({action:f,location:p.location})},replace:function(t,n){f=e.Replace;var a=_(p.location,t,n);r&&r(a,t);var i=I(a),o=p.createHref(a);l.replaceState(i,"",o),c&&h&&h({action:f,location:p.location})},go:function(e){return l.go(e)}};return p}function O(e,t,n){void 0===n&&(n="/");var r=V(("string"===typeof t?N(t):t).pathname||"/",n);if(null==r)return null;var a=D(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=L(a[o],U(r));return i}function D(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=""),e.forEach((function(e,a){var i={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(z(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));var o=G([r,i.relativePath]),s=n.concat(i);e.children&&e.children.length>0&&(z(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),D(e.children,t,s,o)),(null!=e.path||e.index)&&t.push({path:o,score:F(o,e.index),routesMeta:s})})),t}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(S||(S={}));var P=/^:\w+$/,M=function(e){return"*"===e};function F(e,t){var n=e.split("/"),r=n.length;return n.some(M)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!M(e)})).reduce((function(e,t){return e+(P.test(t)?3:""===t?1:10)}),r)}function L(e,t){for(var n=e.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",l=B({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var f=s.route;i.push({params:r,pathname:G([a,l.pathname]),pathnameBase:K(G([a,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(a=G([a,l.pathnameBase]))}return i}function B(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);j("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return r.push(t),"([^\\/]+)"}));e.endsWith("*")?(r.push("*"),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");var i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),r=s(n,2),a=r[0],i=r[1],o=t.match(a);if(!o)return null;var u=o[0],c=u.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:i.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";c=u.slice(0,u.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return j(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(l[n]||"",t),e}),{}),pathname:u,pathnameBase:c,pattern:e}}function U(e){try{return decodeURI(e)}catch(t){return j(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function z(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function j(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(VC){}}}function W(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function H(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function q(e,t,n,r){var a;void 0===r&&(r=!1),"string"===typeof e?a=N(e):(z(!(a=E({},e)).pathname||!a.pathname.includes("?"),W("?","pathname","search",a)),z(!a.pathname||!a.pathname.includes("#"),W("#","pathname","hash",a)),z(!a.search||!a.search.includes("#"),W("#","search","hash",a)));var i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(r||null==s)i=n;else{var u=t.length-1;if(s.startsWith("..")){for(var c=s.split("/");".."===c[0];)c.shift(),u-=1;a.pathname=c.join("/")}i=u>=0?t[u]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?N(e):e,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:X(i),hash:$(s)}}(a,i),f=s&&"/"!==s&&s.endsWith("/"),h=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!h||(l.pathname+="/"),l}var G=function(e){return e.join("/").replace(/\/\/+/g,"/")},K=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},X=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},$=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},Q=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n)}(k(Error));var Y=d((function e(t,n,r,a){c(this,e),void 0===a&&(a=!1),this.status=t,this.statusText=n||"",this.internal=a,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}));function J(e){return e instanceof Y}var Z=["post","put","patch","delete"],ee=(new Set(Z),["get"].concat(Z));new Set(ee),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},te.apply(this,arguments)}var ne="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},re=t.useState,ae=t.useEffect,ie=t.useLayoutEffect,oe=t.useDebugValue;function se(e){var t=e.getSnapshot,n=e.value;try{var r=t();return!ne(n,r)}catch(a){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,r.useSyncExternalStore;var ue=t.createContext(null);var ce=t.createContext(null);var le=t.createContext(null);var fe=t.createContext(null);var he=t.createContext(null);var de=t.createContext(null);var pe=t.createContext({outlet:null,matches:[]});var ve=t.createContext(null);function me(){return null!=t.useContext(de)}function ge(){return me()||z(!1),t.useContext(de).location}function ye(){me()||z(!1);var e=t.useContext(he),n=e.basename,r=e.navigator,a=t.useContext(pe).matches,i=ge().pathname,o=JSON.stringify(H(a).map((function(e){return e.pathnameBase}))),s=t.useRef(!1);t.useEffect((function(){s.current=!0}));var u=t.useCallback((function(e,t){if(void 0===t&&(t={}),s.current)if("number"!==typeof e){var a=q(e,JSON.parse(o),i,"path"===t.relative);"/"!==n&&(a.pathname="/"===a.pathname?n:G([n,a.pathname])),(t.replace?r.replace:r.push)(a,t.state,t)}else r.go(e)}),[n,r,o,i]);return u}function be(e,n){var r=(void 0===n?{}:n).relative,a=t.useContext(pe).matches,i=ge().pathname,o=JSON.stringify(H(a).map((function(e){return e.pathnameBase})));return t.useMemo((function(){return q(e,JSON.parse(o),i,"path"===r)}),[e,o,i,r])}function xe(){var e=function(){var e,n=t.useContext(ve),r=Ie(ke.UseRouteError),a=t.useContext(pe),i=a.matches[a.matches.length-1];if(n)return n;return a||z(!1),!i.route.id&&z(!1),null==(e=r.errors)?void 0:e[i.route.id]}(),n=J(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a},o={padding:"2px 4px",backgroundColor:a};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unhandled Thrown Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:i},r):null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own\xa0",t.createElement("code",{style:o},"errorElement")," props on\xa0",t.createElement("code",{style:o},"<Route>")))}var we,ke,Ee=function(e){v(r,e);var n=x(r);function r(e){var t;return c(this,r),(t=n.call(this,e)).state={location:e.location,error:e.error},t}return d(r,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?t.createElement(ve.Provider,{value:this.state.error,children:this.props.component}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),r}(t.Component);function Se(e){var n=e.routeContext,r=e.match,a=e.children,i=t.useContext(ue);return i&&r.route.errorElement&&(i._deepestRenderedBoundaryId=r.route.id),t.createElement(pe.Provider,{value:n},a)}function Ce(e,n,r){if(void 0===n&&(n=[]),null==e){if(null==r||!r.errors)return null;e=r.matches}var a=e,i=null==r?void 0:r.errors;if(null!=i){var o=a.findIndex((function(e){return e.route.id&&(null==i?void 0:i[e.route.id])}));o>=0||z(!1),a=a.slice(0,Math.min(a.length,o+1))}return a.reduceRight((function(e,o,s){var u=o.route.id?null==i?void 0:i[o.route.id]:null,c=r?o.route.errorElement||t.createElement(xe,null):null,l=function(){return t.createElement(Se,{match:o,routeContext:{outlet:e,matches:n.concat(a.slice(0,s+1))}},u?c:void 0!==o.route.element?o.route.element:e)};return r&&(o.route.errorElement||0===s)?t.createElement(Ee,{location:r.location,component:c,error:u,children:l()}):l()}),null)}function Ie(e){var n=t.useContext(le);return n||z(!1),n}!function(e){e.UseRevalidator="useRevalidator"}(we||(we={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(ke||(ke={}));var _e;function Te(e){var n=e.to,r=e.replace,a=e.state,i=e.relative;me()||z(!1);var o=t.useContext(le),s=ye();return t.useEffect((function(){o&&"idle"!==o.navigation.state||s(n,{replace:r,state:a,relative:i})})),null}function Ne(e){z(!1)}function Re(n){var r=n.basename,a=void 0===r?"/":r,i=n.children,o=void 0===i?null:i,s=n.location,u=n.navigationType,c=void 0===u?e.Pop:u,l=n.navigator,f=n.static,h=void 0!==f&&f;me()&&z(!1);var d=a.replace(/^\/*/,"/"),p=t.useMemo((function(){return{basename:d,navigator:l,static:h}}),[d,l,h]);"string"===typeof s&&(s=N(s));var v=s,m=v.pathname,g=void 0===m?"/":m,y=v.search,b=void 0===y?"":y,x=v.hash,w=void 0===x?"":x,k=v.state,E=void 0===k?null:k,S=v.key,C=void 0===S?"default":S,I=t.useMemo((function(){var e=V(g,d);return null==e?null:{pathname:e,search:b,hash:w,state:E,key:C}}),[d,g,b,w,E,C]);return null==I?null:t.createElement(he.Provider,{value:p},t.createElement(de.Provider,{children:o,value:{location:I,navigationType:c}}))}function Ae(n){var r=n.children,a=n.location,i=t.useContext(ce);return function(n,r){me()||z(!1);var a,i=t.useContext(he).navigator,o=t.useContext(le),s=t.useContext(pe).matches,u=s[s.length-1],c=u?u.params:{},l=(u&&u.pathname,u?u.pathnameBase:"/"),f=(u&&u.route,ge());if(r){var h,d="string"===typeof r?N(r):r;"/"===l||(null==(h=d.pathname)?void 0:h.startsWith(l))||z(!1),a=d}else a=f;var p=a.pathname||"/",v=O(n,{pathname:"/"===l?p:p.slice(l.length)||"/"}),m=Ce(v&&v.map((function(e){return Object.assign({},e,{params:Object.assign({},c,e.params),pathname:G([l,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:G([l,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),s,o||void 0);return r&&m?t.createElement(de.Provider,{value:{location:te({pathname:"/",search:"",hash:"",state:null,key:"default"},a),navigationType:e.Pop}},m):m}(i&&!r?i.router.routes:De(r),a)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(_e||(_e={}));var Oe=new Promise((function(){}));t.Component;function De(e,n){void 0===n&&(n=[]);var r=[];return t.Children.forEach(e,(function(e,a){if(t.isValidElement(e))if(e.type!==t.Fragment){e.type!==Ne&&z(!1),e.props.index&&e.props.children&&z(!1);var i=[].concat(u(n),[a]),o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(o.children=De(e.props.children,i)),r.push(o)}else r.push.apply(r,De(e.props.children,n))})),r}function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pe.apply(this,arguments)}function Me(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}var Fe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Le(e){var n,r=e.basename,a=e.children,i=e.window,o=t.useRef();null==o.current&&(o.current=(void 0===(n={window:i,v5Compat:!0})&&(n={}),A((function(e,t){var n=e.location;return _("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:T(t)}),null,n)));var u=o.current,c=s(t.useState({action:u.action,location:u.location}),2),l=c[0],f=c[1];return t.useLayoutEffect((function(){return u.listen(f)}),[u]),t.createElement(Re,{basename:r,children:a,location:l.location,navigationType:l.action,navigator:u})}var Be=t.forwardRef((function(e,n){var r=e.onClick,a=e.relative,i=e.reloadDocument,o=e.replace,s=e.state,u=e.target,c=e.to,l=e.preventScrollReset,f=Me(e,Fe),h=function(e,n){var r=(void 0===n?{}:n).relative;me()||z(!1);var a=t.useContext(he),i=a.basename,o=a.navigator,s=be(e,{relative:r}),u=s.hash,c=s.pathname,l=s.search,f=c;return"/"!==i&&(f="/"===c?i:G([i,c])),o.createHref({pathname:f,search:l,hash:u})}(c,{relative:a}),d=function(e,n){var r=void 0===n?{}:n,a=r.target,i=r.replace,o=r.state,s=r.preventScrollReset,u=r.relative,c=ye(),l=ge(),f=be(e,{relative:u});return t.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();var n=void 0!==i?i:T(l)===T(f);c(e,{replace:n,state:o,preventScrollReset:s,relative:u})}}),[l,c,f,i,o,a,e,s,u])}(c,{replace:o,state:s,target:u,preventScrollReset:l,relative:a});return t.createElement("a",Pe({},f,{href:h,onClick:i?r:function(e){r&&r(e),e.defaultPrevented||d(e)},ref:n,target:u}))}));var Ue,Ve;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Ue||(Ue={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ve||(Ve={}));function ze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function je(){return je="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ze(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},je.apply(this,arguments)}function We(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function He(){He=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(N){u=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),s=new I(a||[]);return r(o,"_invoke",{value:k(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=c;var h={};function d(){}function p(){}function v(){}var m={};u(m,i,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(_([])));y&&y!==t&&n.call(y,i)&&(m=y);var b=v.prototype=d.prototype=Object.create(m);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(r,i,o,s){var u=f(e[r],e,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==l(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,s)}))}s(u.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function k(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=f(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=v,r(b,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=u(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(w.prototype),u(w.prototype,o,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(b),u(b,s,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=_,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function qe(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function Ge(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){qe(i,r,a,o,s,"next",e)}function s(e){qe(i,r,a,o,s,"throw",e)}o(void 0)}))}}function Ke(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xe=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},$e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],a=0;a<e.length;a+=3){var i=e[a],o=a+1<e.length,s=o?e[a+1]:0,u=a+2<e.length,c=u?e[a+2]:0,l=i>>2,f=(3&i)<<4|s>>4,h=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(h=64)),r.push(n[l],n[f],n[h],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Xe(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){var o=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],a=0;a<e.length;){var i=n[e.charAt(a++)],o=a<e.length?n[e.charAt(a)]:0,s=++a<e.length?n[e.charAt(a)]:64,u=++a<e.length?n[e.charAt(a)]:64;if(++a,null==i||null==o||null==s||null==u)throw Error();var c=i<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Qe=function(e){return function(e){var t=Xe(e);return $e.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ye=function(e){try{return $e.decodeString(e,!0)}catch(VC){console.error("base64Decode failed: ",VC)}return null};function Je(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Ze(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(VC){return!1}}var et=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},tt=function(){try{return et()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(VC){return}var t=e&&Ye(e[1]);return t&&JSON.parse(t)}}()}catch(VC){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(VC))}},nt=function(e){var t,n;return null===(n=null===(t=tt())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},rt=function(e){var t=nt(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},at=function(){var e;return null===(e=tt())||void 0===e?void 0:e.config},it=function(e){var t;return null===(t=tt())||void 0===t?void 0:t["_".concat(e)]},ot=function(){function e(){var t=this;c(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return d(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function st(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Qe(JSON.stringify({alg:"none",type:"JWT"})),Qe(JSON.stringify(i)),""].join(".")}var ut=function(e){v(n,e);var t=x(n);function n(e,r,a){var i;return c(this,n),(i=t.call(this,r)).code=e,i.customData=a,i.name="FirebaseError",Object.setPrototypeOf(y(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(y(i),ct.prototype.create),i}return d(n)}(k(Error)),ct=function(){function e(t,n,r){c(this,e),this.service=t,this.serviceName=n,this.errors=r}return d(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?lt(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,")."),o=new ut(n,i,t);return o}}]),e}();function lt(e,t){return e.replace(ft,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var ft=/\{\$([^}]+)}/g;function ht(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(dt(s)&&dt(u)){if(!ht(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function dt(e){return null!==e&&"object"===typeof e}function pt(e){for(var t=[],n=function(){var e=s(a[r],2),n=e[0],i=e[1];Array.isArray(i)?i.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))},r=0,a=Object.entries(e);r<a.length;r++)n();return t.length?"&"+t.join("&"):""}function vt(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=s(e.split("="),2),r=n[0],a=n[1];t[decodeURIComponent(r)]=decodeURIComponent(a)}})),t}function mt(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var gt=function(){function e(t,n){var r=this;c(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return d(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,a=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=We(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a in e&&"function"===typeof e[a])return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=yt),void 0===r.error&&(r.error=yt),void 0===r.complete&&(r.complete=yt);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{a.finalError?r.error(a.finalError):r.complete()}catch(VC){}})),this.observers.push(r),i}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(VC){"undefined"!==typeof console&&console.error&&console.error(VC)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function yt(){}function bt(e){return e&&e._delegate?e._delegate:e}var xt=function(){function e(t,n,r){c(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return d(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),wt="[DEFAULT]",kt=function(){function e(t,n){c(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return d(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new ot;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(VC){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(VC){if(r)return null;throw VC}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:wt})}catch(VC){}var t,n=We(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=s(t.value,2),a=r[0],i=r[1],o=this.normalizeInstanceIdentifier(a);try{var u=this.getOrInitializeService({instanceIdentifier:o});i.resolve(u)}catch(VC){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(u(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),u(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a,i=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=We(this.instancesDeferred.entries());try{for(o.s();!(a=o.n()).done;){var u=s(a.value,2),c=u[0],l=u[1],f=this.normalizeInstanceIdentifier(c);r===f&&l.resolve(i)}}catch(h){o.e(h)}finally{o.f()}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);var i=this.instances.get(r);return i&&e(i,r),function(){a.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i(e,t)}catch(Fb){}}}catch(o){a.e(o)}finally{a.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,a=void 0===r?{}:r,i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===wt?void 0:t),options:a}),this.instances.set(n,i),this.instancesOptions.set(n,a),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch(Fb){}return i||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.component?this.component.multipleInstances?e:wt:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var Et,St,Ct=function(){function e(t){c(this,e),this.name=t,this.providers=new Map}return d(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new kt(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),It=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(St||(St={}));var _t={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},Tt=St.INFO,Nt=(Ke(Et={},St.DEBUG,"log"),Ke(Et,St.VERBOSE,"log"),Ke(Et,St.INFO,"info"),Ke(Et,St.WARN,"warn"),Ke(Et,St.ERROR,"error"),Et),Rt=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Nt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];(a=console)[r].apply(a,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},At=function(){function e(t){c(this,e),this.name=t,this._logLevel=Tt,this._logHandler=Rt,this._userLogHandler=null,It.push(this)}return d(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in St))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?_t[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,St.DEBUG].concat(t)),this._logHandler.apply(this,[this,St.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,St.VERBOSE].concat(t)),this._logHandler.apply(this,[this,St.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,St.INFO].concat(t)),this._logHandler.apply(this,[this,St.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,St.WARN].concat(t)),this._logHandler.apply(this,[this,St.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,St.ERROR].concat(t)),this._logHandler.apply(this,[this,St.ERROR].concat(t))}}]),e}();function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt,Mt;var Ft=new WeakMap,Lt=new WeakMap,Bt=new WeakMap,Ut=new WeakMap,Vt=new WeakMap;var zt={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Lt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Bt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ht(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function jt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Mt||(Mt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(qt(this),n),Ht(Ft.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ht(e.apply(qt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.call.apply(e,[qt(this),t].concat(r));return Bt.set(i,t.sort?t.sort():[t]),Ht(i)}}function Wt(e){return"function"===typeof e?jt(e):(e instanceof IDBTransaction&&function(e){if(!Lt.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));Lt.set(e,t)}}(e),t=e,(Pt||(Pt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,zt):e);var t}function Ht(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",a),e.removeEventListener("error",i)},a=function(){t(Ht(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&Ft.set(t,e)})).catch((function(){})),Vt.set(t,e),t}(e);if(Ut.has(e))return Ut.get(e);var t=Wt(e);return t!==e&&(Ut.set(e,t),Vt.set(t,e)),t}var qt=function(e){return Vt.get(e)};var Gt,Kt,Xt=["get","getKey","getAll","getAllKeys","count"],$t=["put","add","delete","clear"],Qt=new Map;function Yt(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(Qt.get(t))return Qt.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,a=$t.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(a||Xt.includes(n))){var i=function(){var e=Ge(He().mark((function e(t){var i,o,s,u,c,l,f=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,a?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,c),a&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return Qt.set(t,i),i}}}zt=function(e){return Dt(Dt({},e),{},{get:function(t,n,r){return Yt(t,n)||e.get(t,n,r)},has:function(t,n){return!!Yt(t,n)||e.has(t,n)}})}(zt);var Jt=function(){function e(t){c(this,e),this.container=t}return d(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var Zt="@firebase/app",en="0.8.4",tn=new At("@firebase/app"),nn="[DEFAULT]",rn=(Ke(Gt={},Zt,"fire-core"),Ke(Gt,"@firebase/app-compat","fire-core-compat"),Ke(Gt,"@firebase/analytics","fire-analytics"),Ke(Gt,"@firebase/analytics-compat","fire-analytics-compat"),Ke(Gt,"@firebase/app-check","fire-app-check"),Ke(Gt,"@firebase/app-check-compat","fire-app-check-compat"),Ke(Gt,"@firebase/auth","fire-auth"),Ke(Gt,"@firebase/auth-compat","fire-auth-compat"),Ke(Gt,"@firebase/database","fire-rtdb"),Ke(Gt,"@firebase/database-compat","fire-rtdb-compat"),Ke(Gt,"@firebase/functions","fire-fn"),Ke(Gt,"@firebase/functions-compat","fire-fn-compat"),Ke(Gt,"@firebase/installations","fire-iid"),Ke(Gt,"@firebase/installations-compat","fire-iid-compat"),Ke(Gt,"@firebase/messaging","fire-fcm"),Ke(Gt,"@firebase/messaging-compat","fire-fcm-compat"),Ke(Gt,"@firebase/performance","fire-perf"),Ke(Gt,"@firebase/performance-compat","fire-perf-compat"),Ke(Gt,"@firebase/remote-config","fire-rc"),Ke(Gt,"@firebase/remote-config-compat","fire-rc-compat"),Ke(Gt,"@firebase/storage","fire-gcs"),Ke(Gt,"@firebase/storage-compat","fire-gcs-compat"),Ke(Gt,"@firebase/firestore","fire-fst"),Ke(Gt,"@firebase/firestore-compat","fire-fst-compat"),Ke(Gt,"fire-js","fire-js"),Ke(Gt,"firebase","fire-js-all"),Gt),an=new Map,on=new Map;function sn(e,t){try{e.container.addComponent(t)}catch(VC){tn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),VC)}}function un(e){var t=e.name;if(on.has(t))return tn.debug("There were multiple attempts to register component ".concat(t,".")),!1;on.set(t,e);var n,r=We(an.values());try{for(r.s();!(n=r.n()).done;){sn(n.value,e)}}catch(a){r.e(a)}finally{r.f()}return!0}function cn(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var ln=(Ke(Kt={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),Ke(Kt,"bad-app-name","Illegal App name: '{$appName}"),Ke(Kt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),Ke(Kt,"app-deleted","Firebase App named '{$appName}' already deleted"),Ke(Kt,"no-options","Need to provide options, when not being deployed to hosting via source."),Ke(Kt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Ke(Kt,"invalid-log-argument","First argument to `onLog` must be null or a function."),Ke(Kt,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),Ke(Kt,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),Ke(Kt,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),Ke(Kt,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),Kt),fn=new ct("app","Firebase",ln),hn=function(){function e(t,n,r){var a=this;c(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xt("app",(function(){return a}),"PUBLIC"))}return d(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw fn.create("app-deleted",{appName:this._name})}}]),e}(),dn="9.14.0";function pn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){var r=t;t={name:r}}var a=Object.assign({name:nn,automaticDataCollectionEnabled:!1},t),i=a.name;if("string"!==typeof i||!i)throw fn.create("bad-app-name",{appName:String(i)});if(n||(n=at()),!n)throw fn.create("no-options");var o=an.get(i);if(o){if(ht(n,o.options)&&ht(a,o.config))return o;throw fn.create("duplicate-app",{appName:i})}var s,u=new Ct(i),c=We(on.values());try{for(c.s();!(s=c.n()).done;){var l=s.value;u.addComponent(l)}}catch(h){c.e(h)}finally{c.f()}var f=new hn(n,a,u);return an.set(i,f),f}function vn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn,t=an.get(e);if(!t&&e===nn)return pn();if(!t)throw fn.create("no-app",{appName:e});return t}function mn(e,t,n){var r,a=null!==(r=rn[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));var i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){var s=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void tn.warn(s.join(" "))}un(new xt("".concat(a,"-version"),(function(){return{library:a,version:t}}),"VERSION"))}var gn="firebase-heartbeat-store",yn=null;function bn(){return yn||(yn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,a=n.upgrade,i=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Ht(s);return a&&s.addEventListener("upgradeneeded",(function(e){a(Ht(s.result),e.oldVersion,e.newVersion,Ht(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),u}("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(gn)}}).catch((function(e){throw fn.create("idb-open",{originalErrorMessage:e.message})}))),yn}function xn(e){return wn.apply(this,arguments)}function wn(){return wn=Ge(He().mark((function e(t){var n,r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn();case 3:return r=e.sent,e.abrupt("return",r.transaction(gn).objectStore(gn).get(Sn(t)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof ut?tn.warn(e.t0.message):(a=fn.create("idb-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message}),tn.warn(a.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),wn.apply(this,arguments)}function kn(e,t){return En.apply(this,arguments)}function En(){return En=Ge(He().mark((function e(t,n){var r,a,i,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn();case 3:return a=e.sent,i=a.transaction(gn,"readwrite"),o=i.objectStore(gn),e.next=8,o.put(n,Sn(t));case 8:return e.abrupt("return",i.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof ut?tn.warn(e.t0.message):(s=fn.create("idb-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message}),tn.warn(s.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),En.apply(this,arguments)}function Sn(e){return"".concat(e.name,"!").concat(e.options.appId)}var Cn=function(){function e(t){var n=this;c(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Nn(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return d(e,[{key:"triggerHeartbeat",value:function(){var e=Ge(He().mark((function e(){var t,n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=In(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=Ge(He().mark((function e(){var t,n,r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=In(),n=_n(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,a=n.unsentEntries,i=Qe(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(a.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=a,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function In(){return(new Date).toISOString().substring(0,10)}function _n(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],a=e.slice(),i=We(e);try{var o=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),Rn(r)>n)return i.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),Rn(r)>n)return r.pop(),"break";a=a.slice(1)};for(i.s();!(t=i.n()).done;){var s=o();if("break"===s)break}}catch(u){i.e(u)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:a}}var Tn,Nn=function(){function e(t){c(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return d(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof indexedDB){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=function(){a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=function(){n=!1},a.onerror=function(){var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,xn(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",kn(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",kn(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(u(r.heartbeats),u(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Rn(e){return Qe(JSON.stringify({version:2,heartbeats:e})).length}Tn="",un(new xt("platform-logger",(function(e){return new Jt(e)}),"PRIVATE")),un(new xt("heartbeat",(function(e){return new Cn(e)}),"PRIVATE")),mn(Zt,en,Tn),mn(Zt,en,"esm2017"),mn("fire-js","");function An(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;var On;Object.create;function Dn(){return Ke({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var Pn=Dn,Mn=new ct("auth","Firebase",Dn()),Fn=new At("@firebase/auth");function Ln(e){if(Fn.logLevel<=St.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Fn.error.apply(Fn,["Auth (".concat(dn,"): ").concat(e)].concat(n))}}function Bn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw zn.apply(void 0,[e].concat(n))}function Un(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return zn.apply(void 0,[e].concat(n))}function Vn(e,t,n){var r=Object.assign(Object.assign({},Pn()),Ke({},t,n));return new ct("auth","Firebase",r).create(t,{appName:e.name})}function zn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var a,i=n[0],o=u(n.slice(1));return o[0]&&(o[0].appName=e.name),(a=e._errorFactory).create.apply(a,[i].concat(u(o)))}return Mn.create.apply(Mn,[e].concat(n))}function jn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw zn.apply(void 0,[t].concat(r))}}function Wn(e){var t="INTERNAL ASSERTION FAILED: "+e;throw Ln(t),new Error(t)}function Hn(e,t){e||Wn(t)}var qn=new Map;function Gn(e){Hn(e instanceof Function,"Expected a class definition");var t=qn.get(e);return t?(Hn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,qn.set(e,t),t)}function Kn(e,t){var n=cn(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(ht(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;Bn(r,"already-initialized")}return n.initialize({options:t})}function Xn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function $n(){return"http:"===Qn()||"https:"===Qn()}function Qn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Yn(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&($n()||function(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}var Jn=function(){function e(t,n){c(this,e),this.shortDelay=t,this.longDelay=n,Hn(n>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Je())||"object"===typeof navigator&&"ReactNative"===navigator.product}return d(e,[{key:"get",value:function(){return Yn()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}]),e}();function Zn(e,t){Hn(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var er=function(){function e(){c(this,e)}return d(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),tr=(Ke(On={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),Ke(On,"MISSING_CUSTOM_TOKEN","internal-error"),Ke(On,"INVALID_IDENTIFIER","invalid-email"),Ke(On,"MISSING_CONTINUE_URI","internal-error"),Ke(On,"INVALID_PASSWORD","wrong-password"),Ke(On,"MISSING_PASSWORD","internal-error"),Ke(On,"EMAIL_EXISTS","email-already-in-use"),Ke(On,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),Ke(On,"INVALID_IDP_RESPONSE","invalid-credential"),Ke(On,"INVALID_PENDING_TOKEN","invalid-credential"),Ke(On,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),Ke(On,"MISSING_REQ_TYPE","internal-error"),Ke(On,"EMAIL_NOT_FOUND","user-not-found"),Ke(On,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),Ke(On,"EXPIRED_OOB_CODE","expired-action-code"),Ke(On,"INVALID_OOB_CODE","invalid-action-code"),Ke(On,"MISSING_OOB_CODE","internal-error"),Ke(On,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),Ke(On,"INVALID_ID_TOKEN","invalid-user-token"),Ke(On,"TOKEN_EXPIRED","user-token-expired"),Ke(On,"USER_NOT_FOUND","user-token-expired"),Ke(On,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),Ke(On,"INVALID_CODE","invalid-verification-code"),Ke(On,"INVALID_SESSION_INFO","invalid-verification-id"),Ke(On,"INVALID_TEMPORARY_PROOF","invalid-credential"),Ke(On,"MISSING_SESSION_INFO","missing-verification-id"),Ke(On,"SESSION_EXPIRED","code-expired"),Ke(On,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),Ke(On,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),Ke(On,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),Ke(On,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),Ke(On,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),Ke(On,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),Ke(On,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),Ke(On,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),Ke(On,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),Ke(On,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),Ke(On,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),On),nr=new Jn(3e4,6e4);function rr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function ar(e,t,n,r){return ir.apply(this,arguments)}function ir(){return ir=Ge(He().mark((function e(t,n,r,a){var i,o=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",or(t,i,Ge(He().mark((function e(){var i,o,s,u;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},o={},a&&("GET"===n?o=a:i={body:JSON.stringify(a)}),s=pt(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(u=e.sent)["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",er.fetch()(lr(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},i)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),ir.apply(this,arguments)}function or(e,t,n){return sr.apply(this,arguments)}function sr(){return sr=Ge(He().mark((function e(t,n,r){var a,i,o,u,c,l,f,h,d,p;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,a=Object.assign(Object.assign({},tr),n),e.prev=2,i=new fr(t),e.next=6,Promise.race([r(),i.promise]);case 6:return o=e.sent,i.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(u=e.sent))){e.next=13;break}throw hr(t,"account-exists-with-different-credential",u);case 13:if(!o.ok||"errorMessage"in u){e.next=17;break}return e.abrupt("return",u);case 17:if(c=o.ok?u.errorMessage:u.error.message,l=c.split(" : "),f=s(l,2),h=f[0],d=f[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=23;break}throw hr(t,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==h){e.next=27;break}throw hr(t,"email-already-in-use",u);case 27:if("USER_DISABLED"!==h){e.next=29;break}throw hr(t,"user-disabled",u);case 29:if(p=a[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw Vn(t,p,d);case 34:Bn(t,p);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof ut)){e.next=41;break}throw e.t0;case 41:Bn(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),sr.apply(this,arguments)}function ur(e,t,n,r){return cr.apply(this,arguments)}function cr(){return cr=Ge(He().mark((function e(t,n,r,a){var i,o,s=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,ar(t,n,r,a,i);case 3:return"mfaPendingCredential"in(o=e.sent)&&Bn(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),cr.apply(this,arguments)}function lr(e,t,n,r){var a="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Zn(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}var fr=function(){function e(t){var n=this;c(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(Un(n.auth,"network-request-failed"))}),nr.get())}))}return d(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function hr(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var a=Un(e,t,r);return a.customData._tokenResponse=n,a}function dr(e,t){return pr.apply(this,arguments)}function pr(){return pr=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ar(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),pr.apply(this,arguments)}function vr(e,t){return mr.apply(this,arguments)}function mr(){return mr=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ar(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),mr.apply(this,arguments)}function gr(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(VC){}}function yr(){return yr=Ge(He().mark((function e(t){var n,r,a,i,o,s,u=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=bt(t),e.next=4,r.getIdToken(n);case 4:return a=e.sent,jn((i=xr(a))&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error"),o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:i,token:a,authTime:gr(br(i.auth_time)),issuedAtTime:gr(br(i.iat)),expirationTime:gr(br(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),yr.apply(this,arguments)}function br(e){return 1e3*Number(e)}function xr(e){var t,n=s(e.split("."),3),r=n[0],a=n[1],i=n[2];if(void 0===r||void 0===a||void 0===i)return Ln("JWT malformed, contained fewer than 3 sections"),null;try{var o=Ye(a);return o?JSON.parse(o):(Ln("Failed to decode base64 JWT payload"),null)}catch(VC){return Ln("Caught error parsing JWT payload as JSON",null===(t=VC)||void 0===t?void 0:t.toString()),null}}function wr(e,t){return kr.apply(this,arguments)}function kr(){return kr=Ge(He().mark((function e(t,n){var r=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof ut&&Er(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),kr.apply(this,arguments)}function Er(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var Sr=function(){function e(t){c(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return d(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(Ge(He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===(t=e.t0)||void 0===t?void 0:t.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Cr=function(){function e(t,n){c(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return d(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=gr(this.lastLoginAt),this.creationTime=gr(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Ir(e){return _r.apply(this,arguments)}function _r(){return _r=Ge(He().mark((function e(t){var n,r,a,i,o,s,u,c,l,f,h;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,e.next=6,wr(t,vr(r,{idToken:a}));case 6:jn(null===(i=e.sent)||void 0===i?void 0:i.users.length,r,"internal-error"),o=i.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?Rr(o.providerUserInfo):[],u=Nr(t.providerData,s),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===u||void 0===u?void 0:u.length),f=!!c&&l,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Cr(o.createdAt,o.lastLoginAt),isAnonymous:f},Object.assign(t,h);case 17:case"end":return e.stop()}}),e)}))),_r.apply(this,arguments)}function Tr(){return(Tr=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=bt(t),e.next=3,Ir(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nr(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(u(n),u(t))}function Rr(e){return e.map((function(e){var t=e.providerId,n=An(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function Ar(e,t){return Or.apply(this,arguments)}function Or(){return Or=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,or(t,{},Ge(He().mark((function e(){var r,a,i,o,s,u;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=pt({grant_type:"refresh_token",refresh_token:n}).slice(1),a=t.config,i=a.tokenApiHost,o=a.apiKey,s=lr(t,i,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(u=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",er.fetch()(s,{method:"POST",headers:u,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),Or.apply(this,arguments)}var Dr=function(){function e(){c(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return d(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){jn(e.idToken,"internal-error"),jn("undefined"!==typeof e.idToken,"internal-error"),jn("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=xr(e);return jn(t,"internal-error"),jn("undefined"!==typeof t.exp,"internal-error"),jn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=Ge(He().mark((function e(t){var n,r=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],jn(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=Ge(He().mark((function e(t,n){var r,a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ar(t,n);case 2:r=e.sent,a=r.accessToken,i=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(a,i,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return Wn("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,a=n.accessToken,i=n.expirationTime,o=new e;return r&&(jn("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),a&&(jn("string"===typeof a,"internal-error",{appName:t}),o.accessToken=a),i&&(jn("number"===typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}}]),e}();function Pr(e,t){jn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var Mr=function(){function e(t){c(this,e);var n=t.uid,r=t.auth,a=t.stsTokenManager,i=An(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Sr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?u(i.providerData):[],this.metadata=new Cr(i.createdAt||void 0,i.lastLoginAt||void 0)}return d(e,[{key:"getIdToken",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wr(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(jn(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return yr.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Tr.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(jn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){jn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=Ge(He().mark((function e(t){var n,r,a=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,Ir(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,wr(this,dr(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,a,i,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(a=n.email)&&void 0!==a?a:void 0,d=null!==(i=n.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,m=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,g=null!==(c=n.createdAt)&&void 0!==c?c:void 0,y=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,x=n.emailVerified,w=n.isAnonymous,k=n.providerData,E=n.stsTokenManager;jn(b&&E,t,"internal-error");var S=Dr.fromJSON(this.name,E);jn("string"===typeof b,t,"internal-error"),Pr(f,t.name),Pr(h,t.name),jn("boolean"===typeof x,t,"internal-error"),jn("boolean"===typeof w,t,"internal-error"),Pr(d,t.name),Pr(p,t.name),Pr(v,t.name),Pr(m,t.name),Pr(g,t.name),Pr(y,t.name);var C=new e({uid:b,auth:t,email:h,emailVerified:x,displayName:f,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:S,createdAt:g,lastLoginAt:y});return k&&Array.isArray(k)&&(C.providerData=k.map((function(e){return Object.assign({},e)}))),m&&(C._redirectEventId=m),C}},{key:"_fromIdTokenResponse",value:function(){var t=Ge(He().mark((function t(n,r){var a,i,o,s=arguments;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],(i=new Dr).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:i,isAnonymous:a}),t.next=6,Ir(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),Fr=function(){function e(){c(this,e),this.type="NONE",this.storage={}}return d(e,[{key:"_isAvailable",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();Fr.type="NONE";var Lr=Fr;function Br(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var Ur=function(){function e(t,n,r){c(this,e),this.persistence=t,this.auth=n,this.userKey=r;var a=this.auth,i=a.config,o=a.name;this.fullUserKey=Br(this.userKey,i.apiKey,o),this.fullPersistenceKey=Br("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return d(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?Mr._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=Ge(He().mark((function t(n,r){var a,i,o,s,u,c,l,f,h,d,p,v=arguments;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(Gn(Lr),n,a));case 3:return t.next=5,Promise.all(r.map(function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:i=t.sent.filter((function(e){return e})),o=i[0]||Gn(Lr),s=Br(a,n.config.apiKey,n.name),u=null,c=We(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return f=l.value,t.prev=14,t.next=17,f._get(s);case 17:if(!(h=t.sent)){t.next=23;break}return d=Mr._fromJSON(n,h),f!==o&&(u=d),o=f,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(p=i.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&p.length){t.next=40;break}return t.abrupt("return",new e(o,n,a));case 40:if(o=p[0],!u){t.next=44;break}return t.next=44,o._set(s,u.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,a));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function Vr(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Hr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(zr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Gr(t))return"Blackberry";if(Kr(t))return"Webos";if(jr(t))return"Safari";if((t.includes("chrome/")||Wr(t))&&!t.includes("edge/"))return"Chrome";if(qr(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function zr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/firefox\//i.test(e)}function jr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/crios\//i.test(e)}function Hr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/iemobile/i.test(e)}function qr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/android/i.test(e)}function Gr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/blackberry/i.test(e)}function Kr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/webos/i.test(e)}function Xr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function $r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return Xr(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function Qr(){return function(){var e=Je();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Yr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je();return Xr(e)||qr(e)||Kr(e)||Gr(e)||/windows phone/i.test(e)||Hr(e)}function Jr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Vr(Je());break;case"Worker":t="".concat(Vr(Je()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(dn,"/").concat(r)}var Zr=function(){function e(t){c(this,e),this.auth=t,this.queue=[]}return d(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(VC){r(VC)}}))};r.onAbort=t,this.queue.push(r);var a=this.queue.length-1;return function(){n.queue[a]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=Ge(He().mark((function e(t){var n,r,a,i,o,s,u,c;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:r=[],e.prev=3,a=We(this.queue),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=14;break}return o=i.value,e.next=11,o(t);case 11:o.onAbort&&r.push(o.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),r.reverse(),s=We(r);try{for(s.s();!(u=s.n()).done;){c=u.value;try{c()}catch(Vw){}}}catch(l){s.e(l)}finally{s.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(n=e.t1)||void 0===n?void 0:n.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ea=function(){function e(t,n,r){c(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new na(this),this.idTokenSubscription=new na(this),this.beforeStateQueue=new Zr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Mn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return d(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=Gn(t)),this._initializationPromise=this.queue(Ge(He().mark((function r(){var a,i;return He().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,Ur.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=Ge(He().mark((function e(t){var n,r,a,i,o,s,u;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,a=r,i=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===a||void 0===a?void 0:a._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:u=e.sent,o&&o!==s||!(null===u||void 0===u?void 0:u.user)||(a=u.user,i=!0);case 14:if(a){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(a._redirectEventId){e.next=32;break}if(!i){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(a);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),a=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!a){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return jn(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ir(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===(n=e.t0)||void 0===n?void 0:n.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?bt(t):null)&&jn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=Ge(He().mark((function e(t){var n,r=this,a=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&jn(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(Ge(He().mark((function n(){return He().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(Gn(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new ct("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return jn(n=t&&Gn(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,Ur.create(this,[Gn(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=Ge(He().mark((function e(t){var n=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var a=this;if(this._deleted)return function(){};var i="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return jn(o,this,"internal-error"),o.then((function(){return i(a.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return jn(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Jr(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=Ge(He().mark((function e(){var t,n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ke({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function ta(e){return bt(e)}var na=function(){function e(t){var n=this;c(this,e),this.auth=t,this.observer=null,this.addObserver=function(e,t){var n=new gt(e,t);return n.subscribe.bind(n)}((function(e){return n.observer=e}))}return d(e,[{key:"next",get:function(){return jn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function ra(e,t,n){var r=ta(e);jn(r._canInitEmulator,r,"emulator-config-failed"),jn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=aa(t),o=function(e){var t=aa(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){var i=a[1];return{host:i,port:ia(r.substr(i.length+1))}}var o=s(r.split(":"),2);return{host:o[0],port:ia(o[1])}}(t),u=o.host,c=o.port,l=null===c?"":":".concat(c);r.config.emulator={url:"".concat(i,"//").concat(u).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function aa(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ia(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var oa=function(){function e(t,n){c(this,e),this.providerId=t,this.signInMethod=n}return d(e,[{key:"toJSON",value:function(){return Wn("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Wn("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Wn("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Wn("not implemented")}}]),e}();function sa(e,t){return ua.apply(this,arguments)}function ua(){return ua=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ar(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),ua.apply(this,arguments)}function ca(e,t){return la.apply(this,arguments)}function la(){return la=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithPassword",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),la.apply(this,arguments)}function fa(e,t){return ha.apply(this,arguments)}function ha(){return ha=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithEmailLink",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),ha.apply(this,arguments)}function da(e,t){return pa.apply(this,arguments)}function pa(){return pa=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithEmailLink",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),pa.apply(this,arguments)}var va=function(e){v(n,e);var t=x(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(i=t.call(this,"password",a))._email=e,i._password=r,i._tenantId=o,i}return d(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",ca(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",fa(t,{email:this._email,oobCode:this._password}));case 5:Bn(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",sa(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",da(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:Bn(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(oa);function ma(e,t){return ga.apply(this,arguments)}function ga(){return ga=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithIdp",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),ga.apply(this,arguments)}var ya=function(e){v(n,e);var t=x(n);function n(){var e;return c(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return d(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return ma(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,ma(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,ma(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pt(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Bn("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,a=t.signInMethod,i=An(t,["providerId","signInMethod"]);if(!r||!a)return null;var o=new n(r,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}}]),n}(oa);function ba(e,t){return xa.apply(this,arguments)}function xa(){return xa=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ar(t,"POST","/v1/accounts:sendVerificationCode",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),xa.apply(this,arguments)}function wa(){return wa=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithPhoneNumber",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),wa.apply(this,arguments)}function ka(){return ka=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ur(t,"POST","/v1/accounts:signInWithPhoneNumber",rr(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw hr(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),ka.apply(this,arguments)}var Ea=Ke({},"USER_NOT_FOUND","user-not-found");function Sa(){return Sa=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",ur(t,"POST","/v1/accounts:signInWithPhoneNumber",rr(t,r),Ea));case 2:case"end":return e.stop()}}),e)}))),Sa.apply(this,arguments)}var Ca=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this,"phone","phone")).params=e,r}return d(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return wa.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return ka.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Sa.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,a=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:a}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,a=t.verificationCode,i=t.phoneNumber,o=t.temporaryProof;return a||r||i||o?new n({verificationId:r,verificationCode:a,phoneNumber:i,temporaryProof:o}):null}}]),n}(oa);var Ia=function(){function e(t){var n,r,a,i,o,s;c(this,e);var u=vt(mt(t)),l=null!==(n=u.apiKey)&&void 0!==n?n:null,f=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=u.mode)&&void 0!==a?a:null);jn(l&&f&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=f,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return d(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=vt(mt(e)).link,n=t?vt(mt(t)).deep_link_id:null,r=vt(mt(e)).deep_link_id;return(r?vt(mt(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(Fb){return null}}}]),e}();var _a=function(){function e(){c(this,e),this.providerId=e.PROVIDER_ID}return d(e,null,[{key:"credential",value:function(e,t){return va._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Ia.parseLink(t);return jn(n,"argument-error"),va._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();_a.PROVIDER_ID="password",_a.EMAIL_PASSWORD_SIGN_IN_METHOD="password",_a.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ta=function(){function e(t){c(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return d(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),Na=function(e){v(n,e);var t=x(n);function n(){var e;return c(this,n),(e=t.apply(this,arguments)).scopes=[],e}return d(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return u(this.scopes)}}]),n}(Ta),Ra=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.call(this,"facebook.com")}return d(n,null,[{key:"credential",value:function(e){return ya._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Fb){return null}}}]),n}(Na);Ra.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ra.PROVIDER_ID="facebook.com";var Aa=function(e){v(n,e);var t=x(n);function n(){var e;return c(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return d(n,null,[{key:"credential",value:function(e,t){return ya._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,a=t.oauthAccessToken;if(!r&&!a)return null;try{return n.credential(r,a)}catch(Fb){return null}}}]),n}(Na);Aa.GOOGLE_SIGN_IN_METHOD="google.com",Aa.PROVIDER_ID="google.com";var Oa=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.call(this,"github.com")}return d(n,null,[{key:"credential",value:function(e){return ya._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Fb){return null}}}]),n}(Na);Oa.GITHUB_SIGN_IN_METHOD="github.com",Oa.PROVIDER_ID="github.com";var Da=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.call(this,"twitter.com")}return d(n,null,[{key:"credential",value:function(e,t){return ya._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,a=t.oauthTokenSecret;if(!r||!a)return null;try{return n.credential(r,a)}catch(Fb){return null}}}]),n}(Na);function Pa(e,t){return Ma.apply(this,arguments)}function Ma(){return Ma=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ur(t,"POST","/v1/accounts:signUp",rr(t,n)));case 1:case"end":return e.stop()}}),e)}))),Ma.apply(this,arguments)}Da.TWITTER_SIGN_IN_METHOD="twitter.com",Da.PROVIDER_ID="twitter.com";var Fa=function(){function e(t){c(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return d(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=Ge(He().mark((function t(n,r,a){var i,o,s,u,c=arguments;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],t.next=3,Mr._fromIdTokenResponse(n,a,i);case 3:return o=t.sent,s=La(a),u=new e({user:o,providerId:s,_tokenResponse:a,operationType:r}),t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=Ge(He().mark((function t(n,r,a){var i;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(a,!0);case 2:return i=La(a),t.abrupt("return",new e({user:n,providerId:i,_tokenResponse:a,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function La(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var Ba=function(e){v(n,e);var t=x(n);function n(e,r,a,i){var o,s;return c(this,n),(o=t.call(this,r.code,r.message)).operationType=a,o.user=i,Object.setPrototypeOf(y(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:a},o}return d(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,a){return new n(e,t,r,a)}}]),n}(ut);function Ua(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw Ba._fromErrorAndOperation(e,n,t,r);throw n}))}function Va(e,t){return za.apply(this,arguments)}function za(){return za=Ge(He().mark((function e(t,n){var r,a,i=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],e.t0=wr,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",Fa._forOperation(t,"link",a));case 14:case"end":return e.stop()}}),e)}))),za.apply(this,arguments)}function ja(e,t){return Wa.apply(this,arguments)}function Wa(){return Wa=Ge(He().mark((function e(t,n){var r,a,i,o,s,u,c,l=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],i=t.auth,o="reauthenticate",e.prev=3,e.next=6,wr(t,Ua(i,o,n,t),r);case 6:return jn((s=e.sent).idToken,i,"internal-error"),jn(u=xr(s.idToken),i,"internal-error"),c=u.sub,jn(t.uid===c,i,"user-mismatch"),e.abrupt("return",Fa._forOperation(t,o,s));case 15:throw e.prev=15,e.t0=e.catch(3),(null===(a=e.t0)||void 0===a?void 0:a.code)==="auth/".concat("user-not-found")&&Bn(i,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),Wa.apply(this,arguments)}function Ha(e,t){return qa.apply(this,arguments)}function qa(){return qa=Ge(He().mark((function e(t,n){var r,a,i,o,s=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,Ua(t,a,n);case 4:return i=e.sent,e.next=7,Fa._fromIdTokenResponse(t,a,i);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),qa.apply(this,arguments)}function Ga(e,t){return Ka.apply(this,arguments)}function Ka(){return Ka=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ha(ta(t),n));case 1:case"end":return e.stop()}}),e)}))),Ka.apply(this,arguments)}function Xa(e,t,n){return $a.apply(this,arguments)}function $a(){return $a=Ge(He().mark((function e(t,n,r){var a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ta(t),e.next=3,Pa(a,{returnSecureToken:!0,email:n,password:r});case 3:return i=e.sent,e.next=6,Fa._fromIdTokenResponse(a,"signIn",i);case 6:return o=e.sent,e.next=9,a._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)}))),$a.apply(this,arguments)}function Qa(e,t,n){return Ga(bt(e),_a.credential(t,n))}function Ya(e,t){return Ja.apply(this,arguments)}function Ja(){return Ja=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ar(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),Ja.apply(this,arguments)}function Za(e,t){return ei.apply(this,arguments)}function ei(){return(ei=Ge(He().mark((function e(t,n){var r,a,i,o,s,u,c;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,a=n.photoURL,void 0!==r||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return i=bt(t),e.next=6,i.getIdToken();case 6:return o=e.sent,s={idToken:o,displayName:r,photoUrl:a,returnSecureToken:!0},e.next=10,wr(i,Ya(i.auth,s));case 10:return u=e.sent,i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null,(c=i.providerData.find((function(e){return"password"===e.providerId})))&&(c.displayName=i.displayName,c.photoURL=i.photoURL),e.next=17,i._updateTokensIfNecessary(u);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ti(e,t,n,r){return bt(e).onIdTokenChanged(t,n,r)}function ni(e,t,n){return bt(e).beforeAuthStateChanged(t,n)}function ri(e,t){return ar(e,"POST","/v2/accounts/mfaEnrollment:start",rr(e,t))}new WeakMap;var ai="__sak",ii=function(){function e(t,n){c(this,e),this.storageRetriever=t,this.type=n}return d(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(ai,"1"),this.storage.removeItem(ai),Promise.resolve(!0)):Promise.resolve(!1)}catch(Fb){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var oi=function(e){v(n,e);var t=x(n);function n(){var e;return c(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=Je();return jr(e)||Xr(e)}()&&function(){try{return!(!window||window===window.top)}catch(VC){return!1}}(),e.fallbackToPolling=Yr(),e._shouldAllowMigration=!0,e}return d(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],a=this.storage.getItem(r),i=this.localCache[r];a!==i&&e(r,i,a)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var a=this.storage.getItem(r);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);Qr()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=Ge(He().mark((function e(t,r){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(m(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Ge(He().mark((function e(t){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(m(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(m(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ii);oi.type="LOCAL";var si=oi,ui=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return d(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(ii);ui.type="SESSION";var ci=ui;function li(e){return Promise.all(e.map(function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var fi=function(){function e(t){c(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return d(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=Ge(He().mark((function e(t){var n,r,a,i,o,s,u,c;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,a=r.eventId,i=r.eventType,o=r.data,null===(s=this.handlersMap[i])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:a,eventType:i}),u=Array.from(s).map(function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,li(u);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:a,eventType:i,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function hi(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}fi.receivers=[];var di=function(){function e(t){c(this,e),this.target=t,this.handlers=new Set}return d(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=Ge(He().mark((function e(t,n){var r,a,i,o,s=this,u=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:50,a="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,u){var c=hi("",20);a.port1.start();var l=setTimeout((function(){u(new Error("unsupported_event"))}),r);o={messageChannel:a,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),i=setTimeout((function(){u(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),e(n.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"))}}},s.handlers.add(o),a.port1.addEventListener("message",o.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[a.port2])})).finally((function(){o&&s.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function pi(){return window}function vi(){return"undefined"!==typeof pi().WorkerGlobalScope&&"function"===typeof pi().importScripts}function mi(){return gi.apply(this,arguments)}function gi(){return(gi=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function yi(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var bi="firebaseLocalStorageDb",xi="firebaseLocalStorage",wi="fbase_key",ki=function(){function e(t){c(this,e),this.request=t}return d(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function Ei(e,t){return e.transaction([xi],t?"readwrite":"readonly").objectStore(xi)}function Si(){var e=indexedDB.deleteDatabase(bi);return new ki(e).toPromise()}function Ci(){var e=indexedDB.open(bi,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(xi,{keyPath:wi})}catch(VC){n(VC)}})),e.addEventListener("success",Ge(He().mark((function n(){var r;return He().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(xi)){n.next=12;break}return r.close(),n.next=5,Si();case 5:return n.t0=t,n.next=8,Ci();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function Ii(e,t,n){return _i.apply(this,arguments)}function _i(){return _i=Ge(He().mark((function e(t,n,r){var a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ei(t,!0).put((Ke(a={},wi,n),Ke(a,"value",r),a)),e.abrupt("return",new ki(i).toPromise());case 2:case"end":return e.stop()}}),e)}))),_i.apply(this,arguments)}function Ti(e,t){return Ni.apply(this,arguments)}function Ni(){return Ni=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ei(t,!1).get(n),e.next=3,new ki(r).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),e)}))),Ni.apply(this,arguments)}function Ri(e,t){var n=Ei(e,!0).delete(t);return new ki(n).toPromise()}var Ai=function(){function e(){c(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return d(e,[{key:"_openDb",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,Ci();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vi()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=Ge(He().mark((function e(){var t=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=fi._getInstance(vi()?self:null),this.receiver._subscribe("keyChanged",function(){var e=Ge(He().mark((function e(n,r){var a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=Ge(He().mark((function e(){var t,n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mi();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new di(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&yi()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Ci();case 5:return t=e.sent,e.next=8,Ii(t,ai,"1");case 8:return e.next=10,Ri(t,ai);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=Ge(He().mark((function e(t,n){var r=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return Ii(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return Ti(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Ge(He().mark((function e(t){var n=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return Ri(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=Ge(He().mark((function e(){var t,n,r,a,i,o,s,u,c,l,f;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=Ei(e,!1).getAll();return new ki(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,a=We(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.fbase_key,u=o.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(u)&&(this.notifyListeners(s,u),n.push(s))}catch(h){a.e(h)}finally{a.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)f=l[c],this.localCache[f]&&!r.has(f)&&(this.notifyListeners(f,null),n.push(f));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(Ge(He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();Ai.type="LOCAL";var Oi=Ai;function Di(e,t){return ar(e,"POST","/v2/accounts/mfaSignIn:start",rr(e,t))}function Pi(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=Un("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Mi(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}Mi("rcb"),new Jn(3e4,6e4);var Fi="recaptcha";function Li(e,t,n){return Bi.apply(this,arguments)}function Bi(){return Bi=Ge(He().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(i=e.sent,e.prev=3,jn("string"===typeof i,t,"argument-error"),jn(r.type===Fi,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=o.session,!("phoneNumber"in o)){e.next=17;break}return jn("enroll"===s.type,t,"internal-error"),e.next=13,ri(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});case 13:return u=e.sent,e.abrupt("return",u.phoneSessionInfo.sessionInfo);case 17:return jn("signin"===s.type,t,"internal-error"),jn(c=(null===(a=o.multiFactorHint)||void 0===a?void 0:a.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,Di(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:i}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,ba(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});case 28:return f=e.sent,h=f.sessionInfo,e.abrupt("return",h);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),Bi.apply(this,arguments)}var Ui=function(){function e(t){c(this,e),this.providerId=e.PROVIDER_ID,this.auth=ta(t)}return d(e,[{key:"verifyPhoneNumber",value:function(e,t){return Li(this.auth,e,bt(t))}}],[{key:"credential",value:function(e,t){return Ca._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Ca._fromTokenResponse(n,r):null}}]),e}();function Vi(e,t){return t?Gn(t):(jn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ui.PROVIDER_ID="phone",Ui.PHONE_SIGN_IN_METHOD="phone";var zi=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this,"custom","custom")).params=e,r}return d(n,[{key:"_getIdTokenResponse",value:function(e){return ma(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return ma(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return ma(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(oa);function ji(e){return Ha(e.auth,new zi(e),e.bypassAuthState)}function Wi(e){var t=e.auth,n=e.user;return jn(n,t,"internal-error"),ja(n,new zi(e),e.bypassAuthState)}function Hi(e){return qi.apply(this,arguments)}function qi(){return qi=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,jn(r=t.user,n,"internal-error"),e.abrupt("return",Va(r,new zi(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),qi.apply(this,arguments)}var Gi=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(this,e),this.auth=t,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return d(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=Ge(He().mark((function t(n,r){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=Ge(He().mark((function e(t){var n,r,a,i,o,s,u;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,a=t.postBody,i=t.tenantId,o=t.error,s=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(u);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ji;case"linkViaPopup":case"linkViaRedirect":return Hi;case"reauthViaPopup":case"reauthViaRedirect":return Wi;default:Bn(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),Ki=new Jn(2e3,1e4);var Xi=function(e){v(n,e);var t=x(n);function n(e,r,a,i,o){var s;return c(this,n),(s=t.call(this,e,r,i,o)).provider=a,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=y(s),s}return d(n,[{key:"executeNotNull",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return jn(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=Ge(He().mark((function e(){var t,n=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hn(1===this.filter.length,"Popup operations only handle one event"),t=hi(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(Un(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Un(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(Un(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,Ki.get())}()}}]),n}(Gi);Xi.currentPopupAction=null;var $i=new Map,Qi=function(e){v(n,e);var t=x(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,n),(a=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i)).eventId=null,a}return d(n,[{key:"execute",value:function(){var e=Ge(He().mark((function e(){var t,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$i.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,Yi(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,je(m(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:$i.set(this.auth._key(),t);case 21:return this.bypassAuthState||$i.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=Ge(He().mark((function e(t){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",je(m(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",je(m(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(Gi);function Yi(e,t){return Ji.apply(this,arguments)}function Ji(){return Ji=Ge(He().mark((function e(t,n){var r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=to(n),a=eo(t),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(r);case 8:return e.t0=e.sent,i="true"===e.t0,e.next=12,a._remove(r);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)}))),Ji.apply(this,arguments)}function Zi(e,t){$i.set(e._key(),t)}function eo(e){return Gn(e._redirectPersistence)}function to(e){return Br("pendingRedirect",e.config.apiKey,e.name)}function no(e,t){return ro.apply(this,arguments)}function ro(){return ro=Ge(He().mark((function e(t,n){var r,a,i,o,s,u=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],a=ta(t),i=Vi(a,n),o=new Qi(a,i,r),e.next=6,o.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),ro.apply(this,arguments)}var ao=function(){function e(t){c(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return d(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oo(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!oo(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Un(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(io(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(io(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function io(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function oo(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function so(e){return uo.apply(this,arguments)}function uo(){return uo=Ge(He().mark((function e(t){var n,r=arguments;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",ar(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),uo.apply(this,arguments)}var co=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lo=/^https?/;function fo(){return fo=Ge(He().mark((function e(t){var n,r,a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,so(t);case 4:n=e.sent,r=n.authorizedDomains,a=We(r),e.prev=7,a.s();case 9:if((i=a.n()).done){e.next=20;break}if(o=i.value,e.prev=11,!ho(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:Bn(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),fo.apply(this,arguments)}function ho(e){var t=Xn(),n=new URL(t),r=n.protocol,a=n.hostname;if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===a?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===a}if(!lo.test(r))return!1;if(co.test(e))return a===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}var po=new Jn(3e4,6e4);function vo(){var e=pi().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=u(e.H[r].L),e.CP)for(var a=0;a<e.CP.length;a++)e.CP[a]=null}}var mo=null;function go(e){return mo=mo||function(e){return new Promise((function(t,n){var r,a,i;function o(){vo(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){vo(),n(Un(e,"network-request-failed"))},timeout:po.get()})}if(null===(a=null===(r=pi().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=pi().gapi)||void 0===i?void 0:i.load)){var s=Mi("iframefcb");return pi()[s]=function(){gapi.load?o():n(Un(e,"network-request-failed"))},Pi("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw mo=null,e}))}(e),mo}var yo=new Jn(5e3,15e3),bo={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xo=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wo(e){var t=e.config;jn(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Zn(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:dn},a=xo.get(e.config.apiHost);a&&(r.eid=a);var i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(pt(r).slice(1))}function ko(e){return Eo.apply(this,arguments)}function Eo(){return Eo=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,go(t);case 2:return n=e.sent,jn(r=pi().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:wo(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bo,dontclear:!0},(function(e){return new Promise(function(){var n=Ge(He().mark((function n(r,a){var i,o,s;return He().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){pi().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:i=Un(t,"network-request-failed"),o=pi().setTimeout((function(){a(i)}),yo.get()),e.ping(s).then(s,(function(){a(i)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Eo.apply(this,arguments)}var So={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Co="_blank",Io="http://localhost",_o=function(){function e(t){c(this,e),this.window=t,this.associatedEvent=null}return d(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(VC){}}}]),e}();function To(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",c=Object.assign(Object.assign({},So),{width:r.toString(),height:a.toString(),top:i,left:o}),l=Je().toLowerCase();n&&(u=Wr(l)?Co:n),zr(l)&&(t=t||Io,c.scrollbars="yes");var f=Object.entries(c).reduce((function(e,t){var n=s(t,2),r=n[0],a=n[1];return"".concat(e).concat(r,"=").concat(a,",")}),"");if($r(l)&&"_self"!==u)return No(t||"",u),new _o(null);var h=window.open(t||"",u,f);jn(h,e,"popup-blocked");try{h.focus()}catch(VC){}return new _o(h)}function No(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var Ro="__/auth/handler",Ao="emulator/auth/handler";function Oo(e,t,n,r,a,i){jn(e.config.authDomain,e,"auth-domain-config-required"),jn(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:dn,eventId:a};if(t instanceof Ta){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var u=0,c=Object.entries(i||{});u<c.length;u++){var l=s(c[u],2),f=l[0],h=l[1];o[f]=h}}if(t instanceof Na){var d=t.getScopes().filter((function(e){return""!==e}));d.length>0&&(o.scopes=d.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var p=o,v=0,m=Object.keys(p);v<m.length;v++){var g=m[v];void 0===p[g]&&delete p[g]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Ro);return Zn(t,Ao)}(e),"?").concat(pt(p).slice(1))}var Do="webStorageSupport",Po=function(){function e(){c(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ci,this._completeRedirectFn=no,this._overrideRedirectResult=Zi}return d(e,[{key:"_openPopup",value:function(){var e=Ge(He().mark((function e(t,n,r,a){var i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hn(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),o=Oo(t,n,r,Xn(),a),e.abrupt("return",To(t,o,hi()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=Ge(He().mark((function e(t,n,r,a){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return i=Oo(t,n,r,Xn(),a),pi().location.href=i,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var i}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],a=r.manager,i=r.promise;return a?Promise.resolve(a):(Hn(i,"If manager is not set, promise should be"),i)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ko(t);case 2:return n=e.sent,r=new ao(t),n.register("authEvent",(function(e){return jn(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(Do,{type:Do},(function(n){var r,a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Do];void 0!==a&&t(!!a),Bn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return fo.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return Yr()||jr()||Xr()}}]),e}(),Mo=Po,Fo=function(){function e(t){c(this,e),this.factorId=t}return d(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Wn("unexpected MultiFactorSessionType")}}}]),e}(),Lo=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this,"phone")).credential=e,r}return d(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return ar(e,"POST","/v2/accounts/mfaEnrollment:finalize",rr(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return ar(e,"POST","/v2/accounts/mfaSignIn:finalize",rr(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(Fo);(function(){function e(){c(this,e)}return d(e,null,[{key:"assertion",value:function(e){return Lo._fromCredential(e)}}]),e}()).FACTOR_ID="phone";var Bo="@firebase/auth",Uo="0.20.11",Vo=function(){function e(t){c(this,e),this.auth=t,this.internalListeners=new Map}return d(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){jn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var zo,jo=it("authIdTokenMaxAge")||300,Wo=null,Ho=function(e){return function(){var t=Ge(He().mark((function t(n){var r,a,i;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n,!t.t0){t.next=5;break}return t.next=4,n.getIdTokenResult();case 4:t.t0=t.sent;case 5:if(r=t.t0,!((a=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3)&&a>jo)){t.next=9;break}return t.abrupt("return");case 9:if(i=null===r||void 0===r?void 0:r.token,Wo!==i){t.next=12;break}return t.abrupt("return");case 12:return Wo=i,t.next=15,fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};zo="Browser",un(new xt("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=r.options,o=i.apiKey,s=i.authDomain;return function(e,t){jn(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),jn(!(null===s||void 0===s?void 0:s.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:s,clientPlatform:zo,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Jr(zo)},a=new ea(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Gn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(a,n),a}(r,a)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),un(new xt("auth-internal",(function(e){return function(e){return new Vo(e)}(ta(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),mn(Bo,Uo,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(zo)),mn(Bo,Uo,"esm2017");mn("firebase","9.14.0","app");var qo="firebasestorage.googleapis.com",Go="storageBucket",Ko=function(e){v(n,e);var t=x(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return c(this,n),(a=t.call(this,Xo(e),"Firebase Storage: ".concat(r," (").concat(Xo(e),")"))).status_=i,a.customData={serverResponse:null},a._baseMessage=a.message,Object.setPrototypeOf(y(a),n.prototype),a}return d(n,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return Xo(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),n}(ut);function Xo(e){return"storage/"+e}function $o(){return new Ko("unknown","An unknown error occurred, please check the error payload for server response.")}function Qo(){return new Ko("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function Yo(){return new Ko("canceled","User canceled the upload/download.")}function Jo(){return new Ko("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Zo(e){return new Ko("invalid-argument",e)}function es(){return new Ko("app-deleted","The Firebase app was deleted.")}function ts(e,t){return new Ko("invalid-format","String does not match format '"+e+"': "+t)}function ns(e){throw new Ko("internal-error","Internal error: "+e)}var rs,as=function(){function e(t,n){c(this,e),this.bucket=t,this.path_=n}return d(e,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(t,n){var r;try{r=e.makeFromUrl(t,n)}catch(VC){return new e(t,"")}if(""===r.path)return r;throw new Ko("invalid-default-bucket","Invalid default bucket '"+t+"'.")}},{key:"makeFromUrl",value:function(t,n){var r=null,a="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+a+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(a,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===qo?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(a,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<u.length;c++){var l=u[c],f=l.regex.exec(t);if(f){var h=f[l.indices.bucket],d=f[l.indices.path];d||(d=""),r=new e(h,d),l.postModify(r);break}}if(null==r)throw function(e){return new Ko("invalid-url","Invalid URL '"+e+"'.")}(t);return r}}]),e}(),is=function(){function e(t){c(this,e),this.promise_=Promise.reject(t)}return d(e,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),e}();function os(e){return"string"===typeof e||e instanceof String}function ss(e){return us()&&e instanceof Blob}function us(){return"undefined"!==typeof Blob&&!Ze()}function cs(e,t,n,r){if(r<t)throw Zo("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Zo("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function ls(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function fs(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function hs(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),a=-1!==t.indexOf(e);return n||r||a}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(rs||(rs={}));var ds=function(){function e(t,n,r,a,i,o,s,u,l,f,h){var d=this,p=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];c(this,e),this.url_=t,this.method_=n,this.headers_=r,this.body_=a,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=s,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=f,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){d.resolve_=e,d.reject_=t,d.start_()}))}return d(e,[{key:"start_",value:function(){var e=this,t=function(t,n){var r=e.resolve_,a=e.reject_,i=n.connection;if(n.wasSuccessCode)try{var o=e.callback_(i,i.getResponse());!function(e){return void 0!==e}(o)?r():r(o)}catch(VC){a(VC)}else if(null!==i){var s=$o();s.serverResponse=i.getErrorText(),e.errorCallback_?a(e.errorCallback_(i,s)):a(s)}else{if(n.canceled)a(e.appDelete_?es():Yo());else a(Qo())}};this.canceled_?t(0,new ps(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,a=null,i=null,o=!1,s=0;function u(){return 2===s}var c=!1;function l(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function f(t){a=setTimeout((function(){a=null,e(d,u())}),t)}function h(){i&&clearTimeout(i)}function d(e){if(c)h();else{for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(e)return h(),void l.call.apply(l,[null,e].concat(n));var i;if(u()||o)return h(),void l.call.apply(l,[null,e].concat(n));r<64&&(r*=2),1===s?(s=2,i=0):i=1e3*(r+Math.random()),f(i)}}var p=!1;function v(e){p||(p=!0,h(),c||(null!==a?(e||(s=2),clearTimeout(a),f(0)):e||(s=1)))}return f(0),i=setTimeout((function(){o=!0,v(!0)}),n),v}((function(t,n){if(n)t(!1,new ps(!1,null,!0));else{var r=e.connectionFactory_();e.pendingConnection_=r;var a=function(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)};null!==e.progressCallback_&&r.addUploadProgressListener(a),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(){null!==e.progressCallback_&&r.removeUploadProgressListener(a),e.pendingConnection_=null;var n=r.getErrorCode()===rs.NO_ERROR,i=r.getStatus();if(n&&!hs(i,e.additionalRetryCodes_)||!e.retry){var o=-1!==e.successCodes_.indexOf(i);t(!0,new ps(o,r))}else{var s=r.getErrorCode()===rs.ABORT;t(!1,new ps(!1,null,s))}}))}}),t,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),e}(),ps=d((function e(t,n,r){c(this,e),this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}));function vs(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function ms(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}function gs(e,t){t&&(e["X-Firebase-GMPID"]=t)}function ys(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function bs(e,t,n,r,a,i){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=fs(e.urlParams),u=e.url+s,c=Object.assign({},e.headers);return gs(c,t),vs(c,n),ms(c,i),ys(c,r),new ds(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,a,o)}function xs(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function ws(){for(var e=xs(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){for(var a=new e,i=0;i<n.length;i++)a.append(n[i]);return a.getBlob()}if(us())return new Blob(n);throw new Ko("unsupported-environment","This browser doesn't seem to support creating Blobs")}function ks(e){if("undefined"===typeof atob)throw new Ko("unsupported-environment","".concat("base-64"," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));return atob(e)}var Es="raw",Ss="base64",Cs="base64url",Is="data_url",_s=d((function e(t,n){c(this,e),this.data=t,this.contentType=n||null}));function Ts(e,t){switch(e){case Es:return new _s(Ns(t));case Ss:case Cs:return new _s(Rs(e,t));case Is:return new _s(function(e){var t=new As(e);return t.base64?Rs(Ss,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(VC){throw ts(Is,"Malformed data URL.")}return Ns(t)}(t.rest)}(t),new As(t).contentType)}throw $o()}function Ns(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Rs(e,t){switch(e){case Ss:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw ts(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Cs:var a=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(a||i)throw ts(e,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=ks(t)}catch(VC){if(VC.message.includes("polyfill"))throw VC;throw ts(e,"Invalid character found")}for(var s=new Uint8Array(o.length),u=0;u<o.length;u++)s[u]=o.charCodeAt(u);return s}var As=d((function e(t){c(this,e),this.base64=!1,this.contentType=null;var n=t.match(/^data:([^,]+)?,/);if(null===n)throw ts(Is,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)}));var Os=function(){function e(t,n){c(this,e);var r=0,a="";ss(t)?(this.data_=t,r=t.size,a=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=a}return d(e,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(t,n){if(ss(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}var a=new Uint8Array(this.data_.buffer,t,n-t);return new e(a,!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(us()){var a=n.map((function(t){return t instanceof e?t.data_:t}));return new e(ws.apply(null,a))}var i=n.map((function(e){return os(e)?Ts(Es,e).data:e.data_})),o=0;i.forEach((function(e){o+=e.byteLength}));var s=new Uint8Array(o),u=0;return i.forEach((function(e){for(var t=0;t<e.length;t++)s[u++]=e[t]})),new e(s,!0)}}]),e}();function Ds(e){var t;try{t=JSON.parse(e)}catch(VC){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Ps(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Ms(e,t){return t}var Fs=d((function e(t,n,r,a){c(this,e),this.server=t,this.local=n||t,this.writable=!!r,this.xform=a||Ms})),Ls=null;function Bs(){if(Ls)return Ls;var e=[];e.push(new Fs("bucket")),e.push(new Fs("generation")),e.push(new Fs("metageneration")),e.push(new Fs("name","fullPath",!0));var t=new Fs("name");t.xform=function(e,t){return function(e){return!os(e)||e.length<2?e:Ps(e)}(t)},e.push(t);var n=new Fs("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Fs("timeCreated")),e.push(new Fs("updated")),e.push(new Fs("md5Hash",null,!0)),e.push(new Fs("cacheControl",null,!0)),e.push(new Fs("contentDisposition",null,!0)),e.push(new Fs("contentEncoding",null,!0)),e.push(new Fs("contentLanguage",null,!0)),e.push(new Fs("contentType",null,!0)),e.push(new Fs("metadata","customMetadata",!0)),Ls=e}function Us(e,t,n){for(var r={type:"file"},a=n.length,i=0;i<a;i++){var o=n[i];r[o.local]=o.xform(r,t[o.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,a=new as(n,r);return t._makeStorageReference(a)}})}(r,e),r}function Vs(e,t,n){var r=Ds(t);return null===r?null:Us(e,r,n)}function zs(e,t){for(var n={},r=t.length,a=0;a<r;a++){var i=t[a];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}var js=d((function e(t,n,r,a){c(this,e),this.url=t,this.method=n,this.handler=r,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function Ws(e){if(!e)throw $o()}function Hs(e,t){return function(n,r){var a=Vs(e,r,t);return Ws(null!==a),a}}function qs(e,t){return function(n,r){var a=Vs(e,r,t);return Ws(null!==a),function(e,t,n,r){var a=Ds(t);if(null===a)return null;if(!os(a.downloadTokens))return null;var i=a.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(t){var a=e.bucket,i=e.fullPath;return ls("/b/"+o(a)+"/o/"+o(i),n,r)+fs({alt:"media",token:t})}))[0]}(a,r,e.host,e._protocol)}}function Gs(e){return function(t,n){var r,a,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Ko("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Ko("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new Ko("quota-exceeded","Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(a=e.path,r=new Ko("unauthorized","User does not have permission to access '"+a+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Ks(e){var t=Gs(e);return function(n,r){var a,i=t(n,r);return 404===n.getStatus()&&(a=e.path,i=new Ko("object-not-found","Object '"+a+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Xs(e,t,n){var r=ls(t.fullServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,i=new js(r,"GET",Hs(e,n),a);return i.errorHandler=Ks(t),i}function $s(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Qs(e,t,n,r,a){var i=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+s;var u=$s(t,r,a),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+zs(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",f=Os.getBlob(c,r,l);if(null===f)throw Jo();var h={name:u.fullPath},d=ls(i,e.host,e._protocol),p=e.maxUploadRetryTime,v=new js(d,"POST",Hs(e,n),p);return v.urlParams=h,v.headers=o,v.body=f.uploadData(),v.errorHandler=Gs(t),v}var Ys=d((function e(t,n,r,a){c(this,e),this.current=t,this.total=n,this.finalized=!!r,this.metadata=a||null}));function Js(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(VC){Ws(!1)}return Ws(!!n&&-1!==(t||["active"]).indexOf(n)),n}var Zs=262144;function eu(e,t,n,r,a,i,o,s){var u=new Ys(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Ko("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;a>0&&(l=Math.min(l,a));var f=u.current,h=f+l,d={"X-Goog-Upload-Command":0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":"".concat(u.current)},p=r.slice(f,h);if(null===p)throw Jo();var v=t.maxUploadRetryTime,m=new js(n,"POST",(function(e,n){var a,o=Js(e,["active","final"]),s=u.current+l,c=r.size();return a="final"===o?Hs(t,i)(e,n):null,new Ys(s,c,"final"===o,a)}),v);return m.headers=d,m.body=p.uploadData(),m.progressCallback=s||null,m.errorHandler=Gs(e),m}var tu="running",nu="paused",ru="success",au="canceled",iu="error";function ou(e){switch(e){case"running":case"pausing":case"canceling":return tu;case"paused":return nu;case"success":return ru;case"canceled":return au;default:return iu}}var su=d((function e(t,n,r){c(this,e);var a=function(e){return"function"===typeof e}(t)||null!=n||null!=r;if(a)this.next=t,this.error=null!==n&&void 0!==n?n:void 0,this.complete=null!==r&&void 0!==r?r:void 0;else{var i=t;this.next=i.next,this.error=i.error,this.complete=i.complete}}));function uu(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((function(){return e.apply(void 0,n)}))}}var cu=function(){function e(){var t=this;c(this,e),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=rs.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=rs.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=rs.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return d(e,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw ns("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var a in r)r.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,r[a].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw ns("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw ns("cannot .getStatus() before sending");try{return this.xhr_.status}catch(VC){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw ns("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw ns("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),e}(),lu=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),n}(cu);function fu(){return new lu}var hu=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c(this,e),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=n,this._metadata=a,this._mappings=Bs(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){if(r._request=void 0,r._chunkMultiplier=1,e._codeEquals("canceled"))r._needToFetchStatus=!0,r.completeTransitions_();else{var t=r.isExponentialBackoffExpired();if(hs(e.status,[])){if(!t)return r.sleepTime=Math.max(2*r.sleepTime,1e3),r._needToFetchStatus=!0,void r.completeTransitions_();e=Qo()}r._error=e,r._transition("error")}},this._metadataErrorHandler=function(e){r._request=void 0,e._codeEquals("canceled")?r.completeTransitions_():(r._error=e,r._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t,r._start()})),this._promise.then(null,(function(){}))}return d(e,[{key:"isExponentialBackoffExpired",value:function(){return this.sleepTime>this.maxSleepTime}},{key:"_makeProgressCallback",value:function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}}},{key:"_shouldDoResumable",value:function(e){return e.size()>262144}},{key:"_start",value:function(){var e=this;"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((function(){e.pendingTimeout=void 0,e._continueUpload()}),this.sleepTime):this._oneShotUpload())}},{key:"_resolveToken",value:function(e){var t=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=s(n,2),a=r[0],i=r[1];switch(t._state){case"running":e(a,i);break;case"canceling":t._transition("canceled");break;case"pausing":t._transition("paused")}}))}},{key:"_createResumable",value:function(){var e=this;this._resolveToken((function(t,n){var r=function(e,t,n,r,a){var i=t.bucketOnlyServerUrl(),o=$s(t,r,a),s={name:o.fullPath},u=ls(i,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=zs(o,n),f=e.maxUploadRetryTime,h=new js(u,"POST",(function(e){var t;Js(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(VC){Ws(!1)}return Ws(os(t)),t}),f);return h.urlParams=s,h.headers=c,h.body=l,h.errorHandler=Gs(t),h}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),a=e._ref.storage._makeRequest(r,fu,t,n);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()}),e._errorHandler)}))}},{key:"_fetchStatus",value:function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n,r){var a=function(e,t,n,r){var a=e.maxUploadRetryTime,i=new js(n,"POST",(function(e){var t=Js(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(VC){Ws(!1)}n||Ws(!1);var a=Number(n);return Ws(!isNaN(a)),new Ys(a,r.size(),"final"===t)}),a);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=Gs(t),i}(e._ref.storage,e._ref._location,t,e._blob),i=e._ref.storage._makeRequest(a,fu,n,r);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()}),e._errorHandler)}))}},{key:"_continueUpload",value:function(){var e=this,t=Zs*this._chunkMultiplier,n=new Ys(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(a,i){var o;try{o=eu(e._ref._location,e._ref.storage,r,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(VC){return e._error=VC,void e._transition("error")}var s=e._ref.storage._makeRequest(o,fu,a,i,!1);e._request=s,s.getPromise().then((function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition("success")):e.completeTransitions_()}),e._errorHandler)}))}},{key:"_increaseMultiplier",value:function(){2*(Zs*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}},{key:"_fetchMetadata",value:function(){var e=this;this._resolveToken((function(t,n){var r=Xs(e._ref.storage,e._ref._location,e._mappings),a=e._ref.storage._makeRequest(r,fu,t,n);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._transition("success")}),e._metadataErrorHandler)}))}},{key:"_oneShotUpload",value:function(){var e=this;this._resolveToken((function(t,n){var r=Qs(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),a=e._ref.storage._makeRequest(r,fu,t,n);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition("success")}),e._errorHandler)}))}},{key:"_updateProgress",value:function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}},{key:"_transition",value:function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Yo(),this._state=e,this._notifyObservers()}}},{key:"completeTransitions_",value:function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}},{key:"snapshot",get:function(){var e=ou(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}},{key:"on",value:function(e,t,n,r){var a=this,i=new su(t||void 0,n||void 0,r||void 0);return this._addObserver(i),function(){a._removeObserver(i)}}},{key:"then",value:function(e,t){return this._promise.then(e,t)}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"_addObserver",value:function(e){this._observers.push(e),this._notifyObserver(e)}},{key:"_removeObserver",value:function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}},{key:"_notifyObservers",value:function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))}},{key:"_finishPromise",value:function(){if(void 0!==this._resolve){var e=!0;switch(ou(this._state)){case ru:uu(this._resolve.bind(null,this.snapshot))();break;case au:case iu:uu(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}},{key:"_notifyObserver",value:function(e){switch(ou(this._state)){case tu:case nu:e.next&&uu(e.next.bind(e,this.snapshot))();break;case ru:e.complete&&uu(e.complete.bind(e))();break;default:e.error&&uu(e.error.bind(e,this._error))()}}},{key:"resume",value:function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}},{key:"pause",value:function(){var e="running"===this._state;return e&&this._transition("pausing"),e}},{key:"cancel",value:function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}]),e}(),du=function(){function e(t,n){c(this,e),this._service=t,this._location=n instanceof as?n:as.makeFromUrl(n,t.host)}return d(e,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(t,n){return new e(t,n)}},{key:"root",get:function(){var e=new as(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return Ps(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new as(this._location.bucket,t);return new e(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw function(e){return new Ko("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}]),e}();function pu(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=ls(t.fullServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,i=new js(r,"GET",qs(e,n),a);return i.errorHandler=Ks(t),i}(e.storage,e._location,Bs());return e.storage.makeRequestWithTokens(t,fu).then((function(e){if(null===e)throw new Ko("no-download-url","The given file does not have any download URLs.");return e}))}function vu(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new as(e._location.bucket,n);return new du(e.storage,r)}function mu(e,t){if(e instanceof xu){var n=e;if(null==n._bucket)throw new Ko("no-default-bucket","No default bucket found. Did you set the '"+Go+"' property when initializing the app?");var r=new du(n,n._bucket);return null!=t?mu(r,t):r}return void 0!==t?vu(e,t):e}function gu(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof xu)return new du(e,t);throw Zo("To use ref(service, url), the first argument must be a Storage instance.")}return mu(e,t)}function yu(e,t){var n=null===t||void 0===t?void 0:t[Go];return null==n?null:as.makeFromBucketSpec(n,e)}function bu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var a=r.mockUserToken;a&&(e._overrideAuthToken="string"===typeof a?a:st(a,e.app.options.projectId))}var xu=function(){function e(t,n,r,a,i){c(this,e),this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=a,this._firebaseVersion=i,this._bucket=null,this._host=qo,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=a?as.makeFromBucketSpec(a,this._host):yu(this._host,this.app.options)}return d(e,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=as.makeFromBucketSpec(this._url,e):this._bucket=yu(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){cs("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){cs("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var e=Ge(He().mark((function e(){var t,n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._overrideAuthToken){e.next=2;break}return e.abrupt("return",this._overrideAuthToken);case 2:if(!(t=this._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,t.getToken();case 6:if(null===(n=e.sent)){e.next=9;break}return e.abrupt("return",n.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=Ge(He().mark((function e(){var t,n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,t.getToken();case 4:return n=e.sent,e.abrupt("return",n.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new du(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var a=this,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new is(es());var o=bs(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then((function(){return a._requests.delete(o)}),(function(){return a._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(){var e=Ge(He().mark((function e(t,n){var r,a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return r=e.sent,a=s(r,2),i=a[0],o=a[1],e.abrupt("return",this._makeRequest(t,n,i,o).getPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),wu="@firebase/storage",ku="0.9.14",Eu="storage";function Su(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new hu(e,new Os(t),n)}(e=bt(e),t,n)}function Cu(e){return pu(e=bt(e))}function Iu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};bu(e,t,n,r)}function _u(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new xu(r,a,i,n,dn)}un(new xt(Eu,_u,"PUBLIC").setMultipleInstances(!0)),mn(wu,ku,""),mn(wu,ku,"esm2017");var Tu,Nu="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Ru={},Au=Au||{},Ou=Nu||self;function Du(){}function Pu(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Mu(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Fu="closure_uid_"+(1e9*Math.random()>>>0),Lu=0;function Bu(e,t,n){return e.call.apply(e.bind,arguments)}function Uu(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Vu(e,t,n){return(Vu=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bu:Uu).apply(null,arguments)}function zu(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function ju(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function Wu(){this.s=this.s,this.o=this.o}Wu.prototype.s=!1,Wu.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function(e){Object.prototype.hasOwnProperty.call(e,Fu)&&e[Fu]||(e[Fu]=++Lu)}(this)},Wu.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Hu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function qu(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Gu(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Pu(r)){var a=e.length||0,i=r.length||0;e.length=a+i;for(var o=0;o<i;o++)e[a+o]=r[o]}else e.push(r)}}function Ku(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Ku.prototype.h=function(){this.defaultPrevented=!0};var Xu=function(){if(!Ou.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Ou.addEventListener("test",Du,t),Ou.removeEventListener("test",Du,t)}catch(XC){}return e}();function $u(e){return/^[\s\xa0]*$/.test(e)}var Qu=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Yu(e,t){return e<t?-1:e>t?1:0}function Ju(){var e=Ou.navigator;return e&&(e=e.userAgent)?e:""}function Zu(e){return-1!=Ju().indexOf(e)}function ec(e){return ec[" "](e),e}ec[" "]=Du;var tc,nc=Zu("Opera"),rc=Zu("Trident")||Zu("MSIE"),ac=Zu("Edge"),ic=ac||rc,oc=Zu("Gecko")&&!(-1!=Ju().toLowerCase().indexOf("webkit")&&!Zu("Edge"))&&!(Zu("Trident")||Zu("MSIE"))&&!Zu("Edge"),sc=-1!=Ju().toLowerCase().indexOf("webkit")&&!Zu("Edge");function uc(){var e=Ou.document;return e?e.documentMode:void 0}e:{var cc="",lc=function(){var e=Ju();return oc?/rv:([^\);]+)(\)|;)/.exec(e):ac?/Edge\/([\d\.]+)/.exec(e):rc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):sc?/WebKit\/(\S+)/.exec(e):nc?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(lc&&(cc=lc?lc[1]:""),rc){var fc=uc();if(null!=fc&&fc>parseFloat(cc)){tc=String(fc);break e}}tc=cc}var hc,dc={};function pc(){return function(e){var t=dc;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Qu(String(tc)).split("."),n=Qu("9").split("."),r=Math.max(t.length,n.length),a=0;0==e&&a<r;a++){var i=t[a]||"",o=n[a]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==i[0].length&&0==o[0].length)break;e=Yu(0==i[1].length?0:parseInt(i[1],10),0==o[1].length?0:parseInt(o[1],10))||Yu(0==i[2].length,0==o[2].length)||Yu(i[2],o[2]),i=i[3],o=o[3]}while(0==e)}return 0<=e}))}if(Ou.document&&rc){var vc=uc();hc=vc||(parseInt(tc,10)||void 0)}else hc=void 0;var mc=hc;function gc(e,t){if(Ku.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(oc){e:{try{ec(t.nodeName);var a=!0;break e}catch(YC){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:yc[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&gc.X.h.call(this)}}ju(gc,Ku);var yc={2:"touch",3:"pen",4:"mouse"};gc.prototype.h=function(){gc.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var bc="closure_listenable_"+(1e6*Math.random()|0),xc=0;function wc(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++xc,this.ba=this.ea=!1}function kc(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Ec(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Sc(e){var t={};for(var n in e)t[n]=e[n];return t}var Cc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ic(e,t){for(var n,r,a=1;a<arguments.length;a++){for(n in r=arguments[a])e[n]=r[n];for(var i=0;i<Cc.length;i++)n=Cc[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _c(e){this.src=e,this.g={},this.h=0}function Tc(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Hu(a,t);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(kc(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Nc(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.ba&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}_c.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=Nc(e,t,r,a);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new wc(t,this.src,i,!!r,a)).ea=n,e.push(t)),t};var Rc="closure_lm_"+(1e6*Math.random()|0),Ac={};function Oc(e,t,n,r,a){if(r&&r.once)return Pc(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)Oc(e,t[i],n,r,a);return null}return n=zc(n),e&&e[bc]?e.N(t,n,Mu(r)?!!r.capture:!!r,a):Dc(e,t,n,!1,r,a)}function Dc(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=Mu(a)?!!a.capture:!!a,s=Uc(e);if(s||(e[Rc]=s=new _c(e)),(n=s.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Bc;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Xu||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(Lc(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Pc(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Pc(e,t[i],n,r,a);return null}return n=zc(n),e&&e[bc]?e.O(t,n,Mu(r)?!!r.capture:!!r,a):Dc(e,t,n,!0,r,a)}function Mc(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)Mc(e,t[i],n,r,a);else r=Mu(r)?!!r.capture:!!r,n=zc(n),e&&e[bc]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Nc(i=e.g[t],n,r,a))&&(kc(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Uc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Nc(t,n,r,a)),(n=-1<e?t[e]:null)&&Fc(n))}function Fc(e){if("number"!==typeof e&&e&&!e.ba){var t=e.src;if(t&&t[bc])Tc(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Lc(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Uc(t))?(Tc(n,e),0==n.h&&(n.src=null,t[Rc]=null)):kc(e)}}}function Lc(e){return e in Ac?Ac[e]:Ac[e]="on"+e}function Bc(e,t){if(e.ba)e=!0;else{t=new gc(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Fc(e),e=n.call(r,t)}return e}function Uc(e){return(e=e[Rc])instanceof _c?e:null}var Vc="__closure_events_fn_"+(1e9*Math.random()>>>0);function zc(e){return"function"===typeof e?e:(e[Vc]||(e[Vc]=function(t){return e.handleEvent(t)}),e[Vc])}function jc(){Wu.call(this),this.i=new _c(this),this.P=this,this.I=null}function Wc(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new Ku(t,e);else if(t instanceof Ku)t.target=t.target||e;else{var a=t;Ic(t=new Ku(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];a=Hc(o,r,!0,t)&&a}if(a=Hc(o=t.g=e,r,!0,t)&&a,a=Hc(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=Hc(o=t.g=n[i],r,!1,t)&&a}function Hc(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==n){var s=o.listener,u=o.ha||o.src;o.ea&&Tc(e.i,o),a=!1!==s.call(u,r)&&a}}return a&&!r.defaultPrevented}ju(jc,Wu),jc.prototype[bc]=!0,jc.prototype.removeEventListener=function(e,t,n,r){Mc(this,e,t,n,r)},jc.prototype.M=function(){if(jc.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)kc(n[r]);delete t.g[e],t.h--}}this.I=null},jc.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},jc.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var qc=Ou.JSON.stringify;function Gc(){var e=el,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Kc,Xc=function(){function e(){c(this,e),this.h=this.g=null}return d(e,[{key:"add",value:function(e,t){var n=$c.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),$c=new(function(){function e(t,n){c(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return d(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new Qc}),(function(e){return e.reset()})),Qc=function(){function e(){c(this,e),this.next=this.g=this.h=null}return d(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Yc(e){Ou.setTimeout((function(){throw e}),0)}function Jc(e,t){Kc||function(){var e=Ou.Promise.resolve(void 0);Kc=function(){e.then(tl)}}(),Zc||(Kc(),Zc=!0),el.add(e,t)}var Zc=!1,el=new Xc;function tl(){for(var e;e=Gc();){try{e.h.call(e.g)}catch(XC){Yc(XC)}var t=$c;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Zc=!1}function nl(e,t){jc.call(this),this.h=e||1,this.g=t||Ou,this.j=Vu(this.lb,this),this.l=Date.now()}function rl(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function al(e,t,n){if("function"===typeof e)n&&(e=Vu(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Vu(e.handleEvent,e)}return 2147483647<Number(t)?-1:Ou.setTimeout(e,t||0)}function il(e){e.g=al((function(){e.g=null,e.i&&(e.i=!1,il(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}ju(nl,jc),(Tu=nl.prototype).ca=!1,Tu.R=null,Tu.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Wc(this,"tick"),this.ca&&(rl(this),this.start()))}},Tu.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Tu.M=function(){nl.X.M.call(this),rl(this),delete this.g};var ol=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this)).m=e,a.j=r,a.h=null,a.i=!1,a.g=null,a}return d(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:il(this)}},{key:"M",value:function(){je(m(n.prototype),"M",this).call(this),this.g&&(Ou.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Wu);function sl(e){Wu.call(this),this.h=e,this.g={}}ju(sl,Wu);var ul=[];function cl(e,t,n,r){Array.isArray(n)||(n&&(ul[0]=n.toString()),n=ul);for(var a=0;a<n.length;a++){var i=Oc(t,n[a],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function ll(e){Ec(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Fc(e)}),e),e.g={}}function fl(){this.g=!0}function hl(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return qc(n)}catch(zC){return t}}(e,n)+(r?" "+r:"")}))}sl.prototype.M=function(){sl.X.M.call(this),ll(this)},sl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fl.prototype.Aa=function(){this.g=!1},fl.prototype.info=function(){};var dl={},pl=null;function vl(){return pl=pl||new jc}function ml(e){Ku.call(this,dl.Pa,e)}function gl(e){var t=vl();Wc(t,new ml(t))}function yl(e,t){Ku.call(this,dl.STAT_EVENT,e),this.stat=t}function bl(e){var t=vl();Wc(t,new yl(t,e))}function xl(e,t){Ku.call(this,dl.Qa,e),this.size=t}function wl(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Ou.setTimeout((function(){e()}),t)}dl.Pa="serverreachability",ju(ml,Ku),dl.STAT_EVENT="statevent",ju(yl,Ku),dl.Qa="timingevent",ju(xl,Ku);var kl={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},El={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Sl(){}function Cl(e){return e.h||(e.h=e.i())}function Il(){}Sl.prototype.h=null;var _l,Tl={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Nl(){Ku.call(this,"d")}function Rl(){Ku.call(this,"c")}function Al(){}function Ol(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new sl(this),this.O=Pl,e=ic?125:void 0,this.T=new nl(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Dl}function Dl(){this.i=null,this.g="",this.h=!1}ju(Nl,Ku),ju(Rl,Ku),ju(Al,Sl),Al.prototype.g=function(){return new XMLHttpRequest},Al.prototype.i=function(){return{}},_l=new Al;var Pl=45e3,Ml={},Fl={};function Ll(e,t,n){e.K=1,e.v=nf(Yl(t)),e.s=n,e.P=!0,Bl(e,null)}function Bl(e,t){e.F=Date.now(),jl(e),e.A=Yl(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),mf(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Dl,e.g=mh(e.l,n?t:null,!e.s),0<e.N&&(e.L=new ol(Vu(e.La,e,e.g),e.N)),cl(e.S,e.g,"readystatechange",e.ib),t=e.H?Sc(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),gl(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var o="",s=i.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Ul(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Vl(e,t,n){for(var r,a=!0;!e.I&&e.C<n.length;){if((r=zl(e,n))==Fl){4==t&&(e.o=4,bl(14),a=!1),hl(e.j,e.m,null,"[Incomplete Response]");break}if(r==Ml){e.o=4,bl(15),hl(e.j,e.m,n,"[Invalid Chunk]"),a=!1;break}hl(e.j,e.m,r,null),Kl(e,r)}Ul(e)&&r!=Fl&&r!=Ml&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,bl(16),a=!1),e.i=e.i&&a,a?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),uh(t),t.K=!0,bl(11))):(hl(e.j,e.m,n,"[Invalid Chunked Response]"),Gl(e),ql(e))}function zl(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fl:(n=Number(t.substring(n,r)),isNaN(n)?Ml:(r+=1)+n>t.length?Fl:(t=t.substr(r,n),e.C=r+n,t))}function jl(e){e.V=Date.now()+e.O,Wl(e,e.O)}function Wl(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=wl(Vu(e.gb,e),t)}function Hl(e){e.B&&(Ou.clearTimeout(e.B),e.B=null)}function ql(e){0==e.l.G||e.I||fh(e.l,e)}function Gl(e){Hl(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,rl(e.T),ll(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Kl(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Ef(n.h,e)))if(!e.J&&Ef(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;lh(n),eh(n)}sh(n),bl(18)}}else n.Ba=a[1],0<n.Ba-n.T&&37500>a[2]&&n.L&&0==n.A&&!n.v&&(n.v=wl(Vu(n.cb,n),6e3));if(1>=kf(n.h)&&n.ja){try{n.ja()}catch(i){}n.ja=void 0}}else dh(n,11)}else if((e.J||n.g==e)&&lh(n),!$u(t))for(a=n.Fa.g.parse(t),t=0;t<a.length;t++){var i=a[t];if(n.T=i[0],i=i[1],2==n.G)if("c"==i[0]){n.I=i[1],n.ka=i[2];var o=i[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var s=i[4];null!=s&&(n.Ca=s,n.j.info("SVER="+n.Ca));var u=i[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.h;f.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(f.j=f.l,f.g=new Set,f.h&&(Sf(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.za=h,tf(r.F,r.D,h))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=vh(r,r.H?r.ka:null,r.V),d.J){Cf(r.h,d);var p=d,v=r.J;v&&p.setTimeout(v),p.B&&(Hl(p),jl(p)),r.g=d}else oh(r);0<n.i.length&&nh(n)}else"stop"!=i[0]&&"close"!=i[0]||dh(n,7);else 3==n.G&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?dh(n,7):Zf(n):"noop"!=i[0]&&n.l&&n.l.wa(i),n.A=0)}gl()}catch(i){}}function Xl(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Pu(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(Pu(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(Pu(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,i=0;i<a;i++)t.call(void 0,r[i],n&&n[i],e)}(Tu=Ol.prototype).setTimeout=function(e){this.O=e},Tu.ib=function(e){e=e.target;var t=this.L;t&&3==Kf(e)?t.l():this.La(e)},Tu.La=function(e){try{if(e==this.g)e:{var t=Kf(this.g),n=this.g.Ea();this.g.aa();if(!(3>t)&&(3!=t||ic||this.g&&(this.h.h||this.g.fa()||Xf(this.g)))){this.I||4!=t||7==n||gl(),Hl(this);var r=this.g.aa();this.Y=r;t:if(Ul(this)){var a=Xf(this.g);e="";var i=a.length,o=4==Kf(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Gl(this),ql(this);var s="";break t}this.h.i=new Ou.TextDecoder}for(n=0;n<i;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:o&&n==i-1});a.splice(0,i),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.fa();if(this.i=200==r,function(e,t,n,r,a,i,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,r),this.i){if(this.Z&&!this.J){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$u(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,bl(12),Gl(this),ql(this);break e}hl(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Kl(this,r)}this.P?(Vl(this,t,s),ic&&this.i&&3==t&&(cl(this.S,this.T,"tick",this.hb),this.T.start())):(hl(this.j,this.m,s,null),Kl(this,s)),4==t&&Gl(this),this.i&&!this.I&&(4==t?fh(this.l,this):(this.i=!1,jl(this)))}else 400==r&&0<s.indexOf("Unknown SID")?(this.o=3,bl(12)):(this.o=0,bl(13)),Gl(this),ql(this)}}}catch(t){}},Tu.hb=function(){if(this.g){var e=Kf(this.g),t=this.g.fa();this.C<t.length&&(Hl(this),Vl(this,e,t),this.i&&4!=e&&jl(this))}},Tu.cancel=function(){this.I=!0,Gl(this)},Tu.gb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(gl(),bl(17)),Gl(this),this.o=2,ql(this)):Wl(this,this.V-e)};var $l=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ql(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Ql){this.h=void 0!==t?t:e.h,Jl(this,e.j),this.s=e.s,this.g=e.g,Zl(this,e.m),this.l=e.l,t=e.i;var n=new hf;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ef(this,n),this.o=e.o}else e&&(n=String(e).match($l))?(this.h=!!t,Jl(this,n[1]||"",!0),this.s=rf(n[2]||""),this.g=rf(n[3]||"",!0),Zl(this,n[4]),this.l=rf(n[5]||"",!0),ef(this,n[6]||"",!0),this.o=rf(n[7]||"")):(this.h=!!t,this.i=new hf(null,this.h))}function Yl(e){return new Ql(e)}function Jl(e,t,n){e.j=n?rf(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Zl(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ef(e,t,n){t instanceof hf?(e.i=t,function(e,t){t&&!e.j&&(df(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(pf(this,t),mf(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=af(t,lf)),e.i=new hf(t,e.h))}function tf(e,t,n){e.i.set(t,n)}function nf(e){return tf(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function rf(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function af(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,of),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function of(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ql.prototype.toString=function(){var e=[],t=this.j;t&&e.push(af(t,sf,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(af(t,sf,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(af(n,"/"==n.charAt(0)?cf:uf,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",af(n,ff)),e.join("")};var sf=/[#\/\?@]/g,uf=/[#\?:]/g,cf=/[#\?]/g,lf=/[#\?@]/g,ff=/#/g;function hf(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function df(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function pf(e,t){df(e),t=gf(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function vf(e,t){return df(e),t=gf(e,t),e.g.has(t)}function mf(e,t,n){pf(e,t),0<n.length&&(e.i=null,e.g.set(gf(e,t),qu(n)),e.h+=n.length)}function gf(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Tu=hf.prototype).add=function(e,t){df(this),this.i=null,e=gf(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Tu.forEach=function(e,t){df(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Tu.oa=function(){df(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var a=e[r],i=0;i<a.length;i++)n.push(t[r]);return n},Tu.W=function(e){df(this);var t=[];if("string"===typeof e)vf(this,e)&&(t=t.concat(this.g.get(gf(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},Tu.set=function(e,t){return df(this),this.i=null,vf(this,e=gf(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Tu.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},Tu.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],a=encodeURIComponent(String(r)),i=this.W(r);for(r=0;r<i.length;r++){var o=a;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};var yf=d((function e(t,n){c(this,e),this.h=t,this.g=n}));function bf(e){this.l=e||xf,Ou.PerformanceNavigationTiming?e=0<(e=Ou.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Ou.g&&Ou.g.Ga&&Ou.g.Ga()&&Ou.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var xf=10;function wf(e){return!!e.h||!!e.g&&e.g.size>=e.j}function kf(e){return e.h?1:e.g?e.g.size:0}function Ef(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Sf(e,t){e.g?e.g.add(t):e.h=t}function Cf(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function If(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=We(e.g.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;n=n.concat(a.D)}}catch(i){r.e(i)}finally{r.f()}return n}return qu(e.i)}function _f(){}function Tf(){this.g=new _f}function Nf(e,t,n){var r=n||"";try{Xl(e,(function(e,n){var a=e;Mu(e)&&(a=qc(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(VC){throw t.push(r+"type="+encodeURIComponent("_badmap")),VC}}function Rf(e,t,n,r,a){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,a(r)}catch(YC){}}function Af(e){this.l=e.ac||null,this.j=e.jb||!1}function Of(e,t){jc.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Df,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}bf.prototype.cancel=function(){if(this.i=If(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=We(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},_f.prototype.stringify=function(e){return Ou.JSON.stringify(e,void 0)},_f.prototype.parse=function(e){return Ou.JSON.parse(e,void 0)},ju(Af,Sl),Af.prototype.g=function(){return new Of(this.l,this.j)},Af.prototype.i=function(e){return function(){return e}}({}),ju(Of,jc);var Df=0;function Pf(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function Mf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ff(e)}function Ff(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Tu=Of.prototype).open=function(e,t){if(this.readyState!=Df)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ff(this)},Tu.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Ou).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Tu.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mf(this)),this.readyState=Df},Tu.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ff(this)),this.g&&(this.readyState=3,Ff(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if("undefined"!==typeof Ou.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Pf(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},Tu.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Mf(this):Ff(this),3==this.readyState&&Pf(this)}},Tu.Va=function(e){this.g&&(this.response=this.responseText=e,Mf(this))},Tu.Ua=function(e){this.g&&(this.response=e,Mf(this))},Tu.ga=function(){this.g&&Mf(this)},Tu.setRequestHeader=function(e,t){this.v.append(e,t)},Tu.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Tu.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Of.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Lf=Ou.JSON.parse;function Bf(e){jc.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Uf,this.K=this.L=!1}ju(Bf,jc);var Uf="",Vf=/^https?$/i,zf=["POST","PUT"];function jf(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Wf(e),qf(e)}function Wf(e){e.D||(e.D=!0,Wc(e,"complete"),Wc(e,"error"))}function Hf(e){if(e.h&&"undefined"!=typeof Au&&(!e.C[1]||4!=Kf(e)||2!=e.aa()))if(e.v&&4==Kf(e))al(e.Ha,0,e);else if(Wc(e,"readystatechange"),4==Kf(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var a;if(a=0===n){var i=String(e.H).match($l)[1]||null;if(!i&&Ou.self&&Ou.self.location){var o=Ou.self.location.protocol;i=o.substr(0,o.length-1)}a=!Vf.test(i?i.toLowerCase():"")}t=a}if(t)Wc(e,"complete"),Wc(e,"success");else{e.m=6;try{var s=2<Kf(e)?e.g.statusText:""}catch(KC){s=""}e.j=s+" ["+e.aa()+"]",Wf(e)}}finally{qf(e)}}}function qf(e,t){if(e.g){Gf(e);var n=e.g,r=e.C[0]?Du:null;e.g=null,e.C=null,t||Wc(e,"ready");try{n.onreadystatechange=r}catch(VC){}}}function Gf(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Ou.clearTimeout(e.A),e.A=null)}function Kf(e){return e.g?e.g.readyState:0}function Xf(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Uf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Oh){return null}}function $f(e){var t="";return Ec(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Qf(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=$f(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):tf(e,t,n))}function Yf(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Jf(e){this.Ca=0,this.i=[],this.j=new fl,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Yf("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Yf("baseRetryDelayMs",5e3,e),this.bb=Yf("retryDelaySeedMs",1e4,e),this.$a=Yf("forwardChannelMaxRetries",2,e),this.ta=Yf("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new bf(e&&e.concurrentRequestLimit),this.Fa=new Tf,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Zf(e){if(th(e),3==e.G){var t=e.U++,n=Yl(e.F);tf(n,"SID",e.I),tf(n,"RID",t),tf(n,"TYPE","terminate"),ah(e,n),(t=new Ol(e,e.j,t,void 0)).K=2,t.v=nf(Yl(n)),n=!1,Ou.navigator&&Ou.navigator.sendBeacon&&(n=Ou.navigator.sendBeacon(t.v.toString(),"")),!n&&Ou.Image&&((new Image).src=t.v,n=!0),n||(t.g=mh(t.l,null),t.g.da(t.v)),t.F=Date.now(),jl(t)}ph(e)}function eh(e){e.g&&(uh(e),e.g.cancel(),e.g=null)}function th(e){eh(e),e.u&&(Ou.clearTimeout(e.u),e.u=null),lh(e),e.h.cancel(),e.m&&("number"===typeof e.m&&Ou.clearTimeout(e.m),e.m=null)}function nh(e){wf(e.h)||e.m||(e.m=!0,Jc(e.Ja,e),e.C=0)}function rh(e,t){var n;n=t?t.m:e.U++;var r=Yl(e.F);tf(r,"SID",e.I),tf(r,"RID",n),tf(r,"AID",e.T),ah(e,r),e.o&&e.s&&Qf(r,e.o,e.s),n=new Ol(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=ih(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),Sf(e.h,n),Ll(n,r,t)}function ah(e,t){e.ia&&Ec(e.ia,(function(e,n){tf(t,n,e)})),e.l&&Xl({},(function(e,n){tf(t,n,e)}))}function ih(e,t,n){n=Math.min(e.i.length,n);var r=e.l?Vu(e.l.Ra,e.l,e):null;e:for(var a=e.i,i=-1;;){var o=["count="+n];-1==i?0<n?(i=a[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);for(var s=!0,u=0;u<n;u++){var c=a[u].h,l=a[u].g;if(0>(c-=i))i=Math.max(0,a[u].h-100),s=!1;else try{Nf(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function oh(e){e.g||e.u||(e.Z=1,Jc(e.Ia,e),e.A=0)}function sh(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=wl(Vu(e.Ia,e),hh(e,e.A)),e.A++,!0)}function uh(e){null!=e.B&&(Ou.clearTimeout(e.B),e.B=null)}function ch(e){e.g=new Ol(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=Yl(e.sa);tf(t,"RID","rpc"),tf(t,"SID",e.I),tf(t,"CI",e.L?"0":"1"),tf(t,"AID",e.T),tf(t,"TYPE","xmlhttp"),ah(e,t),e.o&&e.s&&Qf(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=nf(Yl(t)),n.s=null,n.P=!0,Bl(n,e)}function lh(e){null!=e.v&&(Ou.clearTimeout(e.v),e.v=null)}function fh(e,t){var n=null;if(e.g==t){lh(e),uh(e),e.g=null;var r=2}else{if(!Ef(e.h,t))return;n=t.D,Cf(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var a=e.C;Wc(r=vl(),new xl(r,n)),nh(e)}else oh(e);else if(3==(a=t.o)||0==a&&0<e.pa||!(1==r&&function(e,t){return!(kf(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.C>=(e.Za?0:e.$a))&&(e.m=wl(Vu(e.Ja,e,t),hh(e,e.C)),e.C++,!0))}(e,t)||2==r&&sh(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:dh(e,5);break;case 4:dh(e,10);break;case 3:dh(e,6);break;default:dh(e,2)}}function hh(e,t){var n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function dh(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=Vu(e.kb,e);n||(n=new Ql("//www.google.com/images/cleardot.gif"),Ou.location&&"http"==Ou.location.protocol||Jl(n,"https"),nf(n)),function(e,t){var n=new fl;if(Ou.Image){var r=new Image;r.onload=zu(Rf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=zu(Rf,n,r,"TestLoadImage: error",!1,t),r.onabort=zu(Rf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=zu(Rf,n,r,"TestLoadImage: timeout",!1,t),Ou.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else bl(2);e.G=0,e.l&&e.l.va(t),ph(e),th(e)}function ph(e){if(e.G=0,e.la=[],e.l){var t=If(e.h);0==t.length&&0==e.i.length||(Gu(e.la,t),Gu(e.la,e.i),e.h.i.length=0,qu(e.i),e.i.length=0),e.l.ua()}}function vh(e,t,n){var r=n instanceof Ql?Yl(n):new Ql(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Zl(r,r.m);else{var a=Ou.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var i=new Ql(null,void 0);r&&Jl(i,r),t&&(i.g=t),a&&Zl(i,a),n&&(i.l=n),r=i}return n=e.D,t=e.za,n&&t&&tf(r,n,t),tf(r,"VER",e.ma),ah(e,r),r}function mh(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Bf(new Af({jb:!0})):new Bf(e.ra)).Ka(e.H),t}function gh(){}function yh(){if(rc&&!(10<=Number(mc)))throw Error("Environmental error: no available transport.")}function bh(e,t){jc.call(this),this.g=new Jf(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!$u(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!$u(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new kh(this)}function xh(e){Nl.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function wh(){Rl.call(this),this.status=1}function kh(e){this.g=e}(Tu=Bf.prototype).Ka=function(e){this.L=e},Tu.da=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():_l.g(),this.C=this.u?Cl(this.u):Cl(_l),this.g.onreadystatechange=Vu(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(u){return void jf(this,u)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var i,o=We(r.keys());try{for(o.s();!(i=o.n()).done;){var u=i.value;n.set(u,r.get(u))}}catch(p){o.e(p)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),a=Ou.FormData&&e instanceof Ou.FormData,!(0<=Hu(zf,t))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var c,l=We(n);try{for(l.s();!(c=l.n()).done;){var f=s(c.value,2),h=f[0],d=f[1];this.g.setRequestHeader(h,d)}}catch(p){l.e(p)}finally{l.f()}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Gf(this),0<this.B&&((this.K=function(e){return rc&&pc()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Vu(this.qa,this)):this.A=al(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(u){jf(this,u)}},Tu.qa=function(){"undefined"!=typeof Au&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wc(this,"timeout"),this.abort(8))},Tu.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Wc(this,"complete"),Wc(this,"abort"),qf(this))},Tu.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qf(this,!0)),Bf.X.M.call(this)},Tu.Ha=function(){this.s||(this.F||this.v||this.l?Hf(this):this.fb())},Tu.fb=function(){Hf(this)},Tu.aa=function(){try{return 2<Kf(this)?this.g.status:-1}catch(HC){return-1}},Tu.fa=function(){try{return this.g?this.g.responseText:""}catch(HC){return""}},Tu.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Lf(t)}},Tu.Ea=function(){return this.m},Tu.Oa=function(){return"string"===typeof this.j?this.j:String(this.j)},(Tu=Jf.prototype).ma=8,Tu.G=1,Tu.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new Ol(this,this.j,e,void 0),n=this.s;if(this.S&&(n?Ic(n=Sc(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,a=0;a<this.i.length;a++){var i=this.i[a];if(void 0===(i="__data__"in i.g&&"string"===typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(r+=i)){r=a;break e}if(4096===r||a===this.i.length-1){r=a+1;break e}}r=1e3}else r=1e3;r=ih(this,t,r),tf(a=Yl(this.F),"RID",e),tf(a,"CVER",22),this.D&&tf(a,"X-HTTP-Session-Id",this.D),ah(this,a),n&&(this.N?r="headers="+encodeURIComponent(String($f(n)))+"&"+r:this.o&&Qf(a,this.o,n)),Sf(this.h,t),this.Ya&&tf(a,"TYPE","init"),this.O?(tf(a,"$req",r),tf(a,"SID","null"),t.Z=!0,Ll(t,a,null)):Ll(t,a,r),this.G=2}}else 3==this.G&&(e?rh(this,e):0==this.i.length||wf(this.h)||rh(this))},Tu.Ia=function(){if(this.u=null,ch(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=wl(Vu(this.eb,this),e)}},Tu.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,bl(10),eh(this),ch(this))},Tu.cb=function(){null!=this.v&&(this.v=null,eh(this),sh(this),bl(19))},Tu.kb=function(e){e?(this.j.info("Successfully pinged google.com"),bl(2)):(this.j.info("Failed to ping google.com"),bl(1))},(Tu=gh.prototype).xa=function(){},Tu.wa=function(){},Tu.va=function(){},Tu.ua=function(){},Tu.Ra=function(){},yh.prototype.g=function(e,t){return new bh(e,t)},ju(bh,jc),bh.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;bl(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=vh(e,null,e.V),nh(e)},bh.prototype.close=function(){Zf(this.g)},bh.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=qc(e),e=n);t.i.push(new yf(t.ab++,e)),3==t.G&&nh(t)},bh.prototype.M=function(){this.g.l=null,delete this.j,Zf(this.g),delete this.g,bh.X.M.call(this)},ju(xh,Nl),ju(wh,Rl),ju(kh,gh),kh.prototype.xa=function(){Wc(this.g,"a")},kh.prototype.wa=function(e){Wc(this.g,new xh(e))},kh.prototype.va=function(e){Wc(this.g,new wh)},kh.prototype.ua=function(){Wc(this.g,"b")},yh.prototype.createWebChannel=yh.prototype.g,bh.prototype.send=bh.prototype.u,bh.prototype.open=bh.prototype.m,bh.prototype.close=bh.prototype.close,kl.NO_ERROR=0,kl.TIMEOUT=8,kl.HTTP_ERROR=6,El.COMPLETE="complete",Il.EventType=Tl,Tl.OPEN="a",Tl.CLOSE="b",Tl.ERROR="c",Tl.MESSAGE="d",jc.prototype.listen=jc.prototype.N,Bf.prototype.listenOnce=Bf.prototype.O,Bf.prototype.getLastError=Bf.prototype.Oa,Bf.prototype.getLastErrorCode=Bf.prototype.Ea,Bf.prototype.getStatus=Bf.prototype.aa,Bf.prototype.getResponseJson=Bf.prototype.Sa,Bf.prototype.getResponseText=Bf.prototype.fa,Bf.prototype.send=Bf.prototype.da,Bf.prototype.setWithCredentials=Bf.prototype.Ka;var Eh=Ru.createWebChannelTransport=function(){return new yh},Sh=Ru.getStatEventTarget=function(){return vl()},Ch=Ru.ErrorCode=kl,Ih=Ru.EventType=El,_h=Ru.Event=dl,Th=Ru.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Nh=Ru.FetchXmlHttpFactory=Af,Rh=Ru.WebChannel=Il,Ah=Ru.XhrIo=Bf,Oh="@firebase/firestore",Dh=function(){function e(t){c(this,e),this.uid=t}return d(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Dh.UNAUTHENTICATED=new Dh(null),Dh.GOOGLE_CREDENTIALS=new Dh("google-credentials-uid"),Dh.FIRST_PARTY=new Dh("first-party-uid"),Dh.MOCK_USER=new Dh("mock-user");var Ph="9.14.0",Mh=new At("@firebase/firestore");function Fh(){return Mh.logLevel}function Lh(e){if(Mh.logLevel<=St.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Vh);Mh.debug.apply(Mh,["Firestore (".concat(Ph,"): ").concat(e)].concat(u(a)))}}function Bh(e){if(Mh.logLevel<=St.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Vh);Mh.error.apply(Mh,["Firestore (".concat(Ph,"): ").concat(e)].concat(u(a)))}}function Uh(e){if(Mh.logLevel<=St.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Vh);Mh.warn.apply(Mh,["Firestore (".concat(Ph,"): ").concat(e)].concat(u(a)))}}function Vh(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function zh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Ph,") INTERNAL ASSERTION FAILED: ")+e;throw Bh(t),new Error(t)}function jh(e,t){e||zh()}function Wh(e,t){return e}var Hh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qh=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this,e,r)).code=e,a.message=r,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},a}return d(n)}(ut),Gh=d((function e(){var t=this;c(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Kh=d((function e(t,n){c(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Xh=function(){function e(){c(this,e)}return d(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Dh.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),$h=function(){function e(t){c(this,e),this.token=t,this.changeListener=null}return d(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),Qh=function(){function e(t){c(this,e),this.t=t,this.currentUser=Dh.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return d(e,[{key:"start",value:function(e,t){var n=this,r=this.i,a=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},i=new Gh;this.o=function(){n.i++,n.currentUser=n.u(),i.resolve(),i=new Gh,e.enqueueRetryable((function(){return a(n.currentUser)}))};var o=function(){var t=i;e.enqueueRetryable(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},s=function(e){Lh("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?s(e):(Lh("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gh)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Lh("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(jh("string"==typeof n.accessToken),new Kh(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return jh(null===e||"string"==typeof e),new Dh(e)}}]),e}(),Yh=function(){function e(t,n,r,a){c(this,e),this.h=t,this.l=n,this.m=r,this.g=a,this.type="FirstParty",this.user=Dh.FIRST_PARTY,this.p=new Map}return d(e,[{key:"I",value:function(){return this.g?this.g():(jh(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),e}(),Jh=function(){function e(t,n,r,a){c(this,e),this.h=t,this.l=n,this.m=r,this.g=a}return d(e,[{key:"getToken",value:function(){return Promise.resolve(new Yh(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Dh.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Zh=d((function e(t){c(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),ed=function(){function e(t){c(this,e),this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}return d(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Lh("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,Lh("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var a=function(e){Lh("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return a(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?a(e):Lh("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(jh("string"==typeof t.token),e.A=t.token,new Zh(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function td(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var nd=function(){function e(){c(this,e)}return d(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=td(40),a=0;a<r.length;++a)n.length<20&&r[a]<t&&(n+=e.charAt(r[a]%e.length));return n}}]),e}();function rd(e,t){return e<t?-1:e>t?1:0}function ad(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}var id=function(){function e(t,n){if(c(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new qh(Hh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new qh(Hh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new qh(Hh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qh(Hh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return d(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?rd(this.nanoseconds,e.nanoseconds):rd(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),od=function(){function e(t){c(this,e),this.timestamp=t}return d(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new id(0,0))}},{key:"max",value:function(){return new e(new id(253402300799,999999999))}}]),e}(),sd=function(){function e(t,n,r){c(this,e),void 0===n?n=0:n>t.length&&zh(),void 0===r?r=t.length-n:r>t.length-n&&zh(),this.segments=t,this.offset=n,this.len=r}return d(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var a=e.get(r),i=t.get(r);if(a<i)return-1;if(a>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),ud=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new qh(Hh.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,u(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(sd),cd=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ld=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return cd.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",a=0,i=function(){if(0===r.length)throw new qh(Hh.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;a<e.length;){var s=e[a];if("\\"===s){if(a+1===e.length)throw new qh(Hh.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[a+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qh(Hh.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else"`"===s?(o=!o,a++):"."!==s||o?(r+=s,a++):(i(),a++)}if(i(),o)throw new qh(Hh.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(sd),fd=function(){function e(t){c(this,e),this.path=t}return d(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===ud.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(ud.fromString(t))}},{key:"fromName",value:function(t){return new e(ud.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(ud.emptyPath())}},{key:"comparator",value:function(e,t){return ud.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new ud(t.slice()))}}]),e}(),hd=d((function e(t,n,r,a){c(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=a}));hd.UNKNOWN_ID=-1;function dd(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=od.fromTimestamp(1e9===r?new id(n+1,0):new id(n,r));return new vd(a,fd.empty(),t)}function pd(e){return new vd(e.readTime,e.key,-1)}var vd=function(){function e(t,n,r){c(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return d(e,null,[{key:"min",value:function(){return new e(od.min(),fd.empty(),-1)}},{key:"max",value:function(){return new e(od.max(),fd.empty(),-1)}}]),e}();function md(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=fd.comparator(e.documentKey,t.documentKey))?n:rd(e.largestBatchId,t.largestBatchId)}var gd="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",yd=function(){function e(){c(this,e),this.onCommittedListeners=[]}return d(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function bd(e){return xd.apply(this,arguments)}function xd(){return xd=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Hh.FAILED_PRECONDITION&&t.message===gd){e.next=2;break}throw t;case 2:Lh("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),xd.apply(this,arguments)}var wd=function(){function e(t){var n=this;c(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return d(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&zh(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,a){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,a)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,a)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,a=0,i=!1;t.forEach((function(t){++r,t.next((function(){++a,i&&a===r&&e()}),(function(e){return n(e)}))})),i=!0,a===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),a=We(t);try{var i=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,a){r.push(t.call(n,e,a))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var a=t.length,i=new Array(a),o=0,s=function(s){var u=s;n(t[u]).next((function(t){i[u]=t,++o===a&&e(i)}),(function(e){return r(e)}))},u=0;u<a;u++)s(u)}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function a(){!0===t()?n().next((function(){a()}),r):e()}()}))}}]),e}();function kd(e){return"IndexedDbTransactionError"===e.name}var Ed=function(){function e(t,n){var r=this;c(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ut(e)},this.ct=function(e){return n.writeSequenceNumber(e)})}return d(e,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),e}();function Sd(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Cd(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Id(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}Ed.at=-1;var _d=function(){function e(t,n){c(this,e),this.comparator=t,this.root=n||Nd.EMPTY}return d(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Nd.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Nd.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Td(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Td(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Td(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Td(this.root,e,this.comparator,!0)}}]),e}(),Td=function(){function e(t,n,r,a){c(this,e),this.isReverse=a,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&a&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return d(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),Nd=function(){function e(t,n,r,a,i){c(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=i?i:e.EMPTY,this.size=this.left.size+1+this.right.size}return d(e,[{key:"copy",value:function(t,n,r,a,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=i?i:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,a=n(e,r.key);return(r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,a=this;if(n(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===n(t,a.key)){if(a.right.isEmpty())return e.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,n))}return a.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw zh();if(this.right.isRed())throw zh();var e=this.left.check();if(e!==this.right.check())throw zh();return e+(this.isRed()?0:1)}}]),e}();Nd.EMPTY=null,Nd.RED=!0,Nd.BLACK=!1,Nd.EMPTY=new(function(){function e(){c(this,e),this.size=0}return d(e,[{key:"key",get:function(){throw zh()}},{key:"value",get:function(){throw zh()}},{key:"color",get:function(){throw zh()}},{key:"left",get:function(){throw zh()}},{key:"right",get:function(){throw zh()}},{key:"copy",value:function(e,t,n,r,a){return this}},{key:"insert",value:function(e,t,n){return new Nd(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Rd=function(){function e(t){c(this,e),this.comparator=t,this.data=new _d(this.comparator)}return d(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Ad(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Ad(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(0!==this.comparator(a,i))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Ad=function(){function e(t){c(this,e),this.iter=t}return d(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();var Od=function(){function e(t){c(this,e),this.fields=t,t.sort(ld.comparator)}return d(e,[{key:"unionWith",value:function(t){var n,r=new Rd(ld.comparator),a=We(this.fields);try{for(a.s();!(n=a.n()).done;){var i=n.value;r=r.add(i)}}catch(c){a.e(c)}finally{a.f()}var o,s=We(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=We(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return ad(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}();var Dd=function(e){function t(e){c(this,t),this.binaryString=e}return d(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return rd(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();Dd.EMPTY_BYTE_STRING=new Dd("");var Pd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Md(e){if(jh(!!e),"string"==typeof e){var t=0,n=Pd.exec(e);if(jh(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:Fd(e.seconds),nanos:Fd(e.nanos)}}function Fd(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ld(e){return"string"==typeof e?Dd.fromBase64String(e):Dd.fromUint8Array(e)}function Bd(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ud(e){var t=e.mapValue.fields.__previous_value__;return Bd(t)?Ud(t):t}function Vd(e){var t=Md(e.mapValue.fields.__local_write_time__.timestampValue);return new id(t.seconds,t.nanos)}var zd=d((function e(t,n,r,a,i,o,s,u){c(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u})),jd=function(){function e(t,n){c(this,e),this.projectId=t,this.database=n||"(default)"}return d(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function Wd(e){return null==e}function Hd(e){return 0===e&&1/e==-1/0}function qd(e){return"number"==typeof e&&Number.isInteger(e)&&!Hd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var Gd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Kd(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Bd(e)?4:sp(e)?9007199254740991:10:zh()}function Xd(e,t){if(e===t)return!0;var n=Kd(e);if(n!==Kd(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Vd(e).isEqual(Vd(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Md(e.timestampValue),r=Md(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ld(e.bytesValue).isEqual(Ld(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Fd(e.geoPointValue.latitude)===Fd(t.geoPointValue.latitude)&&Fd(e.geoPointValue.longitude)===Fd(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Fd(e.integerValue)===Fd(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Fd(e.doubleValue),r=Fd(t.doubleValue);return n===r?Hd(n)===Hd(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ad(e.arrayValue.values||[],t.arrayValue.values||[],Xd);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Sd(n)!==Sd(r))return!1;for(var a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Xd(n[a],r[a])))return!1;return!0}(e,t);default:return zh()}}function $d(e,t){return void 0!==(e.values||[]).find((function(e){return Xd(e,t)}))}function Qd(e,t){if(e===t)return 0;var n=Kd(e),r=Kd(t);if(n!==r)return rd(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return rd(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Fd(e.integerValue||e.doubleValue),r=Fd(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Yd(e.timestampValue,t.timestampValue);case 4:return Yd(Vd(e),Vd(t));case 5:return rd(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Ld(e),r=Ld(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0;a<n.length&&a<r.length;a++){var i=rd(n[a],r[a]);if(0!==i)return i}return rd(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=rd(Fd(e.latitude),Fd(t.latitude));return 0!==n?n:rd(Fd(e.longitude),Fd(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],a=0;a<n.length&&a<r.length;++a){var i=Qd(n[a],r[a]);if(i)return i}return rd(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Gd.mapValue&&t===Gd.mapValue)return 0;if(e===Gd.mapValue)return 1;if(t===Gd.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(var o=0;o<r.length&&o<i.length;++o){var s=rd(r[o],i[o]);if(0!==s)return s;var u=Qd(n[r[o]],a[i[o]]);if(0!==u)return u}return rd(r.length,i.length)}(e.mapValue,t.mapValue);default:throw zh()}}function Yd(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return rd(e,t);var n=Md(e),r=Md(t),a=rd(n.seconds,r.seconds);return 0!==a?a:rd(n.nanos,r.nanos)}function Jd(e){return Zd(e)}function Zd(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Md(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ld(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,fd.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,a=We(e.values||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+=Zd(i)}}catch(o){a.e(o)}finally{a.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,a=We(Object.keys(e.fields||{}).sort());try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+="".concat(i,":").concat(Zd(e.fields[i]))}}catch(o){a.e(o)}finally{a.f()}return n+"}"}(e.mapValue):zh();var t,n}function ep(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function tp(e){return!!e&&"integerValue"in e}function np(e){return!!e&&"arrayValue"in e}function rp(e){return!!e&&"nullValue"in e}function ap(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ip(e){return!!e&&"mapValue"in e}function op(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Cd(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=op(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=op(e.arrayValue.values[r]);return n}return Object.assign({},e)}function sp(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var up=function(){function e(t){c(this,e),this.value=t}return d(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!ip(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=op(t)}},{key:"setAll",value:function(e){var t=this,n=ld.emptyPath(),r={},a=[];e.forEach((function(e,i){if(!n.isImmediateParentOf(i)){var o=t.getFieldsMap(n);t.applyChanges(o,r,a),r={},a=[],n=i.popLast()}e?r[i.lastSegment()]=op(e):a.push(i.lastSegment())}));var i=this.getFieldsMap(n);this.applyChanges(i,r,a)}},{key:"delete",value:function(e){var t=this.field(e.popLast());ip(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Xd(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];ip(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Cd(t,(function(t,n){return e[t]=n}));var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;delete e[i]}}catch(o){a.e(o)}finally{a.f()}}},{key:"clone",value:function(){return new e(op(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function cp(e){var t=[];return Cd(e.fields,(function(e,n){var r=new ld([e]);if(ip(n)){var a=cp(n.mapValue).fields;if(0===a.length)t.push(r);else{var i,o=We(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)})),new Od(t)}var lp=function(){function e(t,n,r,a,i,o){c(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.data=i,this.documentState=o}return d(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=up.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=up.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=od.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,od.min(),od.min(),up.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,od.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,od.min(),up.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,od.min(),up.empty(),2)}}]),e}(),fp=d((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;c(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=s,this.ht=null}));function hp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new fp(e,t,n,r,a,i,o)}function dp(e){var t=Wh(e);if(null===t.ht){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return(t=e).field.canonicalString()+t.op.toString()+Jd(t.value);var t})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Wd(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Jd(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Jd(e)})).join(",")),t.ht=n}return t.ht}function pp(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!_p(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(a=e.filters[r],i=t.filters[r],a.op!==i.op||!a.field.isEqual(i.field)||!Xd(a.value,i.value))return!1;var a,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Np(e.startAt,t.startAt)&&Np(e.endAt,t.endAt)}function vp(e){return fd.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var mp=function(e){v(n,e);var t=x(n);function n(e,r,a){var i;return c(this,n),(i=t.call(this)).field=e,i.op=r,i.value=a,i}return d(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(Qd(t,this.value)):null!==t&&Kd(this.value)===Kd(t)&&this.ft(Qd(t,this.value))}},{key:"ft",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return zh()}}},{key:"dt",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new gp(e,t,r):"array-contains"===t?new wp(e,r):"in"===t?new kp(e,r):"not-in"===t?new Ep(e,r):"array-contains-any"===t?new Sp(e,r):new n(e,t,r)}},{key:"lt",value:function(e,t,n){return"in"===t?new yp(e,n):new bp(e,n)}}]),n}(function(){return d((function e(){c(this,e)}))}()),gp=function(e){v(n,e);var t=x(n);function n(e,r,a){var i;return c(this,n),(i=t.call(this,e,r,a)).key=fd.fromName(a.referenceValue),i}return d(n,[{key:"matches",value:function(e){var t=fd.comparator(e.key,this.key);return this.ft(t)}}]),n}(mp),yp=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this,e,"in",r)).keys=xp("in",r),a}return d(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(mp),bp=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this,e,"not-in",r)).keys=xp("not-in",r),a}return d(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(mp);function xp(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return fd.fromName(e.referenceValue)}))}var wp=function(e){v(n,e);var t=x(n);function n(e,r){return c(this,n),t.call(this,e,"array-contains",r)}return d(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return np(t)&&$d(t.arrayValue,this.value)}}]),n}(mp),kp=function(e){v(n,e);var t=x(n);function n(e,r){return c(this,n),t.call(this,e,"in",r)}return d(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&$d(this.value.arrayValue,t)}}]),n}(mp),Ep=function(e){v(n,e);var t=x(n);function n(e,r){return c(this,n),t.call(this,e,"not-in",r)}return d(n,[{key:"matches",value:function(e){if($d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!$d(this.value.arrayValue,t)}}]),n}(mp),Sp=function(e){v(n,e);var t=x(n);function n(e,r){return c(this,n),t.call(this,e,"array-contains-any",r)}return d(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!np(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return $d(t.value.arrayValue,e)}))}}]),n}(mp),Cp=d((function e(t,n){c(this,e),this.position=t,this.inclusive=n})),Ip=d((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";c(this,e),this.field=t,this.dir=n}));function _p(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Tp(e,t,n){for(var r=0,a=0;a<e.position.length;a++){var i=t[a],o=e.position[a];if(r=i.field.isKeyField()?fd.comparator(fd.fromName(o.referenceValue),n.key):Qd(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Np(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Xd(e.position[n],t.position[n]))return!1;return!0}var Rp=d((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;c(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this._t=null,this.wt=null,this.startAt,this.endAt}));function Ap(e,t,n,r,a,i,o,s){return new Rp(e,t,n,r,a,i,o,s)}function Op(e){return new Rp(e)}function Dp(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Pp(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Mp(e){var t,n=We(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.dt())return r.field}}catch(a){n.e(a)}finally{n.f()}return null}function Fp(e){return null!==e.collectionGroup}function Lp(e){var t=Wh(e);if(null===t._t){t._t=[];var n=Mp(t),r=Pp(t);if(null!==n&&null===r)n.isKeyField()||t._t.push(new Ip(n)),t._t.push(new Ip(ld.keyField(),"asc"));else{var a,i=!1,o=We(t.explicitOrderBy);try{for(o.s();!(a=o.n()).done;){var s=a.value;t._t.push(s),s.field.isKeyField()&&(i=!0)}}catch(c){o.e(c)}finally{o.f()}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new Ip(ld.keyField(),u))}}}return t._t}function Bp(e){var t=Wh(e);if(!t.wt)if("F"===t.limitType)t.wt=hp(t.path,t.collectionGroup,Lp(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],a=We(Lp(t));try{for(a.s();!(n=a.n()).done;){var i=n.value,o="desc"===i.dir?"asc":"desc";r.push(new Ip(i.field,o))}}catch(c){a.e(c)}finally{a.f()}var s=t.endAt?new Cp(t.endAt.position,t.endAt.inclusive):null,u=t.startAt?new Cp(t.startAt.position,t.startAt.inclusive):null;t.wt=hp(t.path,t.collectionGroup,r,t.filters,t.limit,s,u)}return t.wt}function Up(e,t,n){return new Rp(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Vp(e,t){return pp(Bp(e),Bp(t))&&e.limitType===t.limitType}function zp(e){return"".concat(dp(Bp(e)),"|lt:").concat(e.limitType)}function jp(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(Jd(t.value));var t})).join(", "),"]")),Wd(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return Jd(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return Jd(e)})).join(",")),"Target(".concat(t,")")}(Bp(e)),"; limitType=").concat(e.limitType,")")}function Wp(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):fd.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=We(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!a.field.isKeyField()&&null===t.data.field(a.field))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=We(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=Tp(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Lp(e),t))&&!(e.endAt&&!function(e,t,n){var r=Tp(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Lp(e),t))}(e,t)}function Hp(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function qp(e){return function(t,n){var r,a=!1,i=We(Lp(e));try{for(i.s();!(r=i.n()).done;){var o=r.value,s=Gp(o,t,n);if(0!==s)return s;a=a||o.field.isKeyField()}}catch(u){i.e(u)}finally{i.f()}return 0}}function Gp(e,t,n){var r=e.field.isKeyField()?fd.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Qd(r,a):zh()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return zh()}}function Kp(e,t){if(e.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hd(t)?"-0":t}}function Xp(e){return{integerValue:""+e}}function $p(e,t){return qd(t)?Xp(t):Kp(e,t)}var Qp=d((function e(){c(this,e),this._=void 0}));function Yp(e,t,n){return e instanceof ev?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof tv?nv(e,t):e instanceof rv?av(e,t):function(e,t){var n=Zp(e,t),r=ov(n)+ov(e.yt);return tp(n)&&tp(e.yt)?Xp(r):Kp(e.It,r)}(e,t)}function Jp(e,t,n){return e instanceof tv?nv(e,t):e instanceof rv?av(e,t):n}function Zp(e,t){return e instanceof iv?tp(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var ev=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n)}(Qp),tv=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this)).elements=e,r}return d(n)}(Qp);function nv(e,t){var n,r=sv(t),a=We(e.elements);try{var i=function(){var e=n.value;r.some((function(t){return Xd(t,e)}))||r.push(e)};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var rv=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this)).elements=e,r}return d(n)}(Qp);function av(e,t){var n,r=sv(t),a=We(e.elements);try{var i=function(){var e=n.value;r=r.filter((function(t){return!Xd(t,e)}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var iv=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this)).It=e,a.yt=r,a}return d(n)}(Qp);function ov(e){return Fd(e.integerValue||e.doubleValue)}function sv(e){return np(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var uv=d((function e(t,n){c(this,e),this.field=t,this.transform=n}));var cv=d((function e(t,n){c(this,e),this.version=t,this.transformResults=n})),lv=function(){function e(t,n){c(this,e),this.updateTime=t,this.exists=n}return d(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function fv(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var hv=d((function e(){c(this,e)}));function dv(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Cv(e.key,lv.none()):new yv(e.key,e.data,lv.none());var n,r=e.data,a=up.empty(),i=new Rd(ld.comparator),o=We(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!i.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?a.delete(s):a.set(s,u),i=i.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new bv(e.key,a,new Od(i.toArray()),lv.none())}function pv(e,t,n){e instanceof yv?function(e,t,n){var r=e.value.clone(),a=wv(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof bv?function(e,t,n){if(fv(e.precondition,t)){var r=wv(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(xv(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function vv(e,t,n,r){return e instanceof yv?function(e,t,n,r){if(!fv(e.precondition,t))return n;var a=e.value.clone(),i=kv(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof bv?function(e,t,n,r){if(!fv(e.precondition,t))return n;var a=kv(e.fieldTransforms,r,t),i=t.data;return i.setAll(xv(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return fv(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function mv(e,t){var n,r=null,a=We(e.fieldTransforms);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=t.data.field(i.field),s=Zp(i.transform,o||null);null!=s&&(null===r&&(r=up.empty()),r.set(i.field,s))}}catch(u){a.e(u)}finally{a.f()}return r||null}function gv(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ad(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof tv&&t instanceof tv||e instanceof rv&&t instanceof rv?ad(e.elements,t.elements,Xd):e instanceof iv&&t instanceof iv?Xd(e.yt,t.yt):e instanceof ev&&t instanceof ev}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var yv=function(e){v(n,e);var t=x(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return c(this,n),(i=t.call(this)).key=e,i.value=r,i.precondition=a,i.fieldTransforms=o,i.type=0,i}return d(n,[{key:"getFieldMask",value:function(){return null}}]),n}(hv),bv=function(e){v(n,e);var t=x(n);function n(e,r,a,i){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return c(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=a,o.precondition=i,o.fieldTransforms=s,o.type=1,o}return d(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(hv);function xv(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function wv(e,t,n){var r=new Map;jh(e.length===n.length);for(var a=0;a<n.length;a++){var i=e[a],o=i.transform,s=t.data.field(i.field);r.set(i.field,Jp(o,s,n[a]))}return r}function kv(e,t,n){var r,a=new Map,i=We(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);a.set(o.field,Yp(s,u,t))}}catch(c){i.e(c)}finally{i.f()}return a}var Ev,Sv,Cv=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=2,a.fieldTransforms=[],a}return d(n,[{key:"getFieldMask",value:function(){return null}}]),n}(hv),Iv=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=3,a.fieldTransforms=[],a}return d(n,[{key:"getFieldMask",value:function(){return null}}]),n}(hv),_v=d((function e(t){c(this,e),this.count=t}));function Tv(e){switch(e){default:return zh();case Hh.CANCELLED:case Hh.UNKNOWN:case Hh.DEADLINE_EXCEEDED:case Hh.RESOURCE_EXHAUSTED:case Hh.INTERNAL:case Hh.UNAVAILABLE:case Hh.UNAUTHENTICATED:return!1;case Hh.INVALID_ARGUMENT:case Hh.NOT_FOUND:case Hh.ALREADY_EXISTS:case Hh.PERMISSION_DENIED:case Hh.FAILED_PRECONDITION:case Hh.ABORTED:case Hh.OUT_OF_RANGE:case Hh.UNIMPLEMENTED:case Hh.DATA_LOSS:return!0}}function Nv(e){if(void 0===e)return Bh("GRPC error has no .code"),Hh.UNKNOWN;switch(e){case Ev.OK:return Hh.OK;case Ev.CANCELLED:return Hh.CANCELLED;case Ev.UNKNOWN:return Hh.UNKNOWN;case Ev.DEADLINE_EXCEEDED:return Hh.DEADLINE_EXCEEDED;case Ev.RESOURCE_EXHAUSTED:return Hh.RESOURCE_EXHAUSTED;case Ev.INTERNAL:return Hh.INTERNAL;case Ev.UNAVAILABLE:return Hh.UNAVAILABLE;case Ev.UNAUTHENTICATED:return Hh.UNAUTHENTICATED;case Ev.INVALID_ARGUMENT:return Hh.INVALID_ARGUMENT;case Ev.NOT_FOUND:return Hh.NOT_FOUND;case Ev.ALREADY_EXISTS:return Hh.ALREADY_EXISTS;case Ev.PERMISSION_DENIED:return Hh.PERMISSION_DENIED;case Ev.FAILED_PRECONDITION:return Hh.FAILED_PRECONDITION;case Ev.ABORTED:return Hh.ABORTED;case Ev.OUT_OF_RANGE:return Hh.OUT_OF_RANGE;case Ev.UNIMPLEMENTED:return Hh.UNIMPLEMENTED;case Ev.DATA_LOSS:return Hh.DATA_LOSS;default:return zh()}}(Sv=Ev||(Ev={}))[Sv.OK=0]="OK",Sv[Sv.CANCELLED=1]="CANCELLED",Sv[Sv.UNKNOWN=2]="UNKNOWN",Sv[Sv.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sv[Sv.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sv[Sv.NOT_FOUND=5]="NOT_FOUND",Sv[Sv.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sv[Sv.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sv[Sv.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sv[Sv.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sv[Sv.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sv[Sv.ABORTED=10]="ABORTED",Sv[Sv.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sv[Sv.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sv[Sv.INTERNAL=13]="INTERNAL",Sv[Sv.UNAVAILABLE=14]="UNAVAILABLE",Sv[Sv.DATA_LOSS=15]="DATA_LOSS";var Rv=function(){function e(t,n){c(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return d(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=s(r.value,2),o=i[0],u=i[1];if(this.equalsFn(o,e))return u}}catch(c){a.e(c)}finally{a.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Cd(this.inner,(function(t,n){var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=s(r.value,2),o=i[0],u=i[1];e(o,u)}}catch(c){a.e(c)}finally{a.f()}}))}},{key:"isEmpty",value:function(){return Id(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),Av=new _d(fd.comparator);function Ov(){return Av}var Dv=new _d(fd.comparator);function Pv(){for(var e=Dv,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.insert(o.key,o)}return e}function Mv(e){var t=Dv;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function Fv(){return Bv()}function Lv(){return Bv()}function Bv(){return new Rv((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Uv=new _d(fd.comparator),Vv=new Rd(fd.comparator);function zv(){for(var e=Vv,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.add(o)}return e}var jv=new Rd(rd);function Wv(){return jv}var Hv=function(){function e(t,n,r,a,i){c(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}return d(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var a=new Map;return a.set(t,qv.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(od.min(),a,Wv(),Ov(),zv())}}]),e}(),qv=function(){function e(t,n,r,a,i){c(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}return d(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,zv(),zv(),zv())}}]),e}(),Gv=d((function e(t,n,r,a){c(this,e),this.Tt=t,this.removedTargetIds=n,this.key=r,this.Et=a})),Kv=d((function e(t,n){c(this,e),this.targetId=t,this.At=n})),Xv=d((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dd.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;c(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a})),$v=function(){function e(){c(this,e),this.Rt=0,this.bt=Jv(),this.Pt=Dd.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}return d(e,[{key:"current",get:function(){return this.vt}},{key:"resumeToken",get:function(){return this.Pt}},{key:"St",get:function(){return 0!==this.Rt}},{key:"Dt",get:function(){return this.Vt}},{key:"Ct",value:function(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}},{key:"xt",value:function(){var e=zv(),t=zv(),n=zv();return this.bt.forEach((function(r,a){switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:zh()}})),new qv(this.Pt,this.vt,e,t,n)}},{key:"Nt",value:function(){this.Vt=!1,this.bt=Jv()}},{key:"kt",value:function(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}},{key:"Ot",value:function(e){this.Vt=!0,this.bt=this.bt.remove(e)}},{key:"Mt",value:function(){this.Rt+=1}},{key:"Ft",value:function(){this.Rt-=1}},{key:"$t",value:function(){this.Vt=!0,this.vt=!0}}]),e}(),Qv=function(){function e(t){c(this,e),this.Bt=t,this.Lt=new Map,this.Ut=Ov(),this.qt=Yv(),this.Kt=new Rd(rd)}return d(e,[{key:"Gt",value:function(e){var t,n=We(e.Tt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.Et&&e.Et.isFoundDocument()?this.Qt(r,e.Et):this.jt(r,e.key,e.Et)}}catch(s){n.e(s)}finally{n.f()}var a,i=We(e.removedTargetIds);try{for(i.s();!(a=i.n()).done;){var o=a.value;this.jt(o,e.key,e.Et)}}catch(s){i.e(s)}finally{i.f()}}},{key:"Wt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.zt(n);switch(e.state){case 0:t.Ht(n)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||t.removeTarget(n);break;case 3:t.Ht(n)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:t.Ht(n)&&(t.Jt(n),r.Ct(e.resumeToken));break;default:zh()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((function(e,r){n.Ht(r)&&t(r)}))}},{key:"Yt",value:function(e){var t=e.targetId,n=e.At.count,r=this.Xt(t);if(r){var a=r.target;if(vp(a))if(0===n){var i=new fd(a.path);this.jt(t,i,lp.newNoDocument(i,od.min()))}else jh(1===n);else this.Zt(t)!==n&&(this.Jt(t),this.Kt=this.Kt.add(t))}}},{key:"te",value:function(e){var t=this,n=new Map;this.Lt.forEach((function(r,a){var i=t.Xt(a);if(i){if(r.current&&vp(i.target)){var o=new fd(i.target.path);null!==t.Ut.get(o)||t.ee(a,o)||t.jt(a,o,lp.newNoDocument(o,e))}r.Dt&&(n.set(a,r.xt()),r.Nt())}}));var r=zv();this.qt.forEach((function(e,n){var a=!0;n.forEachWhile((function(e){var n=t.Xt(e);return!n||2===n.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.Ut.forEach((function(t,n){return n.setReadTime(e)}));var a=new Hv(e,n,this.Kt,this.Ut,r);return this.Ut=Ov(),this.qt=Yv(),this.Kt=new Rd(rd),a}},{key:"Qt",value:function(e,t){if(this.Ht(e)){var n=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}}},{key:"jt",value:function(e,t,n){if(this.Ht(e)){var r=this.zt(e);this.ee(e,t)?r.kt(t,1):r.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Lt.delete(e)}},{key:"Zt",value:function(e){var t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Mt",value:function(e){this.zt(e).Mt()}},{key:"zt",value:function(e){var t=this.Lt.get(e);return t||(t=new $v,this.Lt.set(e,t)),t}},{key:"ne",value:function(e){var t=this.qt.get(e);return t||(t=new Rd(rd),this.qt=this.qt.insert(e,t)),t}},{key:"Ht",value:function(e){var t=null!==this.Xt(e);return t||Lh("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Xt",value:function(e){var t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}},{key:"Jt",value:function(e){var t=this;this.Lt.set(e,new $v),this.Bt.getRemoteKeysForTarget(e).forEach((function(n){t.jt(e,n,null)}))}},{key:"ee",value:function(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}]),e}();function Yv(){return new _d(fd.comparator)}function Jv(){return new _d(fd.comparator)}var Zv={asc:"ASCENDING",desc:"DESCENDING"},em={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tm=d((function e(t,n){c(this,e),this.databaseId=t,this.gt=n}));function nm(e,t){return e.gt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function rm(e,t){return e.gt?t.toBase64():t.toUint8Array()}function am(e,t){return nm(e,t.toTimestamp())}function im(e){return jh(!!e),od.fromTimestamp(function(e){var t=Md(e);return new id(t.seconds,t.nanos)}(e))}function om(e,t){return function(e){return new ud(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function sm(e){var t=ud.fromString(e);return jh(_m(t)),t}function um(e,t){return om(e.databaseId,t.path)}function cm(e,t){var n=sm(t);if(n.get(1)!==e.databaseId.projectId)throw new qh(Hh.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new qh(Hh.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new fd(dm(n))}function lm(e,t){return om(e.databaseId,t)}function fm(e){var t=sm(e);return 4===t.length?ud.emptyPath():dm(t)}function hm(e){return new ud(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function dm(e){return jh(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function pm(e,t,n){return{name:um(e,t),fields:n.value.mapValue.fields}}function vm(e,t){var n;if(t instanceof yv)n={update:pm(e,t.key,t.value)};else if(t instanceof Cv)n={delete:um(e,t.key)};else if(t instanceof bv)n={update:pm(e,t.key,t.data),updateMask:Im(t.fieldMask)};else{if(!(t instanceof Iv))return zh();n={verify:um(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof ev)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof tv)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof rv)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof iv)return{fieldPath:t.field.canonicalString(),increment:n.yt};throw zh()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:am(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:zh()}(e,t.precondition)),n}function mm(e,t){return{documents:[lm(e,t.path)]}}function gm(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=lm(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=lm(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var a=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(ap(e.value))return{unaryFilter:{field:km(e.field),op:"IS_NAN"}};if(rp(e.value))return{unaryFilter:{field:km(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ap(e.value))return{unaryFilter:{field:km(e.field),op:"IS_NOT_NAN"}};if(rp(e.value))return{unaryFilter:{field:km(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:km(e.field),op:wm(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);a&&(n.structuredQuery.where=a);var i=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:km(e.field),direction:xm(e.dir)}}(e)}))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);var o,s=function(e,t){return e.gt||Wd(t)?t:{value:t}}(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ym(e){var t=fm(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,a=null;if(r>0){jh(1===r);var i=n.from[0];i.allDescendants?a=i.collectionId:t=t.child(i.collectionId)}var o=[];n.where&&(o=bm(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new Ip(Em(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var u=null;n.limit&&(u=function(e){var t;return Wd(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new Cp(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new Cp(n,t)}(n.endAt)),Ap(t,a,s,o,u,"F",c,l)}function bm(e){return e?void 0!==e.unaryFilter?[Cm(e)]:void 0!==e.fieldFilter?[Sm(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return bm(e)})).reduce((function(e,t){return e.concat(t)})):zh():[]}function xm(e){return Zv[e]}function wm(e){return em[e]}function km(e){return{fieldPath:e.canonicalString()}}function Em(e){return ld.fromServerFormat(e.fieldPath)}function Sm(e){return mp.create(Em(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return zh()}}(e.fieldFilter.op),e.fieldFilter.value)}function Cm(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Em(e.unaryFilter.field);return mp.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Em(e.unaryFilter.field);return mp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Em(e.unaryFilter.field);return mp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var a=Em(e.unaryFilter.field);return mp.create(a,"!=",{nullValue:"NULL_VALUE"});default:return zh()}}function Im(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function _m(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var Tm=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Nm=([].concat(u(Tm),["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),Rm=Nm;[].concat(Rm,["indexConfiguration","indexState","indexEntries"]);var Am=function(){function e(t,n,r,a){c(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}return d(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var a=this.mutations[r];a.key.isEqual(e.key)&&pv(a,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=We(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.key.isEqual(e.key)&&(t=vv(a,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var i,o=We(this.mutations);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.key.isEqual(e.key)&&(t=vv(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Lv();return this.mutations.forEach((function(a){var i=e.get(a.key),o=i.overlayedDocument,s=n.applyToLocalView(o,i.mutatedFields),u=dv(o,s=t.has(a.key)?null:s);null!==u&&r.set(a.key,u),o.isValidDocument()||o.convertToNoDocument(od.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),zv())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&ad(this.mutations,e.mutations,(function(e,t){return gv(e,t)}))&&ad(this.baseMutations,e.baseMutations,(function(e,t){return gv(e,t)}))}}]),e}(),Om=function(){function e(t,n,r,a){c(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}return d(e,null,[{key:"from",value:function(t,n,r){jh(t.mutations.length===r.length);for(var a=Uv,i=t.mutations,o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new e(t,n,r,a)}}]),e}(),Dm=function(){function e(t,n){c(this,e),this.largestBatchId=t,this.mutation=n}return d(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Pm=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:od.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:od.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Dd.EMPTY_BYTE_STRING;c(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return d(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),Mm=d((function e(t){c(this,e),this.re=t}));function Fm(e){var t=ym({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Up(t,t.limit,"L"):t}var Lm=function(){function e(){c(this,e)}return d(e,[{key:"ce",value:function(e,t){this.ae(e,t),t.he()}},{key:"ae",value:function(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(Fd(e.integerValue));else if("doubleValue"in e){var n=Fd(e.doubleValue);isNaN(n)?this.le(t,13):(this.le(t,15),Hd(n)?t.fe(0):t.fe(n))}else if("timestampValue"in e){var r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de("".concat(r.seconds||"")),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(Ld(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){var a=e.geoPointValue;this.le(t,45),t.fe(a.latitude||0),t.fe(a.longitude||0)}else"mapValue"in e?sp(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):zh()}},{key:"_e",value:function(e,t){this.le(t,25),this.Ie(e,t)}},{key:"Ie",value:function(e,t){t.de(e)}},{key:"ye",value:function(e,t){var n=e.fields||{};this.le(t,55);for(var r=0,a=Object.keys(n);r<a.length;r++){var i=a[r];this._e(i,t),this.ae(n[i],t)}}},{key:"pe",value:function(e,t){var n=e.values||[];this.le(t,50);var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.ae(i,t)}}catch(o){a.e(o)}finally{a.f()}}},{key:"ge",value:function(e,t){var n=this;this.le(t,37),fd.fromName(e).path.forEach((function(e){n.le(t,60),n.Ie(e,t)}))}},{key:"le",value:function(e,t){e.fe(t)}},{key:"we",value:function(e){e.fe(2)}}]),e}();Lm.Te=new Lm;var Bm=function(){function e(){c(this,e),this.Ye=new Um}return d(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Ye.add(t),wd.resolve()}},{key:"getCollectionParents",value:function(e,t){return wd.resolve(this.Ye.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return wd.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return wd.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return wd.resolve(null)}},{key:"getIndexType",value:function(e,t){return wd.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return wd.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return wd.resolve(null)}},{key:"getMinOffset",value:function(e,t){return wd.resolve(vd.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return wd.resolve(vd.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return wd.resolve()}},{key:"updateIndexEntries",value:function(e,t){return wd.resolve()}}]),e}(),Um=function(){function e(){c(this,e),this.index={}}return d(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Rd(ud.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Rd(ud.comparator)).toArray()}}]),e}();new Uint8Array(0);var Vm=function(){function e(t,n,r){c(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return d(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();Vm.DEFAULT_COLLECTION_PERCENTILE=10,Vm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vm.DEFAULT=new Vm(41943040,Vm.DEFAULT_COLLECTION_PERCENTILE,Vm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vm.DISABLED=new Vm(-1,0,0);var zm=function(){function e(t){c(this,e),this.bn=t}return d(e,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new e(0)}},{key:"vn",value:function(){return new e(-1)}}]),e}();var jm=function(){function e(){c(this,e),this.changes=new Rv((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return d(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,lp.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?wd.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}();var Wm=d((function e(t,n){c(this,e),this.overlayedDocument=t,this.mutatedFields=n})),Hm=function(){function e(t,n,r,a){c(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}return d(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(a){return r=a,n.getBaseDocument(e,t,r)})).next((function(e){return null!==r&&vv(r.mutation,e,Od.empty(),id.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,zv()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zv(),a=Fv();return this.populateOverlays(e,a,t).next((function(){return n.computeViews(e,t,a,r).next((function(e){var t=Pv();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Fv();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,zv())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var a=Ov(),i=Bv(),o=Bv();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof bv)?a=a.insert(t.key,t):void 0!==o&&(i.set(t.key,o.mutation.getFieldMask()),vv(o.mutation,t,o.mutation.getFieldMask(),id.now()))})),this.recalculateAndSaveOverlays(e,a).next((function(e){return e.forEach((function(e,t){return i.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new Wm(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Bv(),a=new _d((function(e,t){return e-t})),i=zv();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,i=We(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var i=t.get(n);if(null!==i){var o=r.get(n)||Od.empty();o=e.applyToLocalView(i,o),r.set(n,o);var s=(a.get(e.batchId)||zv()).add(n);a=a.insert(e.batchId,s)}}))};for(i.s();!(n=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}})).next((function(){for(var o=[],s=a.getReverseIterator(),u=function(){var a=s.getNext(),u=a.key,c=a.value,l=Lv();c.forEach((function(e){if(!i.has(e)){var n=dv(t.get(e),r.get(e));null!==n&&l.set(e,n),i=i.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return wd.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return fd.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var a=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(i){var o=r-i.size>0?a.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):wd.resolve(Fv()),s=-1,u=i;return o.next((function(t){return wd.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?wd.resolve():a.getBaseDocument(e,t,n).next((function(e){u=u.insert(t,e)}))})).next((function(){return a.populateOverlays(e,t,i)})).next((function(){return a.computeViews(e,u,t,zv())})).next((function(e){return{batchId:s,changes:Mv(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new fd(t)).next((function(e){var t=Pv();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,a=t.collectionGroup,i=Pv();return this.indexManager.getCollectionParents(e,a).next((function(o){return wd.forEach(o,(function(o){var s=function(e,t){return new Rp(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){i=i.insert(e,t)}))}))})).next((function(){return i}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,a=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(i){return r=i,a.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,lp.newInvalidDocument(n)))}));var n=Pv();return r.forEach((function(r,a){var i=e.get(r);void 0!==i&&vv(i.mutation,a,Od.empty(),id.now()),Wp(t,a)&&(n=n.insert(r,a))})),n}))}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):wd.resolve(lp.newInvalidDocument(t))}}]),e}(),qm=function(){function e(t){c(this,e),this.It=t,this.Zn=new Map,this.ts=new Map}return d(e,[{key:"getBundleMetadata",value:function(e,t){return wd.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:im(n.createTime)}),wd.resolve()}},{key:"getNamedQuery",value:function(e,t){return wd.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Fm(e.bundledQuery),readTime:im(e.readTime)}}(t)),wd.resolve()}}]),e}(),Gm=function(){function e(){c(this,e),this.overlays=new _d(fd.comparator),this.es=new Map}return d(e,[{key:"getOverlay",value:function(e,t){return wd.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Fv();return wd.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,a){r.ue(e,t,a)})),wd.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,a=this.es.get(n);return void 0!==a&&(a.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),wd.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Fv(),a=t.length+1,i=new fd(t.child("")),o=this.overlays.getIteratorFrom(i);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===a&&s.largestBatchId>n&&r.set(s.getKey(),s)}return wd.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var a=new _d((function(e,t){return e-t})),i=this.overlays.getIterator();i.hasNext();){var o=i.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=a.get(o.largestBatchId);null===s&&(s=Fv(),a=a.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=Fv(),c=a.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return wd.resolve(u)}},{key:"ue",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var a=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Dm(t,n));var i=this.es.get(t);void 0===i&&(i=zv(),this.es.set(t,i)),this.es.set(t,i.add(n.key))}}]),e}(),Km=function(){function e(){c(this,e),this.ns=new Rd(Xm.ss),this.rs=new Rd(Xm.os)}return d(e,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Xm(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new Xm(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new fd(new ud([])),r=new Xm(n,e),a=new Xm(n,e+1),i=[];return this.rs.forEachInRange([r,a],(function(e){t.cs(e),i.push(e.key)})),i}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new fd(new ud([])),n=new Xm(t,e),r=new Xm(t,e+1),a=zv();return this.rs.forEachInRange([n,r],(function(e){a=a.add(e.key)})),a}},{key:"containsKey",value:function(e){var t=new Xm(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Xm=function(){function e(t,n){c(this,e),this.key=t,this._s=n}return d(e,null,[{key:"ss",value:function(e,t){return fd.comparator(e.key,t.key)||rd(e._s,t._s)}},{key:"os",value:function(e,t){return rd(e._s,t._s)||fd.comparator(e.key,t.key)}}]),e}(),$m=function(){function e(t,n){c(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new Rd(Xm.ss)}return d(e,[{key:"checkEmpty",value:function(e){return wd.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var a=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var i=new Am(a,t,n,r);this.mutationQueue.push(i);var o,s=We(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.gs=this.gs.add(new Xm(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return wd.resolve(i)}},{key:"lookupMutationBatch",value:function(e,t){return wd.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),a=r<0?0:r;return wd.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return wd.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return wd.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Xm(t,0),a=new Xm(t,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,a],(function(e){var t=n.ys(e._s);i.push(t)})),wd.resolve(i)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Rd(rd);return t.forEach((function(e){var t=new Xm(e,0),a=new Xm(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,a],(function(e){r=r.add(e._s)}))})),wd.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,a=n;fd.isDocumentKey(a)||(a=a.child(""));var i=new Xm(new fd(a),0),o=new Rd(rd);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),i),wd.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;jh(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return wd.forEach(t.mutations,(function(a){var i=new Xm(a.key,t.batchId);return r=r.delete(i),n.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Xm(t,0),r=this.gs.firstAfterOrEqual(n);return wd.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,wd.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Qm=function(){function e(t){c(this,e),this.Es=t,this.docs=new _d(fd.comparator),this.size=0}return d(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return wd.resolve(n?n.document.mutableCopy():lp.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Ov();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():lp.newInvalidDocument(e))})),wd.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=Ov(),a=new fd(t.child("")),i=this.docs.getIteratorFrom(a);i.hasNext();){var o=i.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||md(pd(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return wd.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){zh()}},{key:"As",value:function(e,t){return wd.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Ym(this)}},{key:"getSize",value:function(e){return wd.resolve(this.size)}}]),e}(),Ym=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this)).Yn=e,r}return d(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,a){a.isValidDocument()?n.push(t.Yn.addEntry(e,a)):t.Yn.removeEntry(r)})),wd.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),n}(jm),Jm=function(){function e(t){c(this,e),this.persistence=t,this.Rs=new Rv((function(e){return dp(e)}),pp),this.lastRemoteSnapshotVersion=od.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Km,this.targetCount=0,this.vs=zm.Pn()}return d(e,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),wd.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return wd.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return wd.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),wd.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),wd.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new zm(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,wd.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),wd.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,wd.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,a=0,i=[];return this.Rs.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Rs.delete(o),i.push(r.removeMatchingKeysForTargetId(e,s.targetId)),a++)})),wd.waitFor(i).next((function(){return a}))}},{key:"getTargetCount",value:function(e){return wd.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return wd.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),wd.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((function(t){a.push(r.markPotentiallyOrphaned(e,t))})),wd.waitFor(a)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),wd.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return wd.resolve(n)}},{key:"containsKey",value:function(e,t){return wd.resolve(this.Ps.containsKey(t))}}]),e}(),Zm=function(){function e(t,n){var r=this;c(this,e),this.Vs={},this.overlays={},this.Ss=new Ed(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Jm(this),this.indexManager=new Bm,this.remoteDocumentCache=new Qm((function(e){return r.referenceDelegate.xs(e)})),this.It=new Mm(n),this.Ns=new qm(this.It)}return d(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Gm,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new $m(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Lh("MemoryPersistence","Starting transaction:",e);var a=new eg(this.Ss.next());return this.referenceDelegate.ks(),n(a).next((function(e){return r.referenceDelegate.Os(a).next((function(){return e}))})).toPromise().then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Ms",value:function(e,t){return wd.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),eg=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return d(n)}(yd),tg=function(){function e(t){c(this,e),this.persistence=t,this.Fs=new Km,this.$s=null}return d(e,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw zh()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),wd.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),wd.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),wd.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wd.forEach(this.Ls,(function(r){var a=fd.fromPath(r);return t.Us(e,a).next((function(e){e||n.removeEntry(a,od.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Us(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"Us",value:function(e,t){var n=this;return wd.or([function(){return wd.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ms(e,t)}])}}],[{key:"Bs",value:function(t){return new e(t)}}]),e}();var ng=function(){function e(t,n,r,a){c(this,e),this.targetId=t,this.fromCache=n,this.Si=r,this.Di=a}return d(e,null,[{key:"Ci",value:function(t,n){var r,a=zv(),i=zv(),o=We(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:a=a.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,a,i)}}]),e}(),rg=function(){function e(){c(this,e),this.xi=!1}return d(e,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var a=this;return this.ki(e,t).next((function(i){return i||a.Oi(e,t,r,n)})).next((function(n){return n||a.Mi(e,t)}))}},{key:"ki",value:function(e,t){var n=this;if(Dp(t))return wd.resolve(null);var r=Bp(t);return this.indexManager.getIndexType(e,r).next((function(a){return 0===a?null:(null!==t.limit&&1===a&&(t=Up(t,null,"F"),r=Bp(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(a){var i=zv.apply(void 0,u(a));return n.Ni.getDocuments(e,i).next((function(a){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.Fi(t,a);return n.$i(t,o,i,r.readTime)?n.ki(e,Up(t,null,"F")):n.Bi(e,o,t,r)}))}))})))}))}},{key:"Oi",value:function(e,t,n,r){var a=this;return Dp(t)||r.isEqual(od.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((function(i){var o=a.Fi(t,i);return a.$i(t,o,n,r)?a.Mi(e,t):(Fh()<=St.DEBUG&&Lh("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jp(t)),a.Bi(e,o,t,dd(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new Rd(qp(e));return t.forEach((function(t,r){Wp(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}},{key:"Mi",value:function(e,t){return Fh()<=St.DEBUG&&Lh("QueryEngine","Using full collection scan to execute query:",jp(t)),this.Ni.getDocumentsMatchingQuery(e,t,vd.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),ag=function(){function e(t,n,r,a){c(this,e),this.persistence=t,this.Li=n,this.It=a,this.Ui=new _d(rd),this.qi=new Rv((function(e){return dp(e)}),pp),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}return d(e,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hm(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Ui)}))}}]),e}();function ig(e,t,n,r){return new ag(e,t,n,r)}function og(e,t){return sg.apply(this,arguments)}function sg(){return sg=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Wh(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(a){return t=a,r.Qi(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var a,i=[],o=[],s=zv(),u=We(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;i.push(c.batchId);var l,f=We(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(b){f.e(b)}finally{f.f()}}}catch(b){u.e(b)}finally{u.f()}var d,p=We(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var m,g=We(v.mutations);try{for(g.s();!(m=g.n()).done;){var y=m.value;s=s.add(y.key)}}catch(b){g.e(b)}finally{g.f()}}}catch(b){p.e(b)}finally{p.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{ji:e,removedBatchIds:i,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),sg.apply(this,arguments)}function ug(e,t){var n=Wh(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),a=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var a=n.batch,i=a.keys(),o=wd.resolve();return i.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var i=n.docVersions.get(e);jh(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,a)}))}(n,e,t,a).next((function(){return a.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=zv(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function cg(e){var t=Wh(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function lg(e,t){var n=Wh(e),r=t.snapshotVersion,a=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var i=n.Gi.newChangeBuffer({trackRemovals:!0});a=n.Ui;var o=[];t.targetChanges.forEach((function(i,s){var u=a.get(s);if(u){o.push(n.Cs.removeMatchingKeys(e,i.removedDocuments,s).next((function(){return n.Cs.addMatchingKeys(e,i.addedDocuments,s)})));var c=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?c=c.withResumeToken(Dd.EMPTY_BYTE_STRING,od.min()).withLastLimboFreeSnapshotVersion(od.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,i)&&o.push(n.Cs.updateTargetData(e,c))}}));var s=Ov(),u=zv();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(fg(e,i,t.documentUpdates).next((function(e){s=e.Wi,u=e.zi}))),!r.isEqual(od.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return wd.waitFor(o).next((function(){return i.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.Ui=a,e}))}function fg(e,t,n){var r=zv(),a=zv();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=Ov();return n.forEach((function(n,i){var o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(od.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Lh("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{Wi:r,zi:a}}))}function hg(e,t){var n=Wh(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function dg(e,t){var n=Wh(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(a){return a?(r=a,wd.resolve(r)):n.Cs.allocateTargetId(e).next((function(a){return r=new Pm(t,a,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Ui.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(e.targetId,e),n.qi.set(t,e.targetId)),e}))}function pg(e,t,n){return vg.apply(this,arguments)}function vg(){return vg=Ge(He().mark((function e(t,n,r){var a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Wh(t),i=a.Ui.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",o,(function(e){return a.persistence.referenceDelegate.removeTarget(e,i)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),kd(e.t1)){e.next=12;break}throw e.t1;case 12:Lh("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:a.Ui=a.Ui.remove(n),a.qi.delete(i.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),vg.apply(this,arguments)}function mg(e,t,n){var r=Wh(e),a=od.min(),i=zv();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Wh(e),a=r.qi.get(n);return void 0!==a?wd.resolve(r.Ui.get(a)):r.Cs.getTargetData(t,n)}(r,e,Bp(t)).next((function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){i=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?a:od.min(),n?i:zv())})).next((function(e){return gg(r,Hp(t),e),{documents:e,Hi:i}}))}))}function gg(e,t,n){var r=e.Ki.get(t)||od.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}var yg=function(){function e(){c(this,e),this.activeTargetIds=Wv()}return d(e,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),bg=function(){function e(){c(this,e),this.Lr=new yg,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return d(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.Ur[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ur[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ur[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new yg,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),xg=function(){function e(){c(this,e)}return d(e,[{key:"qr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),wg=function(){function e(){var t=this;c(this,e),this.Kr=function(){return t.Gr()},this.Qr=function(){return t.jr()},this.Wr=[],this.zr()}return d(e,[{key:"qr",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){Lh("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=We(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"jr",value:function(){Lh("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=We(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),kg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Eg=function(){function e(t){c(this,e),this.Hr=t.Hr,this.Jr=t.Jr}return d(e,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),e}(),Sg=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return d(n,[{key:"fo",value:function(e,t,n,r){return new Promise((function(a,i){var o=new Ah;o.setWithCredentials(!0),o.listenOnce(Ih.COMPLETE,(function(){var t;try{switch(o.getLastErrorCode()){case Ch.NO_ERROR:var n=o.getResponseJson();Lh("Connection","XHR received:",JSON.stringify(n)),a(n);break;case Ch.TIMEOUT:Lh("Connection",'RPC "'+e+'" timed out'),i(new qh(Hh.DEADLINE_EXCEEDED,"Request time out"));break;case Ch.HTTP_ERROR:var r=o.getStatus();if(Lh("Connection",'RPC "'+e+'" failed with status:',r,"response text:",o.getResponseText()),r>0){var s=o.getResponseJson();Array.isArray(s)&&(s=s[0]);var u=null===(t=s)||void 0===t?void 0:t.error;if(u&&u.status&&u.message){var c=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(Hh).indexOf(t)>=0?t:Hh.UNKNOWN}(u.status);i(new qh(c,u.message))}else i(new qh(Hh.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new qh(Hh.UNAVAILABLE,"Connection failed."));break;default:zh()}}finally{Lh("Connection",'RPC "'+e+'" completed.')}}));var s=JSON.stringify(r);o.send(t,"POST",s,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Eh(),i=Sh(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Nh({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var s=r.join("");Lh("Connection","Creating WebChannel: "+s,o);var u=a.createWebChannel(s,o),c=!1,l=!1,f=new Eg({Hr:function(e){l?Lh("Connection","Not sending because WebChannel is closed:",e):(c||(Lh("Connection","Opening WebChannel transport."),u.open(),c=!0),Lh("Connection","WebChannel sending:",e),u.send(e))},Jr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return h(u,Rh.EventType.OPEN,(function(){l||Lh("Connection","WebChannel transport opened.")})),h(u,Rh.EventType.CLOSE,(function(){l||(l=!0,Lh("Connection","WebChannel transport closed"),f.io())})),h(u,Rh.EventType.ERROR,(function(e){l||(l=!0,Uh("Connection","WebChannel transport errored:",e),f.io(new qh(Hh.UNAVAILABLE,"The operation could not be completed")))})),h(u,Rh.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];jh(!!n);var r=n,a=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(a){Lh("Connection","WebChannel received error:",a);var i=a.status,o=function(e){var t=Ev[e];if(void 0!==t)return Nv(t)}(i),s=a.message;void 0===o&&(o=Hh.INTERNAL,s="Unknown error status: "+i+" with message "+a.message),l=!0,f.io(new qh(o,s)),u.close()}else Lh("Connection","WebChannel received:",n),f.ro(n)}})),h(i,_h.STAT_EVENT,(function(e){e.stat===Th.PROXY?Lh("Connection","Detected buffering proxy"):e.stat===Th.NOPROXY&&Lh("Connection","Detected no buffering proxy")})),setTimeout((function(){f.so()}),0),f}}]),n}(function(){function e(t){c(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.oo=n+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return d(e,[{key:"co",get:function(){return!1}},{key:"ao",value:function(e,t,n,r,a){var i=this.ho(e,t);Lh("RestConnection","Sending: ",i,n);var o={};return this.lo(o,r,a),this.fo(e,i,o,n).then((function(e){return Lh("RestConnection","Received: ",e),e}),(function(t){throw Uh("RestConnection","".concat(e," failed with error: "),t,"url: ",i,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,a,i){return this.ao(e,t,n,r,a)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ph,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=kg[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),e}());function Cg(){return"undefined"!=typeof document?document:null}function Ig(e){return new tm(e,!0)}var _g=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;c(this,e),this.Hs=t,this.timerId=n,this.mo=r,this.yo=a,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return d(e,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),a=Math.max(0,n-r);a>0&&Lh("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,a,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),e}(),Tg=function(){function e(t,n,r,a,i,o,s,u){c(this,e),this.Hs=t,this.vo=r,this.Vo=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new _g(t,n)}return d(e,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.No(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Mo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"Uo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(){var e=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():n&&n.code===Hh.RESOURCE_EXHAUSTED?(Bh(n.toString()),Bh("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):n&&n.code===Hh.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Zr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"qo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=s(t,2),a=r[0],i=r[1];e.So===n&&e.Go(a,i)}),(function(n){t((function(){var t=new qh(Hh.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){r((function(){return n.state=2,n.Co=n.Hs.enqueueAfterDelay(n.Vo,1e4,(function(){return n.ko()&&(n.state=3),Promise.resolve()})),n.listener.Yr()}))})),this.stream.Zr((function(e){r((function(){return n.Qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Oo",value:function(){var e=this;this.state=5,this.xo.Ro(Ge(He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"Qo",value:function(e){return Lh("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){t.Hs.enqueueAndForget((function(){return t.So===e?n():(Lh("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),Ng=function(e){v(n,e);var t=x(n);function n(e,r,a,i,o,s){var u;return c(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,a,i,s)).It=o,u}return d(n,[{key:"jo",value:function(e,t){return this.connection.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:zh()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.gt?(jh(void 0===t||"string"==typeof t),Dd.fromBase64String(t||"")):(jh(void 0===t||t instanceof Uint8Array),Dd.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?Hh.UNKNOWN:Nv(e.code);return new qh(t,e.message||"")}(o);n=new Xv(r,a,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var c=cm(e,u.document.name),l=im(u.document.updateTime),f=new up({mapValue:{fields:u.document.fields}}),h=lp.newFoundDocument(c,l,f),d=u.targetIds||[],p=u.removedTargetIds||[];n=new Gv(d,p,h.key,h)}else if("documentDelete"in t){t.documentDelete;var v=t.documentDelete;v.document;var m=cm(e,v.document),g=v.readTime?im(v.readTime):od.min(),y=lp.newNoDocument(m,g),b=v.removedTargetIds||[];n=new Gv([],b,y.key,y)}else if("documentRemove"in t){t.documentRemove;var x=t.documentRemove;x.document;var w=cm(e,x.document),k=x.removedTargetIds||[];n=new Gv([],k,w,null)}else{if(!("filter"in t))return zh();t.filter;var E=t.filter;E.targetId;var S=E.count||0,C=new _v(S),I=E.targetId;n=new Kv(I,C)}return n}(this.It,e),n=function(e){if(!("targetChange"in e))return od.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?od.min():t.readTime?im(t.readTime):od.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t={};t.database=hm(this.It),t.addTarget=function(e,t){var n,r=t.target;return(n=vp(r)?{documents:mm(e,r)}:{query:gm(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=rm(e,t.resumeToken):t.snapshotVersion.compareTo(od.min())>0&&(n.readTime=nm(e,t.snapshotVersion.toTimestamp())),n}(this.It,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return zh()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,e);n&&(t.labels=n),this.Bo(t)}},{key:"Ho",value:function(e){var t={};t.database=hm(this.It),t.removeTarget=e,this.Bo(t)}}]),n}(Tg),Rg=function(e){v(n,e);var t=x(n);function n(e,r,a,i,o,s){var u;return c(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,a,i,s)).It=o,u.Jo=!1,u}return d(n,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,je(m(n.prototype),"start",this).call(this)}},{key:"qo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.connection.wo("Write",e,t)}},{key:"onMessage",value:function(e){if(jh(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=function(e,t){return e&&e.length>0?(jh(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?im(e.updateTime):im(t);return n.isEqual(od.min())&&(n=im(t)),new cv(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=im(e.commitTime);return this.listener.Zo(n,t)}return jh(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=hm(this.It),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return vm(t.It,e)}))};this.Bo(n)}}]),n}(Tg),Ag=function(e){v(n,e);var t=x(n);function n(e,r,a,i){var o;return c(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=a,o.It=i,o.nu=!1,o}return d(n,[{key:"su",value:function(){if(this.nu)throw new qh(Hh.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ao",value:function(e,t,n){var r=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var i=s(a,2),o=i[0],u=i[1];return r.connection.ao(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Hh.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new qh(Hh.UNKNOWN,e.toString())}))}},{key:"_o",value:function(e,t,n,r){var a=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var o=s(i,2),u=o[0],c=o[1];return a.connection._o(e,t,n,u,c,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Hh.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new qh(Hh.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),n}(function(){return d((function e(){c(this,e)}))}());var Og=function(){function e(t,n){c(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return d(e,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(Bh(t),this.ou=!1):Lh("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),e}(),Dg=d((function e(t,n,r,a,i){var o=this;c(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr((function(e){r.enqueueAndForget(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Hg(o),!e.t0){e.next=5;break}return Lh("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Wh(t))._u.add(4),e.next=4,Fg(n);case 4:return n.gu.set("Unknown"),n._u.delete(4),e.next=8,Pg(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this.gu=new Og(r,a)}));function Pg(e){return Mg.apply(this,arguments)}function Mg(){return Mg=Ge(He().mark((function e(t){var n,r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Hg(t)){e.next=18;break}n=We(t.wu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),Mg.apply(this,arguments)}function Fg(e){return Lg.apply(this,arguments)}function Lg(){return Lg=Ge(He().mark((function e(t){var n,r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=We(t.wu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),Lg.apply(this,arguments)}function Bg(e,t){var n=Wh(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Wg(n)?jg(n):by(n).ko()&&Vg(n,t))}function Ug(e,t){var n=Wh(e),r=by(n);n.du.delete(t),r.ko()&&zg(n,t),0===n.du.size&&(r.ko()?r.Fo():Hg(n)&&n.gu.set("Unknown"))}function Vg(e,t){e.yu.Mt(t.targetId),by(e).zo(t)}function zg(e,t){e.yu.Mt(t),by(e).Ho(t)}function jg(e){e.yu=new Qv({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},se:function(t){return e.du.get(t)||null}}),by(e).start(),e.gu.uu()}function Wg(e){return Hg(e)&&!by(e).No()&&e.du.size>0}function Hg(e){return 0===Wh(e)._u.size}function qg(e){e.yu=void 0}function Gg(e){return Kg.apply(this,arguments)}function Kg(){return Kg=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.du.forEach((function(e,n){Vg(t,e)}));case 1:case"end":return e.stop()}}),e)}))),Kg.apply(this,arguments)}function Xg(e,t){return $g.apply(this,arguments)}function $g(){return $g=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qg(t),Wg(t)?(t.gu.hu(n),jg(t)):t.gu.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),$g.apply(this,arguments)}function Qg(e,t,n){return Yg.apply(this,arguments)}function Yg(){return Yg=Ge(He().mark((function e(t,n,r){var a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.gu.set("Online"),!(n instanceof Xv&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=Ge(He().mark((function e(t,n){var r,a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,a=We(n.targetIds),e.prev=2,a.s();case 4:if((i=a.n()).done){e.next=14;break}if(o=i.value,e.t0=t.du.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.du.delete(o),t.yu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),a.e(e.t1);case 19:return e.prev=19,a.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Lh("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,Jg(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof Gv?t.yu.Gt(n):n instanceof Kv?t.yu.Yt(n):t.yu.Wt(n),r.isEqual(od.min())){e.next=29;break}return e.prev=14,e.next=17,cg(t.localStore);case 17:if(a=e.sent,e.t1=r.compareTo(a)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.yu.te(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var a=e.du.get(r);a&&e.du.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(Dd.EMPTY_BYTE_STRING,n.snapshotVersion)),zg(e,t);var r=new Pm(n.target,t,1,n.sequenceNumber);Vg(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Lh("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,Jg(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),Yg.apply(this,arguments)}function Jg(e,t,n){return Zg.apply(this,arguments)}function Zg(){return Zg=Ge(He().mark((function e(t,n,r){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kd(n)){e.next=2;break}throw n;case 2:return t._u.add(1),e.next=5,Fg(t);case 5:t.gu.set("Offline"),r||(r=function(){return cg(t.localStore)}),t.asyncQueue.enqueueRetryable(Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lh("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t._u.delete(1),e.next=6,Pg(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),Zg.apply(this,arguments)}function ey(e,t){return t().catch((function(n){return Jg(e,n,t)}))}function ty(e){return ny.apply(this,arguments)}function ny(){return ny=Ge(He().mark((function e(t){var n,r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Wh(t),r=xy(n),a=n.fu.length>0?n.fu[n.fu.length-1].batchId:-1;case 2:if(!ry(n)){e.next=19;break}return e.prev=3,e.next=6,hg(n.localStore,a);case 6:if(null!==(i=e.sent)){e.next=10;break}return 0===n.fu.length&&r.Fo(),e.abrupt("break",19);case 10:a=i.batchId,ay(n,i),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Jg(n,e.t0);case 17:e.next=2;break;case 19:iy(n)&&oy(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),ny.apply(this,arguments)}function ry(e){return Hg(e)&&e.fu.length<10}function ay(e,t){e.fu.push(t);var n=xy(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function iy(e){return Hg(e)&&!xy(e).No()&&e.fu.length>0}function oy(e){xy(e).start()}function sy(e){return uy.apply(this,arguments)}function uy(){return uy=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xy(t).eu();case 1:case"end":return e.stop()}}),e)}))),uy.apply(this,arguments)}function cy(e){return ly.apply(this,arguments)}function ly(){return ly=Ge(He().mark((function e(t){var n,r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=xy(t),r=We(t.fu);try{for(r.s();!(a=r.n()).done;)i=a.value,n.Xo(i.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),ly.apply(this,arguments)}function fy(e,t,n){return hy.apply(this,arguments)}function hy(){return hy=Ge(He().mark((function e(t,n,r){var a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.fu.shift(),i=Om.from(a,n,r),e.next=3,ey(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}));case 3:return e.next=5,ty(t);case 5:case"end":return e.stop()}}),e)}))),hy.apply(this,arguments)}function dy(e,t){return py.apply(this,arguments)}function py(){return py=Ge(He().mark((function e(t,n){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&xy(t).Yo,!e.t0){e.next=4;break}return e.next=4,function(){var e=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Tv(a=n.code)||a===Hh.ABORTED){e.next=7;break}return r=t.fu.shift(),xy(t).Mo(),e.next=5,ey(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,ty(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:iy(t)&&oy(t);case 5:case"end":return e.stop()}}),e)}))),py.apply(this,arguments)}function vy(e,t){return my.apply(this,arguments)}function my(){return my=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Wh(t)).asyncQueue.verifyOperationInProgress(),Lh("RemoteStore","RemoteStore received new credentials"),a=Hg(r),r._u.add(3),e.next=6,Fg(r);case 6:return a&&r.gu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r._u.delete(3),e.next=12,Pg(r);case 12:case"end":return e.stop()}}),e)}))),my.apply(this,arguments)}function gy(e,t){return yy.apply(this,arguments)}function yy(){return yy=Ge(He().mark((function e(t,n){var r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Wh(t),!n){e.next=7;break}return r._u.delete(2),e.next=5,Pg(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r._u.add(2),e.next=12,Fg(r);case 12:r.gu.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),yy.apply(this,arguments)}function by(e){return e.pu||(e.pu=function(e,t,n){var r=Wh(e);return r.su(),new Ng(t,r.connection,r.authCredentials,r.appCheckCredentials,r.It,n)}(e.datastore,e.asyncQueue,{Yr:Gg.bind(null,e),Zr:Xg.bind(null,e),Wo:Qg.bind(null,e)}),e.wu.push(function(){var t=Ge(He().mark((function t(n){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.pu.Mo(),Wg(e)?jg(e):e.gu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.pu.stop();case 6:qg(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.pu}function xy(e){return e.Iu||(e.Iu=function(e,t,n){var r=Wh(e);return r.su(),new Rg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.It,n)}(e.datastore,e.asyncQueue,{Yr:sy.bind(null,e),Zr:dy.bind(null,e),tu:cy.bind(null,e),Zo:fy.bind(null,e)}),e.wu.push(function(){var t=Ge(He().mark((function t(n){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Iu.Mo(),t.next=4,ty(e);case 4:t.next=9;break;case 6:return t.next=8,e.Iu.stop();case 8:e.fu.length>0&&(Lh("RemoteStore","Stopping write stream with ".concat(e.fu.length," pending writes")),e.fu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Iu}var wy=function(){function e(t,n,r,a,i){c(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new Gh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return d(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qh(Hh.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,a,i){var o=new e(t,n,Date.now()+r,a,i);return o.start(r),o}}]),e}();function ky(e,t){if(Bh("AsyncQueue","".concat(t,": ").concat(e)),kd(e))return new qh(Hh.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var Ey=function(){function e(t){c(this,e),this.comparator=t?function(e,n){return t(e,n)||fd.comparator(e.key,n.key)}:function(e,t){return fd.comparator(e.key,t.key)},this.keyedMap=Pv(),this.sortedSet=new _d(this.comparator)}return d(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),Sy=function(){function e(){c(this,e),this.Tu=new _d(fd.comparator)}return d(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):zh():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),Cy=function(){function e(t,n,r,a,i,o,s,u,l){c(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=l}return d(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,a,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Ey.emptySet(n),o,r,a,!0,!1,i)}}]),e}(),Iy=d((function e(){c(this,e),this.Au=void 0,this.listeners=[]})),_y=d((function e(){c(this,e),this.queries=new Rv((function(e){return zp(e)}),Vp),this.onlineState="Unknown",this.Ru=new Set}));function Ty(e,t){return Ny.apply(this,arguments)}function Ny(){return Ny=Ge(He().mark((function e(t,n){var r,a,i,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Wh(t),a=n.query,i=!1,(o=r.queries.get(a))||(i=!0,o=new Iy),!i){e.next=13;break}return e.prev=3,e.next=6,r.onListen(a);case 6:o.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=ky(e.t0,"Initialization of query '".concat(jp(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(a,o),o.listeners.push(n),n.bu(r.onlineState),o.Au&&n.Pu(o.Au)&&Py(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),Ny.apply(this,arguments)}function Ry(e,t){return Ay.apply(this,arguments)}function Ay(){return Ay=Ge(He().mark((function e(t,n){var r,a,i,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Wh(t),a=n.query,i=!1,(o=r.queries.get(a))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),!i){e.next=6;break}return e.abrupt("return",(r.queries.delete(a),r.onUnlisten(a)));case 6:case"end":return e.stop()}}),e)}))),Ay.apply(this,arguments)}function Oy(e,t){var n,r=Wh(e),a=!1,i=We(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=o.query,u=r.queries.get(s);if(u){var c,l=We(u.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Pu(o)&&(a=!0)}}catch(f){l.e(f)}finally{l.f()}u.Au=o}}}catch(f){i.e(f)}finally{i.f()}a&&Py(r)}function Dy(e,t,n){var r=Wh(e),a=r.queries.get(t);if(a){var i,o=We(a.listeners);try{for(o.s();!(i=o.n()).done;){i.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function Py(e){e.Ru.forEach((function(e){e.next()}))}var My=function(){function e(t,n,r){c(this,e),this.query=t,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}return d(e,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=We(e.docChanges);try{for(r.s();!(t=r.n()).done;){var a=t.value;3!==a.type&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}e=new Cy(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var i=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),i=!0):this.Cu(e,this.onlineState)&&(this.xu(e),i=!0),this.Su=e,i}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=Cy.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}]),e}();var Fy=d((function e(t){c(this,e),this.key=t})),Ly=d((function e(t){c(this,e),this.key=t})),By=function(){function e(t,n){c(this,e),this.query=t,this.Uu=n,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=zv(),this.mutatedKeys=zv(),this.Gu=qp(t),this.Qu=new Ey(this.Gu)}return d(e,[{key:"ju",get:function(){return this.Uu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new Sy,a=t?t.Qu:this.Qu,i=t?t.mutatedKeys:this.mutatedKeys,o=a,s=!1,u="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,c="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((function(e,t){var l=a.get(e),f=Wp(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),p=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),p=!0):n.Hu(l,f)||(r.track({type:2,doc:f}),p=!0,(u&&n.Gu(f,u)>0||c&&n.Gu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),p=!0):l&&!f&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(f?(o=o.add(f),i=d?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{Qu:o,zu:r,$i:s,mutatedKeys:i}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,a=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var i=e.zu.Eu();i.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zh()}};return n(e)-n(t)}(e.type,t.type)||r.Gu(e.doc,t.doc)})),this.Ju(n);var o=t?this.Yu():[],s=0===this.Ku.size&&this.current?1:0,u=s!==this.qu;return this.qu=s,0!==i.length||u?{snapshot:new Cy(this.query,e.Qu,a,i,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Sy,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Uu=t.Uu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Uu=t.Uu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=zv(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new Ly(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new Fy(e))})),n}},{key:"tc",value:function(e){this.Uu=e.Hi,this.Ku=zv();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ec",value:function(){return Cy.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}]),e}(),Uy=d((function e(t,n,r){c(this,e),this.query=t,this.targetId=n,this.view=r})),Vy=d((function e(t){c(this,e),this.key=t,this.nc=!1})),zy=function(){function e(t,n,r,a,i,o){c(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new Rv((function(e){return zp(e)}),Vp),this.rc=new Map,this.oc=new Set,this.uc=new _d(fd.comparator),this.cc=new Map,this.ac=new Km,this.hc={},this.lc=new Map,this.fc=zm.vn(),this.onlineState="Unknown",this.dc=void 0}return d(e,[{key:"isPrimaryClient",get:function(){return!0===this.dc}}]),e}();function jy(e,t){return Wy.apply(this,arguments)}function Wy(){return Wy=Ge(He().mark((function e(t,n){var r,a,i,o,s,u;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=gb(t),!(o=r.ic.get(n))){e.next=6;break}a=o.targetId,r.sharedClientState.addLocalQueryTarget(a),i=o.view.ec(),e.next=15;break;case 6:return e.next=8,dg(r.localStore,Bp(n));case 8:return s=e.sent,r.isPrimaryClient&&Bg(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.targetId,e.next=14,Hy(r,n,a,"current"===u,s.resumeToken);case 14:i=e.sent;case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)}))),Wy.apply(this,arguments)}function Hy(e,t,n,r,a){return qy.apply(this,arguments)}function qy(){return qy=Ge(He().mark((function e(t,n,r,a,i){var o,s,u,c,l,f;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._c=function(e,n,r){return function(){var e=Ge(He().mark((function e(t,n,r,a){var i,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.view.Wu(r),e.t0=i.$i,!e.t0){e.next=6;break}return e.next=5,mg(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Wu(t,i)}));case 5:i=e.sent;case 6:return o=a&&a.targetChanges.get(n.targetId),s=n.view.applyChanges(i,t.isPrimaryClient,o),e.abrupt("return",(cb(t,n.targetId,s.Xu),s.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,mg(t.localStore,n,!0);case 3:return o=e.sent,s=new By(n,o.Hi),u=s.Wu(o.documents),c=qv.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==t.onlineState,i),l=s.applyChanges(u,t.isPrimaryClient,c),cb(t,r,l.Xu),f=new Uy(n,r,s),e.abrupt("return",(t.ic.set(n,f),t.rc.has(r)?t.rc.get(r).push(n):t.rc.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}}),e)}))),qy.apply(this,arguments)}function Gy(e,t){return Ky.apply(this,arguments)}function Ky(){return Ky=Ge(He().mark((function e(t,n){var r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Wh(t),a=r.ic.get(n),!((i=r.rc.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.rc.set(a.targetId,i.filter((function(e){return!Vp(e,n)}))),void r.ic.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,pg(r.localStore,a.targetId,!1).then((function(){r.sharedClientState.clearQueryState(a.targetId),Ug(r.remoteStore,a.targetId),sb(r,a.targetId)})).catch(bd);case 9:e.next=14;break;case 11:return sb(r,a.targetId),e.next=14,pg(r.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),Ky.apply(this,arguments)}function Xy(e,t,n){return $y.apply(this,arguments)}function $y(){return $y=Ge(He().mark((function e(t,n,r){var a,i,o;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=yb(t),e.prev=1,e.next=4,function(e,t){var n,r,a=Wh(e),i=id.now(),o=t.reduce((function(e,t){return e.add(t.key)}),zv());return a.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=Ov(),u=zv();return a.Gi.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return a.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],u=We(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=mv(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new bv(c.key,l,cp(l.value.mapValue),lv.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return a.mutationQueue.addMutationBatch(e,i,s,t)})).next((function(t){r=t;var i=t.applyToLocalDocumentSet(n,u);return a.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((function(){return{batchId:r.batchId,changes:Mv(n)}}))}(a.localStore,n);case 4:return i=e.sent,a.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.hc[e.currentUser.toKey()];r||(r=new _d(rd)),r=r.insert(t,n),e.hc[e.currentUser.toKey()]=r}(a,i.batchId,r),e.next=9,hb(a,i.changes);case 9:return e.next=11,ty(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=ky(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),$y.apply(this,arguments)}function Qy(e,t){return Yy.apply(this,arguments)}function Yy(){return Yy=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Wh(t),e.prev=1,e.next=4,lg(r.localStore,n);case 4:return a=e.sent,n.targetChanges.forEach((function(e,t){var n=r.cc.get(t);n&&(jh(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.nc=!0:e.modifiedDocuments.size>0?jh(n.nc):e.removedDocuments.size>0&&(jh(n.nc),n.nc=!1))})),e.next=8,hb(r,a,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,bd(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),Yy.apply(this,arguments)}function Jy(e,t,n){var r=Wh(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var a=[];r.ic.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&a.push(r.snapshot)})),function(e,t){var n=Wh(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var a,i=We(n.listeners);try{for(i.s();!(a=i.n()).done;){a.value.bu(t)&&(r=!0)}}catch(o){i.e(o)}finally{i.f()}})),r&&Py(n)}(r.eventManager,t),a.length&&r.sc.Wo(a),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Zy(e,t,n){return eb.apply(this,arguments)}function eb(){return eb=Ge(He().mark((function e(t,n,r){var a,i,o,s,u,c;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=Wh(t)).sharedClientState.updateQueryState(n,"rejected",r),i=a.cc.get(n),!(o=i&&i.key)){e.next=14;break}return s=(s=new _d(fd.comparator)).insert(o,lp.newNoDocument(o,od.min())),u=zv().add(o),c=new Hv(od.min(),new Map,new Rd(rd),s,u),e.next=9,Qy(a,c);case 9:a.uc=a.uc.remove(o),a.cc.delete(n),fb(a),e.next=16;break;case 14:return e.next=16,pg(a.localStore,n,!1).then((function(){return sb(a,n,r)})).catch(bd);case 16:case"end":return e.stop()}}),e)}))),eb.apply(this,arguments)}function tb(e,t){return nb.apply(this,arguments)}function nb(){return nb=Ge(He().mark((function e(t,n){var r,a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Wh(t),a=n.batch.batchId,e.prev=1,e.next=4,ug(r.localStore,n);case 4:return i=e.sent,ob(r,a,null),ib(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,hb(r,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,bd(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),nb.apply(this,arguments)}function rb(e,t,n){return ab.apply(this,arguments)}function ab(){return ab=Ge(He().mark((function e(t,n,r){var a,i;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Wh(t),e.prev=1,e.next=4,function(e,t){var n=Wh(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return jh(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,n);case 4:return i=e.sent,ob(a,n,r),ib(a,n),a.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,hb(a,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,bd(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),ab.apply(this,arguments)}function ib(e,t){(e.lc.get(t)||[]).forEach((function(e){e.resolve()})),e.lc.delete(t)}function ob(e,t,n){var r=Wh(e),a=r.hc[r.currentUser.toKey()];if(a){var i=a.get(t);i&&(n?i.reject(n):i.resolve(),a=a.remove(t)),r.hc[r.currentUser.toKey()]=a}}function sb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,a=We(e.rc.get(t));try{for(a.s();!(r=a.n()).done;){var i=r.value;e.ic.delete(i),n&&e.sc.wc(i,n)}}catch(o){a.e(o)}finally{a.f()}e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((function(t){e.ac.containsKey(t)||ub(e,t)}))}function ub(e,t){e.oc.delete(t.path.canonicalString());var n=e.uc.get(t);null!==n&&(Ug(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),fb(e))}function cb(e,t,n){var r,a=We(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;i instanceof Fy?(e.ac.addReference(i.key,t),lb(e,i)):i instanceof Ly?(Lh("SyncEngine","Document no longer in limbo: "+i.key),e.ac.removeReference(i.key,t),e.ac.containsKey(i.key)||ub(e,i.key)):zh()}}catch(o){a.e(o)}finally{a.f()}}function lb(e,t){var n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(Lh("SyncEngine","New document in limbo: "+n),e.oc.add(r),fb(e))}function fb(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){var t=e.oc.values().next().value;e.oc.delete(t);var n=new fd(ud.fromString(t)),r=e.fc.next();e.cc.set(r,new Vy(n)),e.uc=e.uc.insert(n,r),Bg(e.remoteStore,new Pm(Bp(Op(n.path)),r,2,Ed.at))}}function hb(e,t,n){return db.apply(this,arguments)}function db(){return db=Ge(He().mark((function e(t,n,r){var a,i,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Wh(t),i=[],o=[],s=[],e.t0=a.ic.isEmpty(),e.t0){e.next=9;break}return a.ic.forEach((function(e,t){s.push(a._c(t,n,r).then((function(e){if((e||r)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);var n=ng.Ci(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(s);case 6:return a.sc.Wo(i),e.next=9,function(){var e=Ge(He().mark((function e(t,n){var r,a,i,o,s,u,c,l;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Wh(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return wd.forEach(n,(function(t){return wd.forEach(t.Si,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return wd.forEach(t.Di,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),kd(e.t0)){e.next=10;break}throw e.t0;case 10:Lh("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:a=We(n);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.targetId,o.fromCache||(u=r.Ui.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),r.Ui=r.Ui.insert(s,l))}catch(f){a.e(f)}finally{a.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(a.localStore,o);case 9:case"end":return e.stop()}}),e)}))),db.apply(this,arguments)}function pb(e,t){return vb.apply(this,arguments)}function vb(){return vb=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Wh(t)).currentUser.isEqual(n)){e.next=11;break}return Lh("SyncEngine","User change. New user:",n.toKey()),e.next=5,og(r.localStore,n);case 5:return a=e.sent,r.currentUser=n,function(e,t){e.lc.forEach((function(e){e.forEach((function(e){e.reject(new qh(Hh.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.lc.clear()}(r),r.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),e.next=11,hb(r,a.ji);case 11:case"end":return e.stop()}}),e)}))),vb.apply(this,arguments)}function mb(e,t){var n=Wh(e),r=n.cc.get(t);if(r&&r.nc)return zv().add(r.key);var a=zv(),i=n.rc.get(t);if(!i)return a;var o,s=We(i);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.ic.get(u);a=a.unionWith(c.view.ju)}}catch(l){s.e(l)}finally{s.f()}return a}function gb(e){var t=Wh(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Qy.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=mb.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zy.bind(null,t),t.sc.Wo=Oy.bind(null,t.eventManager),t.sc.wc=Dy.bind(null,t.eventManager),t}function yb(e){var t=Wh(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=tb.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=rb.bind(null,t),t}var bb=function(){function e(){c(this,e),this.synchronizeTabs=!1}return d(e,[{key:"initialize",value:function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.It=Ig(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),e.next=5,this.persistence.start();case 5:this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Tc",value:function(e,t){return null}},{key:"Ec",value:function(e,t){return null}},{key:"Ic",value:function(e){return ig(this.persistence,new rg,e.initialUser,this.It)}},{key:"yc",value:function(e){return new Zm(tg.Bs,this.It)}},{key:"gc",value:function(e){return new bg}},{key:"terminate",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),xb=function(){function e(){c(this,e)}return d(e,[{key:"initialize",value:function(){var e=Ge(He().mark((function e(t,n){var r=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return Jy(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=pb.bind(null,this.syncEngine),e.next=12,gy(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new _y}},{key:"createDatastore",value:function(e){var t,n=Ig(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Sg(t));return function(e,t,n,r){return new Ag(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,a,i,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,a=function(e){return Jy(o.syncEngine,e,0)},i=wg.C()?new wg:new xg,new Dg(t,n,r,a,i)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,a,i,o){var s=new zy(e,t,n,r,a,i);return o&&(s.dc=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=Ge(He().mark((function e(t){var n;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Wh(t),Lh("RemoteStore","RemoteStore shutting down."),n._u.add(5),e.next=5,Fg(n);case 5:n.mu.shutdown(),n.gu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function wb(e,t,n){if(!n)throw new qh(Hh.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function kb(e){if(!fd.isDocumentKey(e))throw new qh(Hh.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Eb(e){if(fd.isDocumentKey(e))throw new qh(Hh.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Sb(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":zh()}function Cb(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new qh(Hh.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Sb(e);throw new qh(Hh.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var Ib=new Map,_b=function(){function e(t){var n;if(c(this,e),void 0===t.host){if(void 0!==t.ssl)throw new qh(Hh.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qh(Hh.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new qh(Hh.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return d(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),Tb=function(){function e(t,n,r,a){c(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _b({}),this._settingsFrozen=!1}return d(e,[{key:"app",get:function(){if(!this._app)throw new qh(Hh.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new qh(Hh.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _b(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Xh;switch(e.type){case"gapi":var t=e.client;return new Jh(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new qh(Hh.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=Ib.get(e);t&&(Lh("ComponentProvider","Removing Datastore"),Ib.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function Nb(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(e=Cb(e,Tb))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Uh("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},i),{host:"".concat(t,":").concat(n),ssl:!1})),a.mockUserToken){var o,s;if("string"==typeof a.mockUserToken)o=a.mockUserToken,s=Dh.MOCK_USER;else{o=st(a.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=a.mockUserToken.sub||a.mockUserToken.user_id;if(!u)throw new qh(Hh.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new Dh(u)}e._authCredentials=new $h(new Kh(o,s))}}var Rb=function(){function e(t,n,r){c(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return d(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Ob(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),Ab=function(){function e(t,n,r){c(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return d(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),Ob=function(e){v(n,e);var t=x(n);function n(e,r,a){var i;return c(this,n),(i=t.call(this,e,r,Op(a)))._path=a,i.type="collection",i}return d(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Rb(this.firestore,null,new fd(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(Ab);function Db(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=bt(e),wb("collection","path",t),e instanceof Tb){var i=ud.fromString.apply(ud,[t].concat(r));return Eb(i),new Ob(e,null,i)}if(!(e instanceof Rb||e instanceof Ob))throw new qh(Hh.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ud.fromString.apply(ud,[t].concat(r)));return Eb(o),new Ob(e.firestore,null,o)}function Pb(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=bt(e),1===arguments.length&&(t=nd.R()),wb("doc","path",t),e instanceof Tb){var i=ud.fromString.apply(ud,[t].concat(r));return kb(i),new Rb(e,null,new fd(i))}if(!(e instanceof Rb||e instanceof Ob))throw new qh(Hh.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ud.fromString.apply(ud,[t].concat(r)));return kb(o),new Rb(e.firestore,e instanceof Ob?e.converter:null,new fd(o))}var Mb=function(){function e(t){c(this,e),this.observer=t,this.muted=!1}return d(e,[{key:"next",value:function(e){this.observer.next&&this.Rc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Rc(this.observer.error,e):Bh("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"Rc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),Fb=function(){function e(t,n,r,a){var i=this;c(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=Dh.UNAUTHENTICATED,this.clientId=nd.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lh("FirestoreClient","Received user=",t.uid),e.next=3,i.authCredentialListener(t);case 3:i.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Lh("FirestoreClient","Received new app check token=",e),i.appCheckCredentialListener(e,i.user)}))}return d(e,[{key:"getConfiguration",value:function(){var e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new qh(Hh.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Gh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Ge(He().mark((function n(){var r;return He().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=ky(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function Lb(e,t){return Bb.apply(this,arguments)}function Bb(){return Bb=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Lh("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:a=r.initialUser,t.setCredentialChangeListener(function(){var e=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(t),e.t0){e.next=5;break}return e.next=4,og(n.localStore,t);case 4:a=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),Bb.apply(this,arguments)}function Ub(e,t){return Vb.apply(this,arguments)}function Vb(){return Vb=Ge(He().mark((function e(t,n){var r,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,zb(t);case 3:return r=e.sent,Lh("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return a=e.sent,e.next=10,n.initialize(r,a);case 10:t.setCredentialChangeListener((function(e){return vy(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return vy(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),Vb.apply(this,arguments)}function zb(e){return jb.apply(this,arguments)}function jb(){return jb=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Lh("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,Lb(t,new bb);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),jb.apply(this,arguments)}function Wb(e){return Hb.apply(this,arguments)}function Hb(){return Hb=Ge(He().mark((function e(t){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Lh("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,Ub(t,new xb);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),Hb.apply(this,arguments)}function qb(e){return Wb(e).then((function(e){return e.syncEngine}))}function Gb(e){return Kb.apply(this,arguments)}function Kb(){return Kb=Ge(He().mark((function e(t){var n,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wb(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=jy.bind(null,n.syncEngine),r.onUnlisten=Gy.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),Kb.apply(this,arguments)}function Xb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Gh;return e.asyncQueue.enqueueAndForget(Ge(He().mark((function a(){return He().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new Mb({next:function(i){t.enqueueAndForget((function(){return Ry(e,o)}));var s=i.docs.has(n);!s&&i.fromCache?a.reject(new qh(Hh.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&i.fromCache&&r&&"server"===r.source?a.reject(new qh(Hh.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(i)},error:function(e){return a.reject(e)}}),o=new My(Op(n.path),i,{includeMetadataChanges:!0,Nu:!0});return Ty(e,o)},a.next=3,Gb(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}function $b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Gh;return e.asyncQueue.enqueueAndForget(Ge(He().mark((function a(){return He().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new Mb({next:function(n){t.enqueueAndForget((function(){return Ry(e,o)})),n.fromCache&&"server"===r.source?a.reject(new qh(Hh.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:function(e){return a.reject(e)}}),o=new My(n,i,{includeMetadataChanges:!0,Nu:!0});return Ty(e,o)},a.next=3,Gb(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}var Qb=function(){function e(){var t=this;c(this,e),this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new _g(this,"async_queue_retry"),this.Wc=function(){var e=Cg();e&&Lh("AsyncQueue","Visibility state changed to "+e.visibilityState),t.xo.Po()};var n=Cg();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Wc)}return d(e,[{key:"isShuttingDown",get:function(){return this.Uc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.zc(),this.Hc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;var t=Cg();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}},{key:"enqueue",value:function(e){var t=this;if(this.zc(),this.Uc)return new Promise((function(){}));var n=new Gh;return this.Hc((function(){return t.Uc&&t.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Lc.push(e),t.Jc()}))}},{key:"Jc",value:function(){var e=Ge(He().mark((function e(){var t=this;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Lc.length){e.next=14;break}return e.prev=1,e.next=4,this.Lc[0]();case 4:this.Lc.shift(),this.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),kd(e.t0)){e.next=12;break}throw e.t0;case 12:Lh("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Lc.length>0&&this.xo.Ro((function(){return t.Jc()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Hc",value:function(e){var t=this,n=this.Bc.then((function(){return t.Gc=!0,e().catch((function(e){t.Kc=e,t.Gc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Bh("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Gc=!1,e}))}));return this.Bc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.zc(),this.jc.indexOf(e)>-1&&(t=0);var a=wy.createAndSchedule(this,e,t,n,(function(e){return r.Yc(e)}));return this.qc.push(a),a}},{key:"zc",value:function(){this.Kc&&zh()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Xc",value:function(){var e=Ge(He().mark((function e(){var t;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Bc,e.next=3,t;case 3:if(t!==this.Bc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Zc",value:function(e){var t,n=We(this.qc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ta",value:function(e){var t=this;return this.Xc().then((function(){t.qc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=We(t.qc);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.skipDelay(),"all"!==e&&a.timerId===e)break}}catch(i){r.e(i)}finally{r.f()}return t.Xc()}))}},{key:"ea",value:function(e){this.jc.push(e)}},{key:"Yc",value:function(e){var t=this.qc.indexOf(e);this.qc.splice(t,1)}}]),e}();function Yb(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,a=We(["next","error","complete"]);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i in r&&"function"==typeof r[i])return!0}}catch(o){a.e(o)}finally{a.f()}return!1}(e)}var Jb=function(e){v(n,e);var t=x(n);function n(e,r,a,i){var o;return c(this,n),(o=t.call(this,e,r,a,i)).type="firestore",o._queue=new Qb,o._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]",o}return d(n,[{key:"_terminate",value:function(){return this._firestoreClient||ex(this),this._firestoreClient.terminate()}}]),n}(Tb);function Zb(e){return e._firestoreClient||ex(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ex(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new zd(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Fb(e._authCredentials,e._appCheckCredentials,e._queue,r)}var tx=function(){function e(t){c(this,e),this._byteString=t}return d(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Dd.fromBase64String(t))}catch(t){throw new qh(Hh.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Dd.fromUint8Array(t))}}]),e}(),nx=function(){function e(){c(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0;a<n.length;++a)if(0===n[a].length)throw new qh(Hh.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ld(n)}return d(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var rx=d((function e(t){c(this,e),this._methodName=t})),ax=function(){function e(t,n){if(c(this,e),!isFinite(t)||t<-90||t>90)throw new qh(Hh.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new qh(Hh.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return d(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return rd(this._lat,e._lat)||rd(this._long,e._long)}}]),e}(),ix=/^__.*__$/,ox=function(){function e(t,n,r){c(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return d(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new bv(e,this.data,this.fieldMask,t,this.fieldTransforms):new yv(e,this.data,t,this.fieldTransforms)}}]),e}(),sx=function(){function e(t,n,r){c(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return d(e,[{key:"toMutation",value:function(e,t){return new bv(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function ux(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw zh()}}var cx=function(){function e(t,n,r,a,i,o){c(this,e),this.settings=t,this.databaseId=n,this.It=r,this.ignoreUndefinedProperties=a,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return d(e,[{key:"path",get:function(){return this.settings.path}},{key:"sa",get:function(){return this.settings.sa}},{key:"ia",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ra",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}},{key:"ca",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}},{key:"aa",value:function(e){return this.ia({path:void 0,oa:!0})}},{key:"ha",value:function(e){return _x(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"na",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ua(this.path.get(e))}},{key:"ua",value:function(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(ux(this.sa)&&ix.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}]),e}(),lx=function(){function e(t,n,r){c(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.It=r||Ig(t)}return d(e,[{key:"da",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new cx({sa:e,methodName:t,fa:n,path:ld.emptyPath(),oa:!1,la:r},this.databaseId,this.It,this.ignoreUndefinedProperties)}}]),e}();function fx(e){var t=e._freezeSettings(),n=Ig(e._databaseId);return new lx(e._databaseId,!!t.ignoreUndefinedProperties,n)}function hx(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.da(i.merge||i.mergeFields?2:0,t,n,a);Ex("Data must be an object, but it was:",o,r);var s,u,c=wx(r,o);if(i.merge)s=new Od(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){var l,f=[],h=We(i.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,p=Sx(t,d,n);if(!o.contains(p))throw new qh(Hh.INVALID_ARGUMENT,"Field '".concat(p,"' is specified in your field mask but missing from your input data."));Tx(f,p)||f.push(p)}}catch(v){h.e(v)}finally{h.f()}s=new Od(f),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new ox(new up(c),s,u)}var dx=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.sa)throw 1===e.sa?e.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(rx);function px(e,t,n){return new cx({sa:3,fa:t.settings.fa,methodName:e._methodName,oa:n},t.databaseId,t.It,t.ignoreUndefinedProperties)}var vx=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"_toFieldTransform",value:function(e){return new uv(e.path,new ev)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(rx),mx=function(e){v(n,e);var t=x(n);function n(e,r){var a;return c(this,n),(a=t.call(this,e))._a=r,a}return d(n,[{key:"_toFieldTransform",value:function(e){var t=px(this,e,!0),n=this._a.map((function(e){return xx(e,t)})),r=new tv(n);return new uv(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(rx);function gx(e,t,n,r){var a=e.da(1,t,n);Ex("Data must be an object, but it was:",a,r);var i=[],o=up.empty();Cd(r,(function(e,r){var s=Ix(t,e,n);r=bt(r);var u=a.ca(s);if(r instanceof dx)i.push(s);else{var c=xx(r,u);null!=c&&(i.push(s),o.set(s,c))}}));var s=new Od(i);return new sx(o,s,a.fieldTransforms)}function yx(e,t,n,r,a,i){var o=e.da(1,t,n),s=[Sx(t,r,n)],u=[a];if(i.length%2!=0)throw new qh(Hh.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<i.length;c+=2)s.push(Sx(t,i[c])),u.push(i[c+1]);for(var l=[],f=up.empty(),h=s.length-1;h>=0;--h)if(!Tx(l,s[h])){var d=s[h],p=u[h];p=bt(p);var v=o.ca(d);if(p instanceof dx)l.push(d);else{var m=xx(p,v);null!=m&&(l.push(d),f.set(d,m))}}var g=new Od(l);return new sx(f,g,o.fieldTransforms)}function bx(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return xx(n,e.da(r?4:3,t))}function xx(e,t){if(kx(e=bt(e)))return Ex("Unsupported field value:",t,e),wx(e,t);if(e instanceof rx)return function(e,t){if(!ux(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){var n,r=[],a=0,i=We(e);try{for(i.s();!(n=i.n()).done;){var o=xx(n.value,t.aa(a));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),a++}}catch(s){i.e(s)}finally{i.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=bt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return $p(t.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=id.fromDate(e);return{timestampValue:nm(t.It,n)}}if(e instanceof id){var r=new id(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:nm(t.It,r)}}if(e instanceof ax)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof tx)return{bytesValue:rm(t.It,e._byteString)};if(e instanceof Rb){var a=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(a))throw t.ha("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(a.projectId,"/").concat(a.database));return{referenceValue:om(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(Sb(e)))}(e,t)}function wx(e,t){var n={};return Id(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Cd(e,(function(e,r){var a=xx(r,t.ra(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function kx(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof id||e instanceof ax||e instanceof tx||e instanceof Rb||e instanceof rx)}function Ex(e,t,n){if(!kx(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Sb(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}}function Sx(e,t,n){if((t=bt(t))instanceof nx)return t._internalPath;if("string"==typeof t)return Ix(e,t);throw _x("Field path arguments must be of type string or ",e,!1,void 0,n)}var Cx=new RegExp("[~\\*/\\[\\]]");function Ix(e,t,n){if(t.search(Cx)>=0)throw _x("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return w(nx,u(t.split(".")))._internalPath}catch(r){throw _x("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function _x(e,t,n,r,a){var i=r&&!r.isEmpty(),o=void 0!==a,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(i||o)&&(u+=" (found",i&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(a)),u+=")"),new qh(Hh.INVALID_ARGUMENT,s+e+u)}function Tx(e,t){return e.some((function(e){return e.isEqual(t)}))}var Nx=function(){function e(t,n,r,a,i){c(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}return d(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Rb(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Rx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Ax("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),Rx=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"data",value:function(){return je(m(n.prototype),"data",this).call(this)}}]),n}(Nx);function Ax(e,t){return"string"==typeof t?Ix(e,t):t instanceof nx?t._internalPath:t._delegate._internalPath}function Ox(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new qh(Hh.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Dx=d((function e(){c(this,e)}));function Px(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=o._apply(e)}return e}var Mx=function(e){v(n,e);var t=x(n);function n(e,r,a){var i;return c(this,n),(i=t.call(this)).ma=e,i.ga=r,i.ya=a,i.type="where",i}return d(n,[{key:"_apply",value:function(e){var t=fx(e.firestore),n=function(e,t,n,r,a,i,o){var s;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new qh(Hh.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){Bx(o,i);var u,c=[],l=We(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(Lx(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=Lx(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Bx(o,i),s=bx(n,"where",o,"in"===i||"not-in"===i);var h=mp.create(a,i,s);return function(e,t){if(t.dt()){var n=Mp(e);if(null!==n&&!n.isEqual(t.field))throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=Pp(e);null!==r&&Ux(e,t.field,r)}var a=function(e,t){var n,r=We(e.filters);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(t.indexOf(a.op)>=0)return a.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new qh(Hh.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new qh(Hh.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}(e,h),h}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new Ab(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new Rp(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}]),n}(Dx);function Fx(e,t,n){var r=t,a=Ax("where",e);return new Mx(a,r,n)}function Lx(e,t,n){if("string"==typeof(n=bt(n))){if(""===n)throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fp(t)&&-1!==n.indexOf("/"))throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(ud.fromString(n));if(!fd.isDocumentKey(r))throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return ep(e,new fd(r))}if(n instanceof Rb)return ep(e,n._key);throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Sb(n),"."))}function Bx(e,t){if(!Array.isArray(e)||0===e.length)throw new qh(Hh.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new qh(Hh.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function Ux(e,t,n){if(!n.isEqual(t))throw new qh(Hh.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var Vx=function(){function e(){c(this,e)}return d(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Kd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fd(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ld(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw zh()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return Cd(e.fields,(function(e,a){r[e]=n.convertValue(a,t)})),r}},{key:"convertGeoPoint",value:function(e){return new ax(Fd(e.latitude),Fd(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Ud(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Vd(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Md(e);return new id(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=ud.fromString(e);jh(_m(n));var r=new jd(n.get(1),n.get(3)),a=new fd(n.popFirst(5));return r.isEqual(t)||Bh("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}]),e}();function zx(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var jx=function(){function e(t,n){c(this,e),this.hasPendingWrites=t,this.fromCache=n}return d(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),Wx=function(e){v(n,e);var t=x(n);function n(e,r,a,i,o,s){var u;return c(this,n),(u=t.call(this,e,r,a,i,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return d(n,[{key:"exists",value:function(){return je(m(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Hx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Ax("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(Nx),Hx=function(e){v(n,e);var t=x(n);function n(){return c(this,n),t.apply(this,arguments)}return d(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return je(m(n.prototype),"data",this).call(this,e)}}]),n}(Wx),qx=function(){function e(t,n,r,a){c(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new jx(a.hasPendingWrites,a.fromCache),this.query=r}return d(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new Hx(n._firestore,n._userDataWriter,r.key,r,new jx(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new qh(Hh.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new Hx(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new Hx(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),a=-1,i=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(i=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Gx(t.type),doc:n,oldIndex:a,newIndex:i}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function Gx(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zh()}}function Kx(e){e=Cb(e,Rb);var t=Cb(e.firestore,Jb);return Xb(Zb(t),e._key).then((function(n){return ew(t,e,n)}))}var Xx=function(e){v(n,e);var t=x(n);function n(e){var r;return c(this,n),(r=t.call(this)).firestore=e,r}return d(n,[{key:"convertBytes",value:function(e){return new tx(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rb(this.firestore,null,t)}}]),n}(Vx);function $x(e){e=Cb(e,Ab);var t=Cb(e.firestore,Jb),n=Zb(t),r=new Xx(t);return Ox(e._query),$b(n,e._query).then((function(n){return new qx(t,r,e,n)}))}function Qx(e,t,n){e=Cb(e,Rb);var r=Cb(e.firestore,Jb),a=zx(e.converter,t,n);return Zx(r,[hx(fx(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,lv.none())])}function Yx(e,t,n){e=Cb(e,Rb);for(var r=Cb(e.firestore,Jb),a=fx(r),i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return Zx(r,[("string"==typeof(t=bt(t))||t instanceof nx?yx(a,"updateDoc",e._key,t,n,o):gx(a,"updateDoc",e._key,t)).toMutation(e._key,lv.exists(!0))])}function Jx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i,o;e=bt(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||Yb(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(Yb(n[u])){var d=n[u];n[u]=null===(a=d.next)||void 0===a?void 0:a.bind(d),n[u+1]=null===(i=d.error)||void 0===i?void 0:i.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof Rb)l=Cb(e.firestore,Jb),f=Op(e._key.path),c={next:function(t){n[u]&&n[u](ew(l,e,t))},error:n[u+1],complete:n[u+2]};else{var p=Cb(e,Ab);l=Cb(p.firestore,Jb),f=p._query;var v=new Xx(l);c={next:function(e){n[u]&&n[u](new qx(l,v,p,e))},error:n[u+1],complete:n[u+2]},Ox(e._query)}return function(e,t,n,r){var a=new Mb(r),i=new My(t,a,n);return e.asyncQueue.enqueueAndForget(Ge(He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Ty,t.next=3,Gb(e);case 3:return t.t1=t.sent,t.t2=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){a.bc(),e.asyncQueue.enqueueAndForget(Ge(He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Ry,t.next=3,Gb(e);case 3:return t.t1=t.sent,t.t2=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(Zb(l),f,h,c)}function Zx(e,t){return function(e,t){var n=new Gh;return e.asyncQueue.enqueueAndForget(Ge(He().mark((function r(){return He().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Xy,r.next=3,qb(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Zb(e),t)}function ew(e,t,n){var r=n.docs.get(t._key),a=new Xx(e);return new Wx(e,a,t._key,r,new jx(n.hasPendingWrites,n.fromCache),t.converter)}function tw(){return new vx("serverTimestamp")}function nw(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new mx("arrayUnion",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Ph=e}(dn),un(new xt("firestore",(function(e,n){var r=n.instanceIdentifier,a=n.options,i=e.getProvider("app").getImmediate(),o=new Jb(new Qh(e.getProvider("auth-internal")),new ed(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new qh(Hh.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jd(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),o._setSettings(a),o}),"PUBLIC").setMultipleInstances(!0)),mn(Oh,"3.7.3",e),mn(Oh,"3.7.3","esm2017")}();pn({apiKey:"AIzaSyD27JAMnXyfJWSwJgBdpWxUHMLpbDY4j1Y",authDomain:"purer-e1a51.firebaseapp.com",projectId:"purer-e1a51",storageBucket:"purer-e1a51.appspot.com",messagingSenderId:"45382326",appId:"1:45382326:web:2d84f61c700fede2a10417"});var rw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn(),t=cn(e,"auth");if(t.isInitialized())return t.getImmediate();var n=Kn(e,{popupRedirectResolver:Mo,persistence:[Oi,si,ci]}),r=it("authTokenSyncURL");if(r){var a=Ho(r);ni(n,a,(function(){return a(n.currentUser)})),ti(n,(function(e){return a(e)}))}var i=nt("auth");return i&&ra(n,"http://".concat(i)),n}(),aw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn(),t=arguments.length>1?arguments[1]:void 0,n=cn(e=bt(e),Eu),r=n.getImmediate({identifier:t}),a=rt("storage");return a&&Iu.apply(void 0,[r].concat(u(a))),r}(),iw=function(e,t){var n="string"==typeof e?e:t||"(default)",r=cn("object"==typeof e?e:vn(),"firestore").getImmediate({identifier:n});if(!r._initialized){var a=rt("firestore");a&&Nb.apply(void 0,[r].concat(u(a)))}return r}(),ow=n(184),sw=(0,t.createContext)(),uw=function(e){var n=e.children,r=s((0,t.useState)({}),2),a=r[0],i=r[1];return(0,t.useEffect)((function(){var e=function(e,t,n,r){return bt(e).onAuthStateChanged(t,n,r)}(rw,(function(e){i(e)}));return function(){e()}}),[]),(0,ow.jsx)(sw.Provider,{value:{currentUser:a},children:n})},cw={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},lw=t.createContext&&t.createContext(cw),fw=function(){return fw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},fw.apply(this,arguments)},hw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function dw(e){return e&&e.map((function(e,n){return t.createElement(e.tag,fw({key:n},e.attr),dw(e.child))}))}function pw(e){return function(n){return t.createElement(vw,fw({attr:fw({},e.attr)},n),dw(e.child))}}function vw(e){var n=function(n){var r,a=e.attr,i=e.size,o=e.title,s=hw(e,["attr","size","title"]),u=i||n.size||"1em";return n.className&&(r=n.className),e.className&&(r=(r?r+" ":"")+e.className),t.createElement("svg",fw({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,s,{className:r,style:fw(fw({color:e.color||n.color},n.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&t.createElement("title",null,o),e.children)};return void 0!==lw?t.createElement(lw.Consumer,null,(function(e){return n(e)})):n(cw)}function mw(e){return pw({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"}}]})(e)}function gw(e){return pw({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"}}]})(e)}function yw(e){return pw({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M32,224H64V416H32A31.96166,31.96166,0,0,1,0,384V256A31.96166,31.96166,0,0,1,32,224Zm512-48V448a64.06328,64.06328,0,0,1-64,64H160a64.06328,64.06328,0,0,1-64-64V176a79.974,79.974,0,0,1,80-80H288V32a32,32,0,0,1,64,0V96H464A79.974,79.974,0,0,1,544,176ZM264,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,264,256Zm-8,128H192v32h64Zm96,0H288v32h64ZM456,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,456,256Zm-8,128H384v32h64ZM640,256V384a31.96166,31.96166,0,0,1-32,32H576V224h32A31.96166,31.96166,0,0,1,640,256Z"}}]})(e)}function bw(e){return pw({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"}}]})(e)}function xw(e){return pw({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}}]})(e)}function ww(e){return pw({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}}]})(e)}function kw(e){return pw({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(e)}function Ew(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Sw=n(441),Cw=n(613),Iw=n.n(Cw);var _w=function(e){function t(e,r,u,c,h){for(var d,p,v,m,x,k=0,E=0,S=0,C=0,I=0,O=0,P=v=d=0,F=0,L=0,B=0,U=0,V=u.length,z=V-1,j="",W="",H="",q="";F<V;){if(p=u.charCodeAt(F),F===z&&0!==E+C+S+k&&(0!==E&&(p=47===E?10:47),C=S=k=0,V++,z++),0===E+C+S+k){if(F===z&&(0<L&&(j=j.replace(f,"")),0<j.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:j+=u.charAt(F)}p=59}switch(p){case 123:for(d=(j=j.trim()).charCodeAt(0),v=1,U=++F;F<V;){switch(p=u.charCodeAt(F)){case 123:v++;break;case 125:v--;break;case 47:switch(p=u.charCodeAt(F+1)){case 42:case 47:e:{for(P=F+1;P<z;++P)switch(u.charCodeAt(P)){case 47:if(42===p&&42===u.charCodeAt(P-1)&&F+2!==P){F=P+1;break e}break;case 10:if(47===p){F=P+1;break e}}F=P}}break;case 91:p++;case 40:p++;case 34:case 39:for(;F++<z&&u.charCodeAt(F)!==p;);}if(0===v)break;F++}if(v=u.substring(U,F),0===d&&(d=(j=j.replace(l,"").trim()).charCodeAt(0)),64===d){switch(0<L&&(j=j.replace(f,"")),p=j.charCodeAt(1)){case 100:case 109:case 115:case 45:L=r;break;default:L=A}if(U=(v=t(r,L,v,p,h+1)).length,0<D&&(x=s(3,v,L=n(A,j,B),r,T,_,U,p,h,c),j=L.join(""),void 0!==x&&0===(U=(v=x.trim()).length)&&(p=0,v="")),0<U)switch(p){case 115:j=j.replace(w,o);case 100:case 109:case 45:v=j+"{"+v+"}";break;case 107:v=(j=j.replace(g,"$1 $2"))+"{"+v+"}",v=1===R||2===R&&i("@"+v,3)?"@-webkit-"+v+"@"+v:"@"+v;break;default:v=j+v,112===c&&(W+=v,v="")}else v=""}else v=t(r,n(r,j,B),v,c,h+1);H+=v,v=B=L=P=d=0,j="",p=u.charCodeAt(++F);break;case 125:case 59:if(1<(U=(j=(0<L?j.replace(f,""):j).trim()).length))switch(0===P&&(d=j.charCodeAt(0),45===d||96<d&&123>d)&&(U=(j=j.replace(" ",":")).length),0<D&&void 0!==(x=s(1,j,r,e,T,_,W.length,c,h,c))&&0===(U=(j=x.trim()).length)&&(j="\0\0"),d=j.charCodeAt(0),p=j.charCodeAt(1),d){case 0:break;case 64:if(105===p||99===p){q+=j+u.charAt(F);break}default:58!==j.charCodeAt(U-1)&&(W+=a(j,d,p,j.charCodeAt(2)))}B=L=P=d=0,j="",p=u.charCodeAt(++F)}}switch(p){case 13:case 10:47===E?E=0:0===1+d&&107!==c&&0<j.length&&(L=1,j+="\0"),0<D*M&&s(0,j,r,e,T,_,W.length,c,h,c),_=1,T++;break;case 59:case 125:if(0===E+C+S+k){_++;break}default:switch(_++,m=u.charAt(F),p){case 9:case 32:if(0===C+k+E)switch(I){case 44:case 58:case 9:case 32:m="";break;default:32!==p&&(m=" ")}break;case 0:m="\\0";break;case 12:m="\\f";break;case 11:m="\\v";break;case 38:0===C+E+k&&(L=B=1,m="\f"+m);break;case 108:if(0===C+E+k+N&&0<P)switch(F-P){case 2:112===I&&58===u.charCodeAt(F-3)&&(N=I);case 8:111===O&&(N=O)}break;case 58:0===C+E+k&&(P=F);break;case 44:0===E+S+C+k&&(L=1,m+="\r");break;case 34:case 39:0===E&&(C=C===p?0:0===C?p:C);break;case 91:0===C+E+S&&k++;break;case 93:0===C+E+S&&k--;break;case 41:0===C+E+k&&S--;break;case 40:if(0===C+E+k){if(0===d)if(2*I+3*O===533);else d=1;S++}break;case 64:0===E+S+C+k+P+v&&(v=1);break;case 42:case 47:if(!(0<C+k+S))switch(E){case 0:switch(2*p+3*u.charCodeAt(F+1)){case 235:E=47;break;case 220:U=F,E=42}break;case 42:47===p&&42===I&&U+2!==F&&(33===u.charCodeAt(U+2)&&(W+=u.substring(U,F+1)),m="",E=0)}}0===E&&(j+=m)}O=I,I=p,F++}if(0<(U=W.length)){if(L=r,0<D&&(void 0!==(x=s(2,W,L,e,T,_,U,c,h,c))&&0===(W=x).length))return q+W+H;if(W=L.join(",")+"{"+W+"}",0!==R*N){switch(2!==R||i(W,2)||(N=0),N){case 111:W=W.replace(b,":-moz-$1")+W;break;case 112:W=W.replace(y,"::-webkit-input-$1")+W.replace(y,"::-moz-$1")+W.replace(y,":-ms-input-$1")+W}N=0}}return q+W+H}function n(e,t,n){var a=t.trim().split(v);t=a;var i=a.length,o=e.length;switch(o){case 0:case 1:var s=0;for(e=0===o?"":e[0]+" ";s<i;++s)t[s]=r(e,t[s],n).trim();break;default:var u=s=0;for(t=[];s<i;++s)for(var c=0;c<o;++c)t[u++]=r(e[c]+" ",a[s],n).trim()}return t}function r(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(m,"$1"+e.trim());case 58:return e.trim()+t.replace(m,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(m,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function a(e,t,n,r){var o=e+";",s=2*t+3*n+4*r;if(944===s){e=o.indexOf(":",9)+1;var u=o.substring(e,o.length-1).trim();return u=o.substring(0,e).trim()+u+";",1===R||2===R&&i(u,1)?"-webkit-"+u+u:u}if(0===R||2===R&&!i(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(I,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(u=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+u+o;case 1005:return d.test(o)?o.replace(h,":-webkit-")+o.replace(h,":-moz-")+o:o;case 1e3:switch(t=(u=o.substring(13).trim()).indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(t)){case 226:u=o.replace(x,"tb");break;case 232:u=o.replace(x,"tb-rl");break;case 220:u=o.replace(x,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+u+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,s=(u=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(111>u.charCodeAt(8))break;case 115:o=o.replace(u,"-webkit-"+u)+";"+o;break;case 207:case 102:o=o.replace(u,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(u,"-webkit-"+u)+";"+o.replace(u,"-ms-"+u+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return u=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+u+"-ms-flex-"+u+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(E,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(E,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===C.test(e))return 115===(u=e.substring(e.indexOf(":")+1)).charCodeAt(0)?a(e.replace("stretch","fill-available"),t,n,r).replace(":fill-available",":stretch"):o.replace(u,"-webkit-"+u)+o.replace(u,"-moz-"+u.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===n+r&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+o}return o}function i(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),P(2!==t?r:r.replace(S,"$1"),n,t)}function o(e,t){var n=a(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(k," or ($1)").substring(4):"("+t+")"}function s(e,t,n,r,a,i,o,s,u,l){for(var f,h=0,d=t;h<D;++h)switch(f=O[h].call(c,e,d,n,r,a,i,o,s,u,l)){case void 0:case!1:case!0:case null:break;default:d=f}if(d!==t)return d}function u(e){return void 0!==(e=e.prefix)&&(P=null,e?"function"!==typeof e?R=1:(R=2,P=e):R=0),u}function c(e,n){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<D){var a=s(-1,n,r,r,T,_,0,0,0,0);void 0!==a&&"string"===typeof a&&(n=a)}var i=t(A,r,n,0,0);return 0<D&&(void 0!==(a=s(-2,i,r,r,T,_,i.length,0,0,0))&&(i=a)),"",N=0,_=T=1,i}var l=/^\0+/g,f=/[\0\r\f]/g,h=/: */g,d=/zoo|gra/,p=/([,: ])(transform)/g,v=/,\r+?/g,m=/([\t\r\n ])*\f?&/g,g=/@(k\w+)\s*(\S*)\s*/,y=/::(place)/g,b=/:(read-only)/g,x=/[svh]\w+-[tblr]{2}/,w=/\(\s*(.*)\s*\)/g,k=/([\s\S]*?);/g,E=/-self|flex-/g,S=/[^]*?(:[rp][el]a[\w-]+)[^]*/,C=/stretch|:\s*\w+\-(?:conte|avail)/,I=/([^-])(image-set\()/,_=1,T=1,N=0,R=1,A=[],O=[],D=0,P=null,M=0;return c.use=function e(t){switch(t){case void 0:case null:D=O.length=0;break;default:if("function"===typeof t)O[D++]=t;else if("object"===typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else M=0|!!t}return e},c.set=u,void 0!==e&&u(e),c},Tw={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var Nw=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}},Rw=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Aw=Nw((function(e){return Rw.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),Ow=n(110),Dw=n.n(Ow);function Pw(){return(Pw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Mw=function(e,t){for(var n=[e[0]],r=0,a=t.length;r<a;r+=1)n.push(t[r],e[r+1]);return n},Fw=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,Sw.typeOf)(e)},Lw=Object.freeze([]),Bw=Object.freeze({});function Uw(e){return"function"==typeof e}function Vw(e){return e.displayName||e.name||"Component"}function zw(e){return e&&"string"==typeof e.styledComponentId}var jw="undefined"!=typeof process&&({NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_ATTR)||"data-styled",Ww="undefined"!=typeof window&&"HTMLElement"in window,Hw=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&("false"!=={NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"/notox",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY)),qw={};function Gw(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var Kw=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,a=r;e>=a;)(a<<=1)<0&&Gw(16,""+e);this.groupSizes=new Uint32Array(a),this.groupSizes.set(n),this.length=a;for(var i=r;i<a;i++)this.groupSizes[i]=0}for(var o=this.indexOfGroup(e+1),s=0,u=t.length;s<u;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var a=n;a<r;a++)this.tag.deleteRule(n)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),a=r+n,i=r;i<a;i++)t+=this.tag.getRule(i)+"/*!sc*/\n";return t},e}(),Xw=new Map,$w=new Map,Qw=1,Yw=function(e){if(Xw.has(e))return Xw.get(e);for(;$w.has(Qw);)Qw++;var t=Qw++;return Xw.set(e,t),$w.set(t,e),t},Jw=function(e){return $w.get(e)},Zw=function(e,t){t>=Qw&&(Qw=t+1),Xw.set(e,t),$w.set(t,e)},ek="style["+jw+'][data-styled-version="5.3.6"]',tk=new RegExp("^"+jw+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),nk=function(e,t,n){for(var r,a=n.split(","),i=0,o=a.length;i<o;i++)(r=a[i])&&e.registerName(t,r)},rk=function(e,t){for(var n=(t.textContent||"").split("/*!sc*/\n"),r=[],a=0,i=n.length;a<i;a++){var o=n[a].trim();if(o){var s=o.match(tk);if(s){var u=0|parseInt(s[1],10),c=s[2];0!==u&&(Zw(c,u),nk(e,c,s[3]),e.getTag().insertRules(u,r)),r.length=0}else r.push(o)}}},ak=function(){return n.nc},ik=function(e){var t=document.head,n=e||t,r=document.createElement("style"),a=function(e){for(var t=e.childNodes,n=t.length;n>=0;n--){var r=t[n];if(r&&1===r.nodeType&&r.hasAttribute(jw))return r}}(n),i=void 0!==a?a.nextSibling:null;r.setAttribute(jw,"active"),r.setAttribute("data-styled-version","5.3.6");var o=ak();return o&&r.setAttribute("nonce",o),n.insertBefore(r,i),r},ok=function(){function e(e){var t=this.element=ik(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var a=t[n];if(a.ownerNode===e)return a}Gw(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),sk=function(){function e(e){var t=this.element=ik(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t),r=this.nodes[e];return this.element.insertBefore(n,r||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),uk=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),ck=Ww,lk={isServer:!Ww,useCSSOMInjection:!Hw},fk=function(){function e(e,t,n){void 0===e&&(e=Bw),void 0===t&&(t={}),this.options=Pw({},lk,{},e),this.gs=t,this.names=new Map(n),this.server=!!e.isServer,!this.server&&Ww&&ck&&(ck=!1,function(e){for(var t=document.querySelectorAll(ek),n=0,r=t.length;n<r;n++){var a=t[n];a&&"active"!==a.getAttribute(jw)&&(rk(e,a),a.parentNode&&a.parentNode.removeChild(a))}}(this))}e.registerId=function(e){return Yw(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(Pw({},this.options,{},t),this.gs,n&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(t=this.options).isServer,r=t.useCSSOMInjection,a=t.target,e=n?new uk(a):r?new ok(a):new sk(a),new Kw(e)));var e,t,n,r,a},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(Yw(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},t.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(Yw(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(Yw(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),n=t.length,r="",a=0;a<n;a++){var i=Jw(a);if(void 0!==i){var o=e.names.get(i),s=t.getGroup(a);if(o&&s&&o.size){var u=jw+".g"+a+'[id="'+i+'"]',c="";void 0!==o&&o.forEach((function(e){e.length>0&&(c+=e+",")})),r+=""+s+u+'{content:"'+c+'"}/*!sc*/\n'}}}return r}(this)},e}(),hk=/(a)(d)/gi,dk=function(e){return String.fromCharCode(e+(e>25?39:97))};function pk(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=dk(t%52)+n;return(dk(t%52)+n).replace(hk,"$1-$2")}var vk=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},mk=function(e){return vk(5381,e)};function gk(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(Uw(n)&&!zw(n))return!1}return!0}var yk=mk("5.3.6"),bk=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&gk(e),this.componentId=t,this.baseHash=vk(yk,t),this.baseStyle=n,fk.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.componentId,a=[];if(this.baseStyle&&a.push(this.baseStyle.generateAndInjectStyles(e,t,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(r,this.staticRulesId))a.push(this.staticRulesId);else{var i=Lk(this.rules,e,t,n).join(""),o=pk(vk(this.baseHash,i)>>>0);if(!t.hasNameForId(r,o)){var s=n(i,"."+o,void 0,r);t.insertRules(r,o,s)}a.push(o),this.staticRulesId=o}else{for(var u=this.rules.length,c=vk(this.baseHash,n.hash),l="",f=0;f<u;f++){var h=this.rules[f];if("string"==typeof h)l+=h;else if(h){var d=Lk(h,e,t,n),p=Array.isArray(d)?d.join(""):d;c=vk(c,p+f),l+=p}}if(l){var v=pk(c>>>0);if(!t.hasNameForId(r,v)){var m=n(l,"."+v,void 0,r);t.insertRules(r,v,m)}a.push(v)}}return a.join(" ")},e}(),xk=/^\s*\/\/.*$/gm,wk=[":","[",".","#"];function kk(e){var t,n,r,a,i=void 0===e?Bw:e,o=i.options,s=void 0===o?Bw:o,u=i.plugins,c=void 0===u?Lw:u,l=new _w(s),f=[],h=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(n,r,a,i,o,s,u,c,l,f){switch(n){case 1:if(0===l&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===c)return r+"/*|*/";break;case 3:switch(c){case 102:case 112:return e(a[0]+r),"";default:return r+(0===f?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(t)}}}((function(e){f.push(e)})),d=function(e,r,i){return 0===r&&-1!==wk.indexOf(i[n.length])||i.match(a)?e:"."+t};function p(e,i,o,s){void 0===s&&(s="&");var u=e.replace(xk,""),c=i&&o?o+" "+i+" { "+u+" }":u;return t=s,n=i,r=new RegExp("\\"+n+"\\b","g"),a=new RegExp("(\\"+n+"\\b){2,}"),l(o||!i?"":i,c)}return l.use([].concat(c,[function(e,t,a){2===e&&a.length&&a[0].lastIndexOf(n)>0&&(a[0]=a[0].replace(r,d))},h,function(e){if(-2===e){var t=f;return f=[],t}}])),p.hash=c.length?c.reduce((function(e,t){return t.name||Gw(15),vk(e,t.name)}),5381).toString():"",p}var Ek=t.createContext(),Sk=(Ek.Consumer,t.createContext()),Ck=(Sk.Consumer,new fk),Ik=kk();function _k(){return(0,t.useContext)(Ek)||Ck}function Tk(){return(0,t.useContext)(Sk)||Ik}function Nk(e){var n=(0,t.useState)(e.stylisPlugins),r=n[0],a=n[1],i=_k(),o=(0,t.useMemo)((function(){var t=i;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target]),s=(0,t.useMemo)((function(){return kk({options:{prefix:!e.disableVendorPrefixes},plugins:r})}),[e.disableVendorPrefixes,r]);return(0,t.useEffect)((function(){Iw()(r,e.stylisPlugins)||a(e.stylisPlugins)}),[e.stylisPlugins]),t.createElement(Ek.Provider,{value:o},t.createElement(Sk.Provider,{value:s},e.children))}var Rk=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=Ik);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.toString=function(){return Gw(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=Ik),this.name+e.hash},e}(),Ak=/([A-Z])/,Ok=/([A-Z])/g,Dk=/^ms-/,Pk=function(e){return"-"+e.toLowerCase()};function Mk(e){return Ak.test(e)?e.replace(Ok,Pk).replace(Dk,"-ms-"):e}var Fk=function(e){return null==e||!1===e||""===e};function Lk(e,t,n,r){if(Array.isArray(e)){for(var a,i=[],o=0,s=e.length;o<s;o+=1)""!==(a=Lk(e[o],t,n,r))&&(Array.isArray(a)?i.push.apply(i,a):i.push(a));return i}return Fk(e)?"":zw(e)?"."+e.styledComponentId:Uw(e)?"function"!=typeof(u=e)||u.prototype&&u.prototype.isReactComponent||!t?e:Lk(e(t),t,n,r):e instanceof Rk?n?(e.inject(n,r),e.getName(r)):e:Fw(e)?function e(t,n){var r,a,i=[];for(var o in t)t.hasOwnProperty(o)&&!Fk(t[o])&&(Array.isArray(t[o])&&t[o].isCss||Uw(t[o])?i.push(Mk(o)+":",t[o],";"):Fw(t[o])?i.push.apply(i,e(t[o],o)):i.push(Mk(o)+": "+(r=o,(null==(a=t[o])||"boolean"==typeof a||""===a?"":"number"!=typeof a||0===a||r in Tw?String(a).trim():a+"px")+";")));return n?[n+" {"].concat(i,["}"]):i}(e):e.toString();var u}var Bk=function(e){return Array.isArray(e)&&(e.isCss=!0),e};function Uk(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Uw(e)||Fw(e)?Bk(Lk(Mw(Lw,[e].concat(n)))):0===n.length&&1===e.length&&"string"==typeof e[0]?e:Bk(Lk(Mw(e,n)))}new Set;var Vk=function(e,t,n){return void 0===n&&(n=Bw),e.theme!==n.theme&&e.theme||t||n.theme},zk=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,jk=/(^-|-$)/g;function Wk(e){return e.replace(zk,"-").replace(jk,"")}var Hk=function(e){return pk(mk(e)>>>0)};function qk(e){return"string"==typeof e&&!0}var Gk=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Kk=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function Xk(e,t,n){var r=e[n];Gk(t)&&Gk(r)?$k(r,t):e[n]=t}function $k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if(Gk(o))for(var s in o)Kk(s)&&Xk(e,o[s],s)}return e}var Qk=t.createContext();Qk.Consumer;var Yk={};function Jk(e,n,r){var a=zw(e),i=!qk(e),o=n.attrs,s=void 0===o?Lw:o,u=n.componentId,c=void 0===u?function(e,t){var n="string"!=typeof e?"sc":Wk(e);Yk[n]=(Yk[n]||0)+1;var r=n+"-"+Hk("5.3.6"+n+Yk[n]);return t?t+"-"+r:r}(n.displayName,n.parentComponentId):u,l=n.displayName,f=void 0===l?function(e){return qk(e)?"styled."+e:"Styled("+Vw(e)+")"}(e):l,h=n.displayName&&n.componentId?Wk(n.displayName)+"-"+n.componentId:n.componentId||c,d=a&&e.attrs?Array.prototype.concat(e.attrs,s).filter(Boolean):s,p=n.shouldForwardProp;a&&e.shouldForwardProp&&(p=n.shouldForwardProp?function(t,r,a){return e.shouldForwardProp(t,r,a)&&n.shouldForwardProp(t,r,a)}:e.shouldForwardProp);var v,m=new bk(r,h,a?e.componentStyle:void 0),g=m.isStatic&&0===s.length,y=function(e,n){return function(e,n,r,a){var i=e.attrs,o=e.componentStyle,s=e.defaultProps,u=e.foldedComponentIds,c=e.shouldForwardProp,l=e.styledComponentId,f=e.target,h=function(e,t,n){void 0===e&&(e=Bw);var r=Pw({},t,{theme:e}),a={};return n.forEach((function(e){var t,n,i,o=e;for(t in Uw(o)&&(o=o(r)),o)r[t]=a[t]="className"===t?(n=a[t],i=o[t],n&&i?n+" "+i:n||i):o[t]})),[r,a]}(Vk(n,(0,t.useContext)(Qk),s)||Bw,n,i),d=h[0],p=h[1],v=function(e,t,n,r){var a=_k(),i=Tk();return t?e.generateAndInjectStyles(Bw,a,i):e.generateAndInjectStyles(n,a,i)}(o,a,d),m=r,g=p.$as||n.$as||p.as||n.as||f,y=qk(g),b=p!==n?Pw({},n,{},p):n,x={};for(var w in b)"$"!==w[0]&&"as"!==w&&("forwardedAs"===w?x.as=b[w]:(c?c(w,Aw,g):!y||Aw(w))&&(x[w]=b[w]));return n.style&&p.style!==n.style&&(x.style=Pw({},n.style,{},p.style)),x.className=Array.prototype.concat(u,l,v!==l?v:null,n.className,p.className).filter(Boolean).join(" "),x.ref=m,(0,t.createElement)(g,x)}(v,e,n,g)};return y.displayName=f,(v=t.forwardRef(y)).attrs=d,v.componentStyle=m,v.displayName=f,v.shouldForwardProp=p,v.foldedComponentIds=a?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):Lw,v.styledComponentId=h,v.target=a?e.target:e,v.withComponent=function(e){var t=n.componentId,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(n,["componentId"]),i=t&&t+"-"+(qk(e)?e:Wk(Vw(e)));return Jk(e,Pw({},a,{attrs:d,componentId:i}),r)},Object.defineProperty(v,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=a?$k({},e.defaultProps,t):t}}),v.toString=function(){return"."+v.styledComponentId},i&&Dw()(v,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),v}var Zk=function(e){return function e(t,n,r){if(void 0===r&&(r=Bw),!(0,Sw.isValidElementType)(n))return Gw(1,String(n));var a=function(){return t(n,r,Uk.apply(void 0,arguments))};return a.withConfig=function(a){return e(t,n,Pw({},r,{},a))},a.attrs=function(a){return e(t,n,Pw({},r,{attrs:Array.prototype.concat(r.attrs,a).filter(Boolean)}))},a}(Jk,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(e){Zk[e]=Zk(e)}));var eE=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=gk(e),fk.registerId(this.componentId+1)}var t=e.prototype;return t.createStyles=function(e,t,n,r){var a=r(Lk(this.rules,t,n,r).join(""),""),i=this.componentId+e;n.insertRules(i,i,a)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,n,r){e>2&&fk.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)},e}();!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var n=ak();return"<style "+[n&&'nonce="'+n+'"',jw+'="true"','data-styled-version="5.3.6"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?Gw(2):e._emitSheetCSS()},this.getStyleElement=function(){var n;if(e.sealed)return Gw(2);var r=((n={})[jw]="",n["data-styled-version"]="5.3.6",n.dangerouslySetInnerHTML={__html:e.instance.toString()},n),a=ak();return a&&(r.nonce=a),[t.createElement("style",Pw({},r,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new fk({isServer:!0}),this.sealed=!1}var n=e.prototype;n.collectStyles=function(e){return this.sealed?Gw(2):t.createElement(Nk,{sheet:this.instance},e)},n.interleaveWithNodeStream=function(e){return Gw(3)}}();var tE,nE,rE,aE,iE,oE,sE,uE,cE,lE,fE,hE,dE,pE,vE,mE,gE,yE,bE,xE,wE,kE,EE,SE,CE,IE,_E=Zk,TE=_E.div(tE||(tE=Ew(["\n  background-color: var(--slate-100);\n  height: 100vh;\n  max-width: 100vw;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]))),NE=_E.div(nE||(nE=Ew(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  align-items: center;\n\n  h1 {\n    margin: 1rem;\n  }\n"]))),RE=_E.div(rE||(rE=Ew(["\n  background-color: white;\n  padding: 2rem 4rem;\n  border-radius: 10px;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  align-items: center;\n  box-shadow: 0 4px 4px 0 var(--slate-200);\n\n  svg {\n    width: 1.5rem;\n  }\n"]))),AE=_E.span(aE||(aE=Ew(["\n  color: var(--emerald-900);\n  font-family: var(--logo-font);\n  font-size: 2rem;\n  font-weight: 700;\n"]))),OE=_E.form(iE||(iE=Ew(["\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  width: 100%;\n"]))),DE=_E.input(oE||(oE=Ew(["\n  padding: 0.5rem 0.25rem;\n  border: none;\n  border-bottom: 2px solid var(--emerald-700);\n"]))),PE=_E.label(sE||(sE=Ew(["\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  color: var(--slate-500);\n  font-size: small;\n  cursor: pointer;\n"]))),ME=_E.div(uE||(uE=Ew(["\n  height: 1.5rem;\n"]))),FE=_E.span(cE||(cE=Ew(["\n  color: firebrick;\n  font-size: small;\n  max-width: 100%;\n"]))),LE=_E.div(lE||(lE=Ew(["\n  display: flex;\n  justify-content: center;\n  gap: 1rem;\n\n  a {\n    background-color: var(--emerald-100);\n    color: var(--slate-800);\n    border: none;\n    border-radius: 10px;\n    padding: 0.75rem 1rem;\n    cursor: pointer;\n    font-size: medium;\n    text-decoration: none;\n\n    :hover {\n      background-color: var(--emerald-200);\n    }\n  }\n"]))),BE=["title","titleId"];function UE(){return UE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UE.apply(this,arguments)}function VE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function zE(e,n){var r=e.title,a=e.titleId,i=VE(e,BE);return t.createElement("svg",UE({id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 339.555 339.555",style:{enableBackground:"new 0 0 339.555 339.555"},xmlSpace:"preserve",ref:n,"aria-labelledby":a},i),r?t.createElement("title",{id:a},r):null,fE||(fE=t.createElement("path",{id:"XMLID_35_",fill:"#047857",d:"M253.895,231.663c4.295,4.297,4.294,11.262-0.002,15.557c-2.147,2.147-4.963,3.221-7.777,3.221 c-2.815,0-5.631-1.074-7.779-3.223l-11.31-11.313c-4.295-4.297-4.294-11.262,0.002-15.557c4.296-4.294,11.261-4.294,15.557,0.002 L253.895,231.663z M115.248,166.167c35.635,0,57.691-35.185,57.691-67.784V18.412c0-2.917-1.159-5.716-3.222-7.778 c-2.063-2.063-4.861-3.222-7.778-3.222l-46.695,0.001c-6.075,0-11,4.925-11,11v79.569c0,6.075,4.925,11,11,11s11-4.925,11-11V29.413 l24.695-0.001v68.972c0,19.194-12.403,45.784-35.691,45.784c-19.35,0-35.697-20.967-35.697-45.784V18.76c0-6.075-4.925-11-11-11 s-11,4.925-11,11v79.623C57.551,135.759,83.434,166.167,115.248,166.167z M339.555,60.208v260.936c0,6.075-4.925,11-11,11H11 c-6.075,0-11-4.925-11-11V60.208c0-6.075,4.925-11,11-11h15.157c6.075,0,11,4.925,11,11s-4.925,11-11,11H22v238.936h117.729 c3.231-16.422,13.629-31.799,29.802-43.967c-14.507-35.259-11.274-68.853,9.094-89.222c19.424-19.424,51.306-23.251,84.965-10.754 c13.081-25.322,32.372-41.662,53.965-45.821V71.208H206.718c-6.075,0-11-4.925-11-11s4.925-11,11-11h121.837 C334.63,49.208,339.555,54.132,339.555,60.208z M317.555,262.275c-21.113,4.972-37.694,23.962-41.645,47.868h41.645V262.275z  M317.555,143.048c-15.331,4.831-29.156,19.629-38.293,41.597c-1.15,2.766-3.379,4.943-6.172,6.028s-5.906,0.983-8.624-0.279 c-28.695-13.35-55.628-12.539-70.285,2.116c-15.177,15.179-15.546,43.032-0.965,72.69c2.498,5.081,0.731,11.228-4.082,14.207 c-13.971,8.646-23.167,19.292-26.769,30.735h33.848c-0.191-0.813-0.293-1.661-0.293-2.533c0-6.075,4.925-11,11-11h15.995 c6.075,0,11,4.925,11,11c0,0.872-0.102,1.72-0.293,2.533h20.065c4.474-36.193,30.704-64.993,63.867-70.276v-25.661 c-0.272,0.021-0.548,0.03-0.825,0.03c-6.075,0-11-4.925-11-11v-15.997c0-6.075,4.925-11,11-11c0.277,0,0.553,0.01,0.825,0.03 V143.048z"})),hE||(hE=t.createElement("g",null)),dE||(dE=t.createElement("g",null)),pE||(pE=t.createElement("g",null)),vE||(vE=t.createElement("g",null)),mE||(mE=t.createElement("g",null)),gE||(gE=t.createElement("g",null)),yE||(yE=t.createElement("g",null)),bE||(bE=t.createElement("g",null)),xE||(xE=t.createElement("g",null)),wE||(wE=t.createElement("g",null)),kE||(kE=t.createElement("g",null)),EE||(EE=t.createElement("g",null)),SE||(SE=t.createElement("g",null)),CE||(CE=t.createElement("g",null)),IE||(IE=t.createElement("g",null)))}var jE,WE,HE,qE,GE,KE,XE,$E,QE,YE,JE,ZE,eS,tS,nS,rS,aS,iS,oS,sS,uS,cS,lS,fS,hS,dS,pS,vS,mS,gS,yS,bS,xS,wS,kS,ES,SS,CS,IS,_S,TS,NS,RS,AS,OS,DS,PS=t.forwardRef(zE),MS=(n.p,function(){var e=s((0,t.useState)(!1),2),n=e[0],r=e[1],a=s((0,t.useState)(!1),2),i=a[0],o=a[1],u=s((0,t.useState)(!1),2),c=(u[0],u[1]),l=s((0,t.useState)(!0),2),f=(l[0],l[1]),h=ye(),d=function(){var e=Ge(He().mark((function e(t){var n,a,i,o,s,u,l,f,d;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),t.preventDefault(),n=t.target.username.value,a=t.target.email.value,i=t.target.password.value,o=t.target.file.files[0],e.prev=6,e.next=9,Xa(rw,a,i);case 9:return s=e.sent,u=(new Date).getTime(),l="".concat(n+u),p=l,f=gu(bt(aw),p),e.next=15,Su(f,o);case 15:return e.sent,e.next=18,Cu(f);case 18:return d=e.sent,e.prev=19,e.next=22,Za(s.user,{displayName:n,photoURL:d});case 22:return e.next=24,Qx(Pb(iw,"users",s.user.uid),{uid:s.user.uid,displayName:n,email:a,photoURL:d});case 24:return e.next=26,Qx(Pb(iw,"chats",s.user.uid),{});case 26:c(!1),h("/"),e.next=35;break;case 30:e.prev=30,e.t0=e.catch(19),console.log(e.t0),r(!0),c(!1);case 35:e.next=42;break;case 37:e.prev=37,e.t1=e.catch(6),console.log(e.t1),r(!0),c(!1);case 42:case"end":return e.stop()}var p}),e,null,[[6,37],[19,30]])})));return function(t){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){if(n){o(!0);var e=setTimeout((function(){o(!1)}),5e3);return function(){return clearTimeout(e)}}o(!1)}),[n]),(0,ow.jsxs)(TE,{children:[(0,ow.jsx)(NE,{children:(0,ow.jsx)("h1",{children:"Register"})}),(0,ow.jsxs)(RE,{children:[(0,ow.jsx)(Be,{to:"/about",children:(0,ow.jsx)(AE,{children:"notox"})}),(0,ow.jsxs)(OE,{onSubmit:d,children:[(0,ow.jsx)(DE,{type:"text",id:"username",name:"username",placeholder:"Username",maxLength:20,required:!0,disabled:!0}),(0,ow.jsx)(DE,{type:"email",id:"email",name:"email",placeholder:"Email",required:!0,disabled:!0}),(0,ow.jsx)(DE,{type:"password",id:"password",name:"password",placeholder:"Password",required:!0,disabled:!0}),(0,ow.jsx)(DE,{type:"file",id:"file",name:"file",style:{display:"none"},accept:"image/*",onChange:function(e){e.target.files[0].size>1e6?(window.alert("Please upload a file smaller than 1 MB."),f(!1)):f(!0)},disabled:!0}),(0,ow.jsxs)(PE,{htmlFor:"file",children:[(0,ow.jsx)(PS,{}),(0,ow.jsx)("span",{children:"Add your avatar."})]}),(0,ow.jsx)("button",{disabled:!0,children:"Registration disabled"})]}),(0,ow.jsx)(ME,{children:i&&(0,ow.jsx)(FE,{children:"Something went wrong."})}),(0,ow.jsxs)(LE,{children:[(0,ow.jsx)(Be,{to:"/login",children:(0,ow.jsx)(bw,{})}),(0,ow.jsx)("a",{href:"https://gmlunesa.com",target:"_blank",rel:"noreferrer",children:(0,ow.jsx)(yw,{})})]})]})]})}),FS=function(){var e=s((0,t.useState)(!1),2),n=e[0],r=e[1],a=s((0,t.useState)(!1),2),i=a[0],o=a[1],u=s((0,t.useState)(!1),2),c=u[0],l=u[1],f=ye(),h=function(){var e=Ge(He().mark((function e(t){var n,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),t.preventDefault(),n=t.target.email.value,a=t.target.password.value,e.prev=4,e.next=7,Qa(rw,n,a);case 7:e.sent,l(!1),f("/"),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0),r(!0),l(!1);case 17:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){if(n){o(!0);var e=setTimeout((function(){o(!1)}),5e3);return function(){return clearTimeout(e)}}o(!1)}),[n]),(0,ow.jsxs)(TE,{children:[(0,ow.jsx)(NE,{children:(0,ow.jsx)("h1",{children:"Login"})}),(0,ow.jsxs)(RE,{children:[(0,ow.jsx)(Be,{to:"/about",children:(0,ow.jsx)(AE,{children:"notox"})}),(0,ow.jsxs)(OE,{onSubmit:h,children:[(0,ow.jsx)(DE,{type:"email",id:"email",name:"email",placeholder:"Email",value:"abc@gmail.com",disabled:!0}),(0,ow.jsx)(DE,{type:"password",id:"password",name:"password",placeholder:"Password",value:"NF6QwyxSe9s83v7",disabled:!0}),(0,ow.jsx)("button",{disabled:c,children:c?"Logging you in...":"Log in with test account"})]}),(0,ow.jsx)(ME,{children:i&&(0,ow.jsx)(FE,{children:"Something went wrong."})}),(0,ow.jsxs)(LE,{children:[(0,ow.jsx)(Be,{to:"/register",children:(0,ow.jsx)(kw,{})}),(0,ow.jsx)("a",{href:"https://gmlunesa.com",target:"_blank",rel:"noreferrer",children:(0,ow.jsx)(yw,{})})]})]})]})},LS="768px",BS="1024px",US={mobile:"(max-width: ".concat("480px",")"),tablet:"(max-width: ".concat(LS,")"),laptop:"(min-width: ".concat(BS,")")},VS=_E.div(jE||(jE=Ew(["\n  flex: 1;\n  border-right: none;\n  background-color: var(--emerald-800);\n\n  @media screen and (",") {\n    max-width: 20%;\n  }\n\n  @media screen and (",") {\n    max-width: 20%;\n  }\n"])),US.laptop,US.mobile),zS=_E.div(WE||(WE=Ew(["\n  display: flex;\n  align-items: center;\n  background-color: var(--emerald-900);\n  color: var(--slate-50);\n  height: 3rem;\n  padding: 0.5rem;\n  justify-content: space-between;\n"]))),jS=_E.span(HE||(HE=Ew(["\n  font-family: var(--work-sans);\n  font-weight: 700;\n\n  &:hover {\n    color: var(--emerald-100);\n    cursor: none;\n  }\n"]))),WS=_E.a(qE||(qE=Ew(["\n  background-color: transparent;\n  color: white;\n  font-size: medium;\n  border: none;\n  border-radius: 4px;\n  padding: 0.3rem;\n  cursor: pointer;\n\n  @media screen and (",") {\n    display: none;\n  }\n\n  :hover {\n    color: yellow;\n  }\n"])),US.mobile),HS=_E.div(GE||(GE=Ew(["\n  &.chatList {\n    height: calc(100% - 10rem);\n    overflow: scroll;\n    /* Firefox */\n    scrollbar-width: none;\n    /* IE 10+ */\n    -ms-overflow-style: none;\n\n    &::-webkit-scrollbar {\n      background: transparent;\n      /* Chrome/Safari/Webkit */\n      width: 0px;\n    }\n  }\n"]))),qS=_E.div(KE||(KE=Ew([""]))),GS=_E.input(XE||(XE=Ew(["\n  padding: 0.5rem;\n  background-color: transparent;\n  color: white;\n  border: none;\n  outline: none;\n\n  ::placeholder {\n    /* Chrome, Firefox, Opera, Safari 10.1+ */\n    color: var(--slate-400);\n    opacity: 1; /* Firefox */\n  }\n\n  :-ms-input-placeholder {\n    /* Internet Explorer 10-11 */\n    color: var(--slate-400);\n  }\n\n  ::-ms-input-placeholder {\n    /* Microsoft Edge */\n    color: var(--slate-400);\n  }\n"]))),KS=_E.div($E||($E=Ew(["\n  padding: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  color: white;\n  cursor: pointer;\n\n  @media screen and (",") {\n    justify-content: center;\n  }\n\n  &:hover {\n    background-color: var(--emerald-700);\n    transition: 0.3s;\n  }\n\n  &.currentThread {\n    background-color: var(--emerald-900);\n  }\n"])),US.mobile),XS=_E.img(QE||(QE=Ew(["\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  object-fit: cover;\n"]))),$S=_E.div(YE||(YE=Ew(["\n  @media screen and (",") {\n    display: none;\n  }\n"])),US.mobile),QS=_E.span(JE||(JE=Ew(["\n  font-size: medium;\n  font-weight: 500;\n"]))),YS=_E.p(ZE||(ZE=Ew(["\n  font-size: small;\n  color: var(--slate-300);\n  margin: 0.1rem 0;\n"]))),JS=_E.div(eS||(eS=Ew(["\n  display: flex;\n  align-items: center;\n  background-color: var(--emerald-900);\n  color: var(--slate-50);\n  height: 3rem;\n  padding: 0.5rem;\n  justify-content: space-between;\n\n  @media screen and (",") {\n    justify-content: center;\n  }\n"])),US.mobile),ZS=_E.div(tS||(tS=Ew(["\n  display: flex;\n  gap: 0.5rem;\n  align-items: center;\n"]))),eC=_E.img(nS||(nS=Ew(["\n  background-color: var(--slate-100);\n  height: 24px;\n  width: 24px;\n  border-radius: 50%;\n  object-fit: cover;\n\n  @media screen and (",") {\n    display: none;\n  }\n"])),US.mobile),tC=_E.span(rS||(rS=Ew(["\n  @media screen and (",") {\n    display: none;\n  }\n"])),US.mobile),nC=_E.button(aS||(aS=Ew(["\n  background-color: var(--emerald-700);\n  color: white;\n  font-size: small;\n  border: none;\n  border-radius: 4px;\n  padding: 0.3rem;\n  cursor: pointer;\n\n  :hover {\n    background-color: var(--emerald-600);\n  }\n"]))),rC=function(){return(0,ow.jsxs)(zS,{children:[(0,ow.jsx)(jS,{children:"notox"}),(0,ow.jsx)(WS,{href:"https://github.com/gmlunesa",target:"_blank",children:(0,ow.jsx)(ww,{})})]})},aC=(0,t.createContext)(),iC=function(e){var n=e.children,r=(0,t.useContext)(sw).currentUser,a=(0,t.useReducer)((function(e,t){if("SELECT_FRIEND"===t.type){var n=r.uid>t.payload.uid?r.uid+t.payload.uid:t.payload.uid+r.uid;return{user:t.payload,threadId:n}}return e}),{threadId:"null",user:{}}),i=s(a,2),o=i[0],u=i[1];return(0,ow.jsx)(aC.Provider,{value:{data:o,dispatch:u},children:n})},oC=function(){var e=s((0,t.useState)(""),2),n=e[0],r=e[1],a=s((0,t.useState)(null),2),i=a[0],o=a[1],u=s((0,t.useState)(!1),2),c=(u[0],u[1]),l=(0,t.useContext)(sw).currentUser,f=(0,t.useContext)(aC).dispatch,h=function(){var e=Ge(He().mark((function e(){var t,r;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Db(iw,"users"),r=Px(t,Fx("displayName","==",n)),e.prev=2,e.next=5,$x(r);case 5:e.sent.forEach((function(e){o(e.data())})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),c(!0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Ge(He().mark((function e(){var t,n,a;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.uid>i.uid?l.uid+i.uid:i.uid+l.uid,e.prev=1,e.next=4,Kx(Pb(iw,"threads",t));case 4:if(e.sent.exists()){e.next=13;break}return e.next=8,Qx(Pb(iw,"threads",t),{messages:[]});case 8:return e.next=10,Yx(Pb(iw,"chats",l.uid),(Ke(n={},t+".userInfo",{uid:i.uid,displayName:i.displayName,photoURL:i.photoURL}),Ke(n,t+".date",tw()),n));case 10:return e.next=12,Yx(Pb(iw,"chats",i.uid),(Ke(a={},t+".userInfo",{uid:l.uid,displayName:l.displayName,photoURL:l.photoURL}),Ke(a,t+".date",tw()),a));case 12:f({type:"SELECT_FRIEND",payload:i});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),c(!0);case 18:o(null),r("");case 20:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(){return e.apply(this,arguments)}}();return(0,ow.jsxs)(HS,{children:[(0,ow.jsx)(qS,{children:(0,ow.jsx)(GS,{type:"text",placeholder:"Search",value:n,onKeyDown:function(e){"Enter"===e.code&&h()},onChange:function(e){o(null),r(e.target.value)}})}),i&&(0,ow.jsxs)(KS,{onClick:d,children:[(0,ow.jsx)(XS,{src:i.photoURL,alt:"Search result avatar"}),(0,ow.jsx)($S,{children:(0,ow.jsx)(QS,{children:i.displayName})})]})]})},sC=function(){var e,n=s((0,t.useState)([]),2),r=n[0],a=n[1],i=(0,t.useContext)(sw).currentUser,o=(0,t.useContext)(aC),u=o.dispatch,c=o.data,l=function(e){return!e||e.length<=30?e:"".concat(e.substr(0,e.lastIndexOf(" ",30)),"...")};(0,t.useEffect)((function(){i.uid&&function(){var e=Jx(Pb(iw,"chats",i.uid),(function(e){a(e.data())}))}()}),[i.uid]);return(0,ow.jsx)(HS,{className:"chatList",children:null===(e=Object.entries(r))||void 0===e?void 0:e.sort((function(e,t){return t[1].date-e[1].date})).map((function(e){var t,n;return(0,ow.jsxs)(KS,{onClick:function(){return t=e[1].userInfo,void u({type:"SELECT_FRIEND",payload:t});var t},className:(null===(t=c.user)||void 0===t?void 0:t.uid)===e[1].userInfo.uid?"currentThread":"",children:[(0,ow.jsx)(XS,{src:e[1].userInfo.photoURL,alt:"Friend avatar"}),(0,ow.jsxs)($S,{children:[(0,ow.jsx)(QS,{children:e[1].userInfo.displayName}),(0,ow.jsx)(YS,{children:l(null===(n=e[1].lastMessage)||void 0===n?void 0:n.text)})]})]},e[0])}))})},uC=function(){var e=(0,t.useContext)(sw).currentUser;return(0,ow.jsxs)(JS,{children:[(0,ow.jsxs)(ZS,{children:[(0,ow.jsx)(eC,{src:e.photoURL,alt:"Your avatar"}),(0,ow.jsx)(tC,{children:e.displayName})]}),(0,ow.jsx)(nC,{onClick:function(){return function(e){return bt(e).signOut()}(rw)},children:"Logout"})]})},cC=function(){return(0,ow.jsxs)(VS,{children:[(0,ow.jsx)(rC,{}),(0,ow.jsx)(oC,{}),(0,ow.jsx)(sC,{}),(0,ow.jsx)(uC,{})]})},lC=_E.div(iS||(iS=Ew(["\n  flex: 2;\n"]))),fC=_E.div(oS||(oS=Ew(["\n  display: flex;\n  align-items: center;\n  background-color: var(--emerald-600);\n  color: var(--slate-50);\n  height: 3rem;\n  padding: 0.5rem 1rem;\n  justify-content: space-between;\n"]))),hC=_E.span(sS||(sS=Ew(["\n  color: var(--slate-100);\n  font-weight: bold;\n"]))),dC=_E.div(uS||(uS=Ew(["\n  background-color: var(--emerald-50);\n  padding: 0.5rem 1rem;\n  height: calc(100% - 9rem);\n  overflow: scroll;\n\n  // Firefox\n  scrollbar-width: none;\n  // IE 10+\n  -ms-overflow-style: none;\n\n  &::-webkit-scrollbar {\n    background: transparent;\n    // Chrome/Safari/Webkit\n    width: 0px;\n  }\n\n  &.empty {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    gap: 1rem;\n\n    svg {\n      width: 6rem;\n    }\n  }\n"]))),pC=_E.div(cS||(cS=Ew(["\n  display: flex;\n  gap: 0.5rem;\n  align-items: center;\n\n  &.user {\n    flex-direction: row-reverse;\n  }\n"]))),vC=_E.div(lS||(lS=Ew([""]))),mC=_E.img(fS||(fS=Ew(["\n  width: 2rem;\n  height: 30px;\n  border-radius: 50%;\n  object-fit: cover;\n\n  @media screen and (",") {\n    display: none;\n  }\n"])),US.mobile),gC=_E.div(hS||(hS=Ew(["\n  max-width: 80%;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n\n  &.user {\n    align-items: flex-end;\n  }\n"]))),yC=_E.div(dS||(dS=Ew(["\n  background-color: var(--slate-200);\n  padding: 0.6rem 0.8rem;\n  margin: 0.5rem 0;\n  border-radius: 10px 10px 10px 0px;\n  max-width: max-content;\n  font-size: small;\n  display: flex;\n  flex-direction: column;\n\n  &.user {\n    background-color: var(--emerald-100);\n    border-radius: 10px 10px 0px 10px;\n  }\n"]))),bC=_E.span(pS||(pS=Ew(["\n  margin-top: 10px;\n  color: var(--slate-500);\n  font-size: smaller;\n  font-style: italic;\n"]))),xC=_E.div(vS||(vS=Ew(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 3rem;\n  background-color: var(--slate-50);\n  padding: 0.5rem 0.5rem;\n\n  &.empty {\n    display: none;\n  }\n\n  button {\n    margin-left: 0.5rem;\n  }\n"]))),wC=_E.input(mS||(mS=Ew(["\n  width: 100%;\n  border: none;\n  outline: none;\n  background-color: transparent;\n  color: var(--slate-700);\n  font-size: medium;\n"]))),kC=_E.button(gS||(gS=Ew(["\n  background-color: maroon;\n  font-weight: normal;\n"]))),EC=function(e){var n=e.message,r=(0,t.useContext)(sw).currentUser,a=(0,t.useContext)(aC).data,i=(0,t.useRef)();(0,t.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]);return(0,ow.jsxs)(pC,{ref:i,className:"".concat(n.senderId===r.uid&&"user"),children:[(0,ow.jsx)(vC,{children:(0,ow.jsx)(mC,{src:n.senderId===r.uid?r.photoURL:a.user.photoURL,alt:"Avatar"})}),(0,ow.jsx)(gC,{className:"".concat(n.senderId===r.uid&&"user"),children:(0,ow.jsxs)(yC,{className:"".concat(n.senderId===r.uid&&"user"),children:[n.text,(0,ow.jsx)(bC,{children:function(){var e=n.date,t=new Date(1e3*e.seconds+e.nanoseconds/1e4),r=new Date;return r.toLocaleDateString()===t.toLocaleDateString()?Number(t)>=Number(r)?"Just now":t.toLocaleTimeString():t.toLocaleDateString()}()})]})})]})},SC=["title","titleId"];function CC(){return CC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CC.apply(this,arguments)}function IC(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function _C(e,n){var r=e.title,a=e.titleId,i=IC(e,SC);return t.createElement("svg",CC({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 511.999 511.999",style:{enableBackground:"new 0 0 511.999 511.999"},xmlSpace:"preserve",ref:n,"aria-labelledby":a},i),r?t.createElement("title",{id:a},r):null,yS||(yS=t.createElement("g",null,t.createElement("g",null,t.createElement("g",null,t.createElement("path",{d:"M314.11,201.375c-4.616,0-7.336,2.555-7.336,8.243v21.842c0,5.686,2.72,8.241,7.336,8.241 c4.616,0,7.417-2.555,7.417-8.241v-21.842C321.526,203.93,318.726,201.375,314.11,201.375z"}),t.createElement("path",{d:"M466.467,86.617h-13.699c0-37.217-26.023-57.957-53.664-57.957c-27.268,0-53.664,20.322-53.664,57.957h-178.88 c0-37.217-26.023-57.957-53.664-57.957c-27.268,0-53.664,20.322-53.664,57.957h-13.7C20.426,86.617,0,107.043,0,132.15v185.046 c0,25.107,20.426,45.533,45.533,45.533h13.699v101.096c0,10.777,8.737,19.514,19.514,19.514h68.299 c10.777,0,19.514-8.737,19.514-19.514V362.729h178.88v101.096c0,10.777,8.737,19.514,19.514,19.514h68.299 c10.777,0,19.514-8.737,19.514-19.514V362.729h13.699c25.107,0,45.533-20.426,45.533-45.533V132.15 C512,107.043,491.573,86.617,466.467,86.617z M127.531,86.617H98.26C98.26,61.299,127.531,60.954,127.531,86.617z  M127.531,444.311H98.26v-81.582h29.271V444.311z M132.934,196.349l-16.401,50.276c-2.036,5.935-15.559,5.491-16.815,0 l-4.285-19.534l-4.287,19.534c-1.274,5.569-14.975,5.854-16.813,0l-16.402-50.276c-1.698-5.081,10.836-8.843,12.281-3.791 L82.74,234.84l6.511-27.858c0.998-4.493,11.366-4.49,12.363,0l6.511,27.858l12.528-42.282 C122.091,187.518,134.612,191.248,132.934,196.349z M169.617,215.305c5.083,0,5.24,9.891,0,9.891h-12.363v14.012h22.089 c5.096,0,5.255,11.209,0,11.209h-29.341c-2.802,0-5.606-1.319-5.606-3.956v-52.337c0-2.637,2.802-3.956,5.606-3.956h29.341 c5.258,0,5.093,11.209,0,11.209h-22.089v13.928H169.617z M227.066,250.416h-26.045c-2.802,0-5.606-1.319-5.606-3.956v-52.42 c0-2.72,3.215-3.873,6.428-3.873c3.216,0,6.429,1.154,6.429,3.873v45.166h18.791 C232.013,239.207,232.013,250.416,227.066,250.416z M261.357,239.701c6.593,0,7.007-5.027,7.253-8.242 c0.247-3.049,3.051-3.874,6.347-3.874c4.451,0,6.511,1.154,6.511,6.1c0,21.775-40.468,25.498-40.468-2.225v-21.841 c0-27.784,40.468-23.656,40.468-3.049c0,4.945-2.061,6.099-6.428,6.099c-3.462,0-6.265-0.907-6.429-3.873 c-0.083-2.143-0.329-7.418-7.335-7.418c-4.698,0-7.418,2.637-7.418,8.243v21.841 C253.857,237.064,256.577,239.701,261.357,239.701z M334.385,231.46c0,14.175-8.902,19.45-20.275,19.45 c-11.374,0-20.195-5.275-20.195-19.45v-21.842c0-14.176,8.819-19.452,20.195-19.452c11.373,0,20.275,5.275,20.275,19.452V231.46z  M369.912,229.07l-7.829-14.342v31.733c0,5.275-12.859,5.275-12.859,0v-49.865c0-4.698,3.215-6.428,6.429-6.428 c4.614,0,6.593,0.494,9.972,6.428l8.49,14.836l8.489-14.836c3.38-5.935,5.356-6.428,9.973-6.428c3.295,0,6.428,1.732,6.428,6.428 v49.865c0,5.275-12.859,5.275-12.859,0v-30.908l-7.912,13.517C376.395,232.186,371.644,232.39,369.912,229.07z M413.739,444.311 h-29.271v-81.582h29.271V444.311z M384.467,86.617c0-25.318,29.271-25.662,29.271,0H384.467z M439.726,215.305 c5.083,0,5.24,9.891,0,9.891h-12.363v14.012h22.089c5.096,0,5.254,11.209,0,11.209h-29.341c-2.802,0-5.606-1.319-5.606-3.956 v-52.337c0-2.637,2.802-3.956,5.606-3.956h29.341c5.256,0,5.096,11.209,0,11.209h-22.089v13.928H439.726z"}))))),bS||(bS=t.createElement("g",null)),xS||(xS=t.createElement("g",null)),wS||(wS=t.createElement("g",null)),kS||(kS=t.createElement("g",null)),ES||(ES=t.createElement("g",null)),SS||(SS=t.createElement("g",null)),CS||(CS=t.createElement("g",null)),IS||(IS=t.createElement("g",null)),_S||(_S=t.createElement("g",null)),TS||(TS=t.createElement("g",null)),NS||(NS=t.createElement("g",null)),RS||(RS=t.createElement("g",null)),AS||(AS=t.createElement("g",null)),OS||(OS=t.createElement("g",null)),DS||(DS=t.createElement("g",null)))}var TC,NC=t.forwardRef(_C),RC=(n.p,function(){var e=s((0,t.useState)([]),2),n=e[0],r=e[1],a=(0,t.useContext)(aC).data;return(0,t.useEffect)((function(){var e=Jx(Pb(iw,"threads",a.threadId),(function(e){e.exists()&&r(e.data().messages)}));return function(){e()}}),[a.threadId]),(0,ow.jsx)(dC,{className:"null"===a.threadId&&"empty",children:"null"===a.threadId?(0,ow.jsxs)(ow.Fragment,{children:[(0,ow.jsx)(NC,{fill:"#064E3B"}),"Start or continue a chat with a friend now!"]}):n.map((function(e){return(0,ow.jsx)(EC,{message:e},e.id)}))})}),AC=new Uint8Array(16);function OC(){if(!TC&&!(TC="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return TC(AC)}var DC=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var PC=function(e){return"string"===typeof e&&DC.test(e)},MC=[],FC=0;FC<256;++FC)MC.push((FC+256).toString(16).substr(1));var LC=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(MC[e[t+0]]+MC[e[t+1]]+MC[e[t+2]]+MC[e[t+3]]+"-"+MC[e[t+4]]+MC[e[t+5]]+"-"+MC[e[t+6]]+MC[e[t+7]]+"-"+MC[e[t+8]]+MC[e[t+9]]+"-"+MC[e[t+10]]+MC[e[t+11]]+MC[e[t+12]]+MC[e[t+13]]+MC[e[t+14]]+MC[e[t+15]]).toLowerCase();if(!PC(n))throw TypeError("Stringified UUID is invalid");return n};var BC=function(e,t,n){var r=(e=e||{}).random||(e.rng||OC)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return LC(r)},UC=function(e,t){return(UC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function VC(e,t){function n(){this.constructor=e}UC(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function zC(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function jC(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var WC=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return HC(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,a)}))}},e}();function HC(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function qC(){return GC}var GC=null,KC=new Map,XC=new Map;function $C(e,t){var n=eI(e,t);return KC.get(n)}function QC(e){return XC.get(e)}function YC(e){for(var t=KC.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===e&&n.push(s)}return n}function JC(e){var t=e.kernelName,n=e.backendName,r=eI(t,n);if(KC.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");KC.set(r,e)}function ZC(e){var t=e.kernelName;XC.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),XC.set(t,e)}function eI(e,t){return t+"_"+e}function tI(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function nI(e,t,n){return Math.max(e,Math.min(t,n))}function rI(e){return e%2==0?e:e+1}function aI(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function iI(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function oI(e,t,n){void 0===n&&(n=""),iI(lI(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function sI(e){iI(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function uI(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||SI(e)&&!n)for(var r=0;r<e.length;++r)uI(e[r],t,n);else t.push(e);return t}function cI(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function lI(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function fI(e){return e%1==0}function hI(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function dI(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function pI(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function vI(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function mI(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function gI(e,t){var n=t.length;return iI((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),iI(e.every((function(e){return fI(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function yI(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:gI(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function bI(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function xI(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function wI(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function kI(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function EI(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function SI(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function CI(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function II(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function _I(e){return"string"==typeof e||e instanceof String}function TI(e){return"boolean"==typeof e}function NI(e){return"number"==typeof e}function RI(e){return Array.isArray(e)?RI(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":NI(e)?"float32":_I(e)?"string":TI(e)?"bool":"float32"}function AI(e){return!!(e&&e.constructor&&e.call&&e.apply)}function OI(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function DI(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function PI(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=uI(e)),n&&wI(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)0!==Math.round(e[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function MI(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else{i=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(o=0;o<i;o++)a[o]=e(t+o*u,s,r)}return a}(0,e,t)}function FI(e,t){for(var n=LI(e,t),r=0;r<n.length;r++)n[r]=1;return n}function LI(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function BI(){return qC().platform.now()}function UI(e){e.forEach((function(t){iI(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function VI(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",qC().platform.encode(e,t)}function zI(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",qC().platform.decode(e,t)}function jI(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function WI(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}var HI=Object.freeze({shuffle:tI,clamp:nI,nearestLargerEven:rI,sum:aI,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n},assert:iI,assertShapesMatch:oI,assertNonNull:sI,flatten:uI,sizeFromShape:cI,isScalarShape:function(e){return 0===e.length},arraysEqual:lI,isInt:fI,tanh:hI,sizeToSquarishShape:dI,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return tI(t),t},rightPad:pI,repeatedTry:vI,inferFromImplicitShape:mI,parseAxisParam:gI,squeezeShape:yI,getTypedArrayFromDType:bI,getArrayFromDType:xI,checkConversionForErrors:wI,isValidDtype:kI,hasEncodingLoss:EI,isTypedArray:SI,bytesPerElement:CI,bytesFromStringArray:II,isString:_I,isBoolean:TI,isNumber:NI,inferDtype:RI,isFunction:AI,nearestDivisor:OI,computeStrides:DI,toTypedArray:PI,toNestedArray:MI,makeOnesTypedArray:FI,makeZerosTypedArray:LI,now:BI,assertNonNegativeIntegerDimensions:UI,fetch:function(e,t){return qC().platform.fetch(e,t)},encodeString:VI,decodeString:zI,locToIndex:jI,indexToLoc:WI}),qI=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new GI)}return e.prototype.profileKernel=function(e,t,n){var r,a=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(e,n,r,i.kernelMs,t,o)}))}))})),r},e}(),GI=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,a,i){var o="number"==typeof r?pI(r+"ms",9):r.error,s=pI(e,25),u=t.rank,c=t.size,l=pI(t.shape.toString(),14),f="";for(var h in a){var d=a[h].shape||t.shape,p=d.length;f+=h+": "+p+"D "+(p>0?d:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+f+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function KI(e,t,n){return pI(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":_I(e)?"'"+e+"'":"bool"===n?XI(e):parseFloat(e.toFixed(7)).toString(),t)}function XI(e){return 0===e?"false":"true"}function $I(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var QI=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=cI(e),null!=n){var a=n.length;iI(a===this.size,(function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||xI(t,this.size),this.strides=DI(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),iI(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var a=this.locToIndex(n);this.values[a]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,a=e;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return YI().makeTensor(this.values,this.shape,this.dtype)},e}(),YI=null,JI=null,ZI=null,e_=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=cI(e),this.strides=DI(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),iI(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),this.reshape([e,t,n,r,a])},e.prototype.asType=function(e){return this.throwIfDisposed(),JI.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,JI.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return JI.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,MI(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return MI(this.shape,this.dataSync())},e.prototype.data=function(){return zC(this,void 0,void 0,(function(){var e,t;return jC(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=YI().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return zI(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=YI().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return zI(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,YI().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(YI().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),JI.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),JI.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),JI.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),JI.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),JI.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),JI.clone(this)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var a=DI(t),i=function(e,t,n,r){var a=cI(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?$I(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,f=0;f<i;f++)o[f]=Math.max(o[f],KI(u[l+f],0,n).length);return o}(e,t,n,a),o=t.length,s=function e(t,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[KI($I(t)[0],0,r)]:"bool"===r?[XI(t[0])]:[t[0].toString()];if(1===c){if(u>20){var l=3*s,f=Array.from(t.slice(0,l)),h=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(f=$I(f),h=$I(h)),["["+f.map((function(e,t){return KI(e,i[t],r)})).join(", ")+", ..., "+h.map((function(e,t){return KI(e,i[u-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?$I(t):Array.from(t)).map((function(e,t){return KI(e,i[t],r)})).join(", ")+"]"]}var d=n.slice(1),p=a.slice(1),v=a[0]*s,m=[];if(u>20){for(var g=0;g<3;g++){var y=(b=g*v)+v;m.push.apply(m,e(t.slice(b,y),d,r,p,i,!1))}for(m.push("..."),g=u-3;g<u;g++)y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),d,r,p,i,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),d,r,p,i,g===u-1))}var x=2===c?",":"";for(m[0]="["+m[0]+x,g=1;g<m.length-1;g++)m[g]=" "+m[g]+x;var w=",\n";for(g=2;g<c;g++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(o?"":w),m}(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),JI.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),JI.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),JI.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),JI.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),JI.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),JI.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),JI.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),JI.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),JI.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),JI.unstack(this,e)},e.prototype.batchNormalization=function(e,t,n,r,a){return void 0===n&&(n=.001),ZI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,a,r,n)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),JI.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),JI.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),JI.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),JI.cast(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),JI.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),JI.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),JI.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),JI.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),JI.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),JI.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),JI.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),JI.mulStrict(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),JI.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),JI.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),JI.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),JI.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),JI.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),JI.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),JI.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),JI.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),JI.squaredDifferenceStrict(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),JI.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),JI.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),JI.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),JI.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),JI.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),JI.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),JI.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),JI.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),JI.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),JI.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),JI.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),JI.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),JI.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),JI.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),JI.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),JI.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),JI.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),JI.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),JI.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),JI.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),JI.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),JI.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),JI.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),JI.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),JI.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),JI.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),JI.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),JI.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),JI.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),JI.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),JI.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),JI.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),JI.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),JI.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),JI.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),JI.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),JI.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),JI.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),JI.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),JI.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),JI.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),JI.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),JI.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),JI.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),JI.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),JI.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),JI.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),JI.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),JI.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),JI.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),JI.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),JI.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),JI.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),JI.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),JI.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),JI.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),JI.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),JI.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),JI.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),JI.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),JI.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),JI.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),JI.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),JI.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),JI.conv1d(this,e,t,n,r,a,i)},e.prototype.conv2d=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),JI.conv2d(this,e,t,n,r,a,i)},e.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),JI.conv2dTranspose(this,e,t,n,r,a)},e.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),JI.depthwiseConv2d(this,e,t,n,r,a,i)},e.prototype.separableConv2d=function(e,t,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),JI.separableConv2d(this,e,t,n,r,a,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),JI.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),JI.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),JI.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),JI.pool(this,e,t,n,r,a)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),YI().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),JI.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),JI.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),JI.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),JI.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),JI.stridedSlice(this,e,t,n,r,a,i,o,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),JI.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),JI.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),JI.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),JI.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),JI.spectral.irfft(this)},e}();Object.defineProperty(e_,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var t_,n_,r_,a_,i_,o_=function(e){function t(t,n,r,a){var i=e.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=r,i}return VC(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!lI(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");YI().disposeTensor(this),this.dataId=e.dataId,YI().incRef(this,null)},t.prototype.dispose=function(){YI().disposeVariable(this),this.isDisposedInternal=!0},t}(e_);Object.defineProperty(o_,Symbol.hasInstance,{value:function(e){return e instanceof e_&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(t_||(t_={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(n_||(n_={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(r_||(r_={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(a_||(a_={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(i_||(i_={}));var s_={float32:a_,int32:n_,bool:r_,complex64:i_};function u_(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return s_[e][t]}function c_(e){return u_(e,"int32")}function l_(e,t){if(e.dtype===t.dtype)return[e,t];var n=u_(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function f_(e,t){iI(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function h_(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof e_)n.push(t);else if(a=t,Array.isArray(a)||"object"==typeof a){var a,i=t;for(var o in i){var s=i[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:l_,assertTypesMatch:f_,isTensorInList:function(e,t){return t.some((function(t){return t.id===e.id}))},getTensorsInContainer:h_});var d_,p_=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),v_=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new p_}return e.prototype.ready=function(){return zC(this,void 0,void 0,(function(){var e,t,n;return jC(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return zC(this,void 0,void 0,(function(){var t,n,r;return jC(this,(function(a){switch(a.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new qI(this.backendInstance),[2,!0]}}))}))},e.prototype.setupRegisteredKernels=function(){var e=this;YC(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))},e.prototype.disposeRegisteredKernels=function(e){var t=this;YC(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(a<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){return e.toFloat()}}}),[],{}),t},e.prototype.runKernel=function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,a,i,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,h=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var p,v=$C(r,this.backendName);if(null!=v)f=function(){var e=u.backend.numDataIds();p=v.kernelFunc({inputs:t,attrs:a,backend:u.backend});var n=Array.isArray(p)?p:[p];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)}));if(l){var f=u.getTensorsForGradient(r,t,s);if(null==f){null==o&&(o=[]);var h=s.filter((function(e,t){return o[t]}));f=(i||[]).slice().concat(h)}c=u.saveTensorsForBackwardMode(f)}return s};else{var m=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))};f=function(){var t=u.backend.numDataIds();p=u.tidy((function(){return e(u.backend,m)}));var n=Array.isArray(p)?p:[p];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return f()})):f()})),l&&this.addTapeNode(r,t,s,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(p)?s:s[0]},e.prototype.saveTensorsForBackwardMode=function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))},e.prototype.getTensorsForGradient=function(e,t,n){var r=QC(e);if(null!=r){var a=r.inputsToSave||[],i=r.outputsToSave||[],o=void 0;r.saveAllInputs?(iI(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(t).map((function(e){return t[e]}))):o=a.map((function(e){return t[e]}));var s=n.filter((function(e,t){return i[t]}));return o.concat(s)}return null},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&_I(e[0])&&(a=e.map((function(e){return VI(e)})));var i=r.write(a,t,n),o=new e_(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=II(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},e.prototype.makeTensorFromDataId=function(e,t,n,r){var a=new e_(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var a=new o_(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*CI(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof o_||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return zC(this,void 0,void 0,(function(){var t,n;return jC(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=QC(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=LI(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=h_(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var a=this;if(void 0===r&&(r=!1),iI(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));iI(i instanceof e_,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var o=(p=e[i]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<t.length;l++)if(r[u.id]){p.outputs.forEach((function(e){return r[e.id]=!0})),c=!0,a[p.id]=!0;break}if(c)break}}var f={};f[n.id]=!0;var h={};for(i=e.length-1;i>=0;i--)for(o=(p=e[i]).inputs,l=0;l<p.outputs.length;l++)if(f[p.outputs[l].id]){for(var s in o)f[o[s].id]=!0,h[p.id]=!0;break}var d=[];for(i=0;i<e.length;i++){var p;if(a[(p=e[i]).id]&&h[p.id]){var v={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},p);g.inputs=v,g.outputs=p.outputs,d.push(g)}}return d}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[i.id]=null==n?(r=FI(cI(e=i.shape),"float32"),m_.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var a=t[r],i=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.kernelName+".");var o=a.gradient(i),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[t];if(!lI(r.shape,i.shape))throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var u in a.inputs)s(u)},a=t.length-1;a>=0;a--)r(a)}(s,o,(function(e){return a.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()})),a.state.activeTape=null),{value:i,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return iI(AI(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];iI(r.every((function(e){return e instanceof e_})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,a){return iI((n=e.apply(void 0,r.concat([a]))).value instanceof e_,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),iI(AI(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(e,t){var a=n.gradFunc(e,t),i=Array.isArray(a)?a:[a];iI(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),iI(i.every((function(e){return e instanceof e_})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return i.forEach((function(e,t){o[t]=function(){return e}})),o}))}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return zC(this,void 0,void 0,(function(){var t,n;return jC(this,(function(r){switch(r.label){case 0:return t=BI(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=BI()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new p_,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),m_=function(){var e=function(){if(null==d_){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}d_=e}return d_}();if(null==e._tfengine){var t=new WC(e);e._tfengine=new v_(t)}return function(e){GC=e}(e._tfengine.ENV),YI=function(){return e._tfengine},e._tfengine}();function g_(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var y_=qC();y_.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),y_.registerFlag("IS_BROWSER",(function(){return g_()})),y_.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),y_.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),y_.registerFlag("PROD",(function(){return!1})),y_.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return y_.getBool("DEBUG")})),y_.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),y_.registerFlag("IS_TEST",(function(){return!1}));var b_,x_,w_,k_={},E_={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function S_(e,t){k_[e]=t}function C_(e){e in k_||(k_[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete k_[e]}),!1),1===e?t.getContext("webgl",E_)||t.getContext("experimental-webgl",E_):t.getContext("webgl2",E_)}(e));var t=k_[e];return t.isContextLost()?(delete k_[e],C_(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),k_[e])}function I_(e,t){return[t,e]}function __(e){var t=cI(e);return dI(Math.ceil(t/4))}function T_(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function N_(e,t){var n,r,a,i,o,s,u,c,l,f=e;return 2===qC().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,i=f.RGBA32F,o=f.RED,s=4,u=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=f.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function R_(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+O_(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(b_||(b_={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(x_||(x_={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(w_||(w_={}));function A_(e){return!!(qC().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function O_(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function D_(e,t,n){return nT(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function P_(e,t,n){var r=nT(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(R_(e,t,(function(){return e.shaderSource(r,n)})),R_(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function M_(e,t,n){var r=nT(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(R_(e,t,(function(){return e.shaderSource(r,n)})),R_(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=B_.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return pI((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+pI(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var F_,L_,B_=/ERROR: [0-9]+:([0-9]+):/g;function U_(e,t){return nT(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function V_(e,t,n){if(R_(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function z_(e,t,n){if(R_(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function j_(e,t,n){var r=nT(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return R_(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),R_(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function W_(e,t,n){var r=nT(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return R_(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),R_(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function H_(e,t){return nT(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function q_(e,t){var n=qC().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function G_(e,t){return nT(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function K_(e,t,n,r,a,i,o,s){var u=e.getAttribLocation(n,r);return-1!==u&&(R_(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,a)})),R_(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,o,s)})),R_(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function X_(e,t,n,r){rT(e,r),R_(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function $_(e,t,n,r){return nT(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function Q_(e,t,n){return e.getUniformLocation(t,n)}function Y_(e,t,n,r,a,i){R_(e,t,(function(){return X_(e,t,r,i)})),R_(e,t,(function(){return e.uniform1i(a,i)}))}function J_(e,t,n,r){R_(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),R_(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function Z_(e,t,n){R_(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),R_(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function eT(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+tT(e,t))}function tT(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function nT(e,t,n,r){var a=R_(e,t,(function(){return n()}));if(null==a)throw new Error(r);return a}function rT(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function aT(e,t){return void 0===t&&(t=2),cI(e.slice(0,e.length-t))}function iT(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function oT(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[aT(e)].concat(iT(e))),t}function sT(e,t){var n;void 0===t&&(t=!1);var r=qC().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?rI(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=yI(e);e=a.newShape}var i=cI(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=aT(e),s=2,u=2;return e.length&&(s=(n=iT(e))[0],u=n[1]),dI(i=o*(s/2)*(u/2)).map((function(e){return 2*e}))}return dI(i)}function uT(e){return e%2==0}function cT(e,t){if(lI(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(uT(n)&&uT(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&uT(e[0])&&uT(t[0])}function lT(e){if(null==F_){var t=C_(e);F_=t.getParameter(t.MAX_TEXTURE_SIZE)}return F_}function fT(e){if(null==L_){var t=C_(e);L_=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,L_)}function hT(e){if(0===e)return 0;var t=C_(e);return dT(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:dT(t,"EXT_disjoint_timer_query")?1:0}function dT(e,t){return null!=e.getExtension(t)}function pT(e){try{if(null!=C_(e))return!0}catch(e){return!1}return!1}function vT(e){if(0===e)return!1;var t=C_(e);if(1===e){if(!dT(t,"OES_texture_float"))return!1}else if(!dT(t,"EXT_color_buffer_float"))return!1;return gT(t)}function mT(e){if(0===e)return!1;var t=C_(e);if(1!==e){if(dT(t,"EXT_color_buffer_float"))return gT(t);if(dT(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=N_(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!dT(t,"OES_texture_float")&&!!dT(t,"WEBGL_color_buffer_float")&&gT(t)}function gT(e){var t=N_(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function yT(e){return 2===e&&null!=C_(e).fenceSync}var bT=Object.freeze({callAndCheck:R_,canBeRepresented:A_,getWebGLErrorMessage:O_,getExtensionOrThrow:D_,createVertexShader:P_,createFragmentShader:M_,createProgram:U_,linkProgram:V_,validateProgram:z_,createStaticVertexBuffer:j_,createStaticIndexBuffer:W_,getNumChannels:function(){return 2===qC().getNumber("WEBGL_VERSION")?1:4},createTexture:H_,validateTextureSize:q_,createFramebuffer:G_,bindVertexBufferToProgramAttribute:K_,bindTextureUnit:X_,unbindTextureUnit:function(e,t,n){rT(e,n),R_(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:$_,getProgramUniformLocation:Q_,bindTextureToProgramUniformSampler:Y_,bindCanvasToFramebuffer:function(e,t){R_(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),R_(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),R_(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:J_,unbindColorTextureFromFramebuffer:Z_,validateFramebuffer:eT,getFramebufferErrorMessage:tT,getBatchDim:aT,getRowsCols:iT,getShapeAs3D:oT,getTextureShapeFromLogicalShape:sT,isReshapeFree:cT,getWebGLMaxTextureSize:lT,resetMaxTextureSize:function(){F_=null},resetMaxTexturesInShader:function(){L_=null},getMaxTexturesInShader:fT,getWebGLDisjointQueryTimerVersion:hT,hasExtension:dT,isWebGLVersionEnabled:pT,isCapableOfRenderingToFloatTexture:vT,isDownloadFloatTextureEnabled:mT,isWebGLFenceEnabled:yT}),xT=qC();function wT(e){qC().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function kT(e,t){return m_.tidy(e,t)}function ET(e){h_(e).forEach((function(e){return e.dispose()}))}function ST(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];qC().getBool("IS_TEST")||console.warn.apply(console,e)}function CT(e,t){var n=e;if(SI(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||SI(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&qC().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||SI(t)){iI(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),iI(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else iI(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function IT(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function _T(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof e_)return IT(r,e.dtype,t,n),e;var a=RI(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),IT(r,a,t,n),null==e||!SI(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=CT(e,a);SI(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?PI(e,a,qC().getBool("DEBUG")):uI(e,[],!0);return m_.makeTensor(s,o,a)}function TT(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return _T(e,t+"["+r+"]",n)}),r)}function NT(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function RT(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function AT(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function OT(e,t){return RT(e,t.map((function(e){return 1})),t)}function DT(e,t,n){iI(NT(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function PT(e,t){if(NT(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function MT(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function FT(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function LT(e,t){var n=e[0].length;e.forEach((function(e,t){iI(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),iI(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)iI(i===t||e[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."}))}))}function BT(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function UT(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];m_.startScope(n);try{var a=r.apply(void 0,e);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),m_.endScope(a),a}catch(e){throw m_.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}xT.registerFlag("HAS_WEBGL",(function(){return xT.getNumber("WEBGL_VERSION")>0})),xT.registerFlag("WEBGL_VERSION",(function(){return pT(2)?2:pT(1)?1:0})),xT.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===xT.get("WEBGL_VERSION")})),xT.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),xT.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),xT.registerFlag("WEBGL_PACK",(function(){return xT.getBool("HAS_WEBGL")})),xT.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_CLIP",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),xT.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_PACK_REDUCE",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_CONV_IM2COL",(function(){return xT.getBool("WEBGL_PACK")})),xT.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return lT(xT.getNumber("WEBGL_VERSION"))})),xT.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return fT(xT.getNumber("WEBGL_VERSION"))})),xT.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=xT.getNumber("WEBGL_VERSION");return 0===e?0:hT(e)})),xT.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return xT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),xT.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return vT(xT.getNumber("WEBGL_VERSION"))})),xT.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!xT.getBool("WEBGL_FORCE_F16_TEXTURES")&&xT.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),xT.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return mT(xT.getNumber("WEBGL_VERSION"))})),xT.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return yT(xT.getNumber("WEBGL_VERSION"))})),xT.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return xT.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),ZI=wT;var VT=UT({complex_:function(e,t){var n=_T(e,"real","complex"),r=_T(t,"imag","complex");return oI(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),m_.runKernelFunc((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),zT=UT({real_:function(e){var t=_T(e,"input","real");return m_.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),jT=UT({imag_:function(e){var t=_T(e,"input","imag");return m_.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function WT(e,t,n){return HT(e,t,CT(e,n),n)}function HT(e,t,n,r){if(null==r&&(r=RI(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!SI(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){UI(t);var a=cI(t),i=cI(n);iI(a===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==cI(t.slice(o));iI(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return SI(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?PI(e,r,qC().getBool("DEBUG")):uI(e,[],!0),m_.makeTensor(e,t,r)}function qT(e,t){if((SI(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&SI(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return HT(e,[],[],t)}function GT(e,t){sI(e);var n=CT(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return HT(e,null,n,t)}function KT(e,t,n){if(sI(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=CT(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return HT(e,t,r,n)}function XT(e,t,n){if(sI(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=CT(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return HT(e,t,r,n)}function $T(e,t,n){if(sI(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=CT(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return HT(e,t,r,n)}function QT(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=QT(e,"float32"),r=YT(e,"float32");return VT(n,r)}var a=FI(cI(e),t);return m_.makeTensor(a,e,t)}function YT(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=YT(e,"float32"),r=YT(e,"float32");return VT(n,r)}var a=LI(cI(e),t);return m_.makeTensor(a,e,t)}function JT(e,t,n){return m_.runKernelFunc((function(r){return r.fill(e,t,n)}),{})}function ZT(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return m_.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})}function eN(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return YT([0],r);var a=LI(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return GT(a,r)}var tN=UT({onesLike_:function(e){var t=_T(e,"x","onesLike");if("complex64"===t.dtype){var n=tN(zT(t)),r=nN(jT(t));return VT(n,r)}return m_.runKernelFunc((function(e){return e.onesLike(t)}),{x:t},(function(e,t){return{x:function(){return nN(e)}}}),"OnesLike")}}),nN=UT({zerosLike_:function(e){var t=_T(e,"x","zerosLike");return m_.runKernelFunc((function(e){return e.zerosLike(t)}),{x:t},(function(e,t){return{x:function(){return nN(e)}}}),"ZerosLike")}}),rN=UT({concat_:function(e,t){void 0===t&&(t=0),iI(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=TT(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=gI(t,n[0].shape)[0];var r=BT(n.map((function(e){return e.shape})),t);if(0===cI(r))return WT([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var a=n.map((function(e){return e.shape}));LT(a,t);var i=n,o={axis:t};return m_.runKernelFunc((function(e){return e.concat(n,t)}),i,(function(e){var n=a.map((function(e){return e[t]}));return uN(e,n,t).map((function(e){return function(){return e}}))}),"Concat",o)}}),aN=UT({concat1d_:function(e){return rN(e,0)}}),iN=UT({concat2d_:function(e,t){return rN(e,t)}}),oN=UT({concat3d_:function(e,t){return rN(e,t)}}),sN=UT({concat4d_:function(e,t){return rN(e,t)}}),uN=UT({split_:function(e,t,n){void 0===n&&(n=0);var r,a=_T(e,"x","split");return n=gI(n,a.shape)[0],"number"==typeof t?(iI(a.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(a.shape[n]/t)):(iI(a.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),m_.runKernelFunc((function(e){return e.split(a,r,n)}),{$x:a},(function(e){return{$x:function(){return rN(e,n)}}}))}});function cN(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",UI(e),new QI(e,t,n)}var lN=UT({batchToSpaceND_:function(e,t,n){var r=_T(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));return iI(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),iI(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),iI(r.shape[0]%a==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a})),m_.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),fN=UT({cast_:function(e,t){var n=_T(e,"x","cast");if(!kI(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return m_.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",r)}}),hN=UT({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=_T(e,"x","cumsum"),i=PT([t|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=FT(1,a.rank)[0],u=m_.runKernelFunc((function(e){return e.cumsum(o,s,n,r)}),{permutedX:o},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),dN=UT({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=_T(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return iI(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),iI(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),iI(o%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape})),m_.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),pN=UT({expandDims_:function(e,t){void 0===t&&(t=0);var n=_T(e,"x","expandDims",null);iI(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(iI(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),vN(n,r)}}),vN=UT({reshape_:function(e,t){var n=_T(e,"x","reshape",null);t=mI(t,n.size),iI(n.size===cI(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:t};return m_.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",r)}}),mN=UT({spaceToBatchND_:function(e,t,n){var r=_T(e,"x","spaceToBatchND");return iI(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),iI(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),iI(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),m_.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),gN=UT({squeeze_:function(e,t){var n=_T(e,"x","squeeze");return vN(n,yI(n.shape,t).newShape)}}),yN=UT({stack_:function(e,t){void 0===t&&(t=0);var n=TT(e,"tensors","stack");if(iI(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;iI(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){oI(a,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){iI(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(e){return e.expandDims(t)}));return rN(o,t)}}),bN=UT({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=_T(e,"x","unstack");iI(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length);var r={axis:t};return m_.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return yN(e,t)}}}),"Unpack",r)}}),xN=function(e,t){return zC(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,f;return jC(this,(function(h){switch(h.label){case 0:return n=_T(e,"x","setdiff1d"),r=_T(t,"y","setdiff1d"),iI(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),iI(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),iI(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return a=h.sent(),[4,r.data()];case 2:for(i=h.sent(),o=new Set(i),s=0,l=0;l<a.length;l++)o.has(a[l])||s++;for(u=new QI([s],n.dtype),c=new QI([s],"int32"),l=0,f=0;l<a.length;l++)o.has(a[l])||(u.values[f]=a[l],c.values[f]=l,f++);return[2,[u.toTensor(),c.toTensor()]]}}))}))};function wN(e,t,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function kN(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function EN(e,t,n,r){void 0===r&&(r=!0);var a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function SN(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function CN(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var IN="Div",_N="SquaredDifference",TN="BroadcastTo",NN="OneHot",RN="Identity",AN="Tile",ON="PadV2",DN=UT({add_:function(e,t){var n,r=_T(e,"a","add"),a=_T(t,"b","add");n=l_(r,a),r=n[0],a=n[1];var i={a:r,b:a};return m_.runKernelFunc((function(e,t){var n=e.add(r,a);return t([r,a]),n}),i,null,"Add")}});function PN(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function MN(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function FN(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}var LN=UT({abs_:function(e){var t=_T(e,"x","abs");return"complex64"===t.dtype?m_.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):m_.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),BN=UT({acos_:function(e){var t=_T(e,"x","acos");return m_.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(qT(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),UN=UT({acosh_:function(e){var t=_T(e,"x","acosh");return m_.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),VN=UT({asin_:function(e){var t=_T(e,"x","asin");return m_.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(qT(1).sub(n.toFloat().square()).sqrt())}}}))}}),zN=UT({asinh_:function(e){var t=_T(e,"x","asinh");return m_.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(qT(1).add(n.toFloat().square()).sqrt())}}}))}}),jN=UT({atan_:function(e){var t=_T(e,"x","atan");return m_.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),WN=UT({atanh_:function(e){var t=_T(e,"x","atanh");return m_.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(qT(1).sub(n.toFloat().square()))}}}))}}),HN=UT({ceil_:function(e){var t=_T(e,"x","ceil");return m_.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),qN=UT({clipByValue_:function(e,t,n){var r=_T(e,"x","clipByValue");iI(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}));var a=[r],i={min:t,max:n};return m_.runKernelFunc((function(e,a){var i=e.clip(r,t,n);return a([r]),i}),{x:r},(function(e,r){var a=r[0];return{x:function(){return e.where(a.greaterEqual(t).logicalAnd(a.lessEqual(n)),nN(e))}}}),"ClipByValue",i,a)}}),GN=UT({cos_:function(e){var t=_T(e,"x","cos"),n=[t];return m_.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},n)}}),KN=UT({cosh_:function(e){var t=_T(e,"x","cosh");return m_.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),XN=UT({erf_:function(e){var t=_T(e,"x","erf");return iI("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),m_.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),$N=UT({exp_:function(e){var t=_T(e,"x","exp");return m_.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mulStrict(t[0])}}}),"Exp",{},[],[!0])}}),QN=UT({expm1_:function(e){var t=_T(e,"x","expm1");return m_.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),YN=UT({floor_:function(e){var t=_T(e,"x","floor");return m_.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),JN=UT({log_:function(e){var t=_T(e,"x","log"),n=[t];return m_.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},n)}}),ZN=UT({log1p_:function(e){var t=_T(e,"x","log1p");return m_.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),eR=UT({logSigmoid_:function(e){var t=_T(e,"x","logSigmoid");return m_.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),tR=UT({neg_:function(e){var t=_T(e,"x","neg"),n=[t];return m_.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},n)}}),nR=UT({reciprocal_:function(e){var t=_T(e,"x","reciprocal");return m_.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),rR=UT({round_:function(e){var t=_T(e,"x","round");return m_.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),aR=UT({rsqrt_:function(e){var t=_T(e,"x","rsqrt"),n=[t];return m_.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),iR=UT({sigmoid_:function(e){var t=_T(e,"x","sigmoid");return m_.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(qT(1).sub(n)))}}}),"Sigmoid")}}),oR=UT({sign_:function(e){var t=_T(e,"x","sign");return m_.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),sR=UT({isNaN_:function(e){var t=_T(e,"x","isNaN");return m_.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),uR=UT({isInf_:function(e){var t=_T(e,"x","isInf");return m_.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),cR=UT({isFinite_:function(e){var t=_T(e,"x","isFinite");return m_.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return nN(e)}}}))}}),lR=UT({sin_:function(e){var t=_T(e,"x","sin"),n=[t];return m_.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},n)}}),fR=UT({sinh_:function(e){var t=_T(e,"x","sinh");return m_.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),hR=UT({softplus_:function(e){var t=_T(e,"x","softplus");return m_.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),dR=UT({sqrt_:function(e){var t=_T(e,"x","sqrt");return m_.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),pR=UT({step_:function(e,t){void 0===t&&(t=0);var n=_T(e,"x","step");return m_.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return nN(e)}}}))}}),vR=UT({tan_:function(e){var t=_T(e,"x","tan");return m_.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),mR=UT({tanh_:function(e){var t=_T(e,"x","tanh");return m_.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return qT(1).sub(n.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}}),gR=UT({addStrict_:function(e,t){var n=_T(e,"a","addStrict"),r=_T(t,"b","addStrict");return oI(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),yR=UT({atan2_:function(e,t){var n,r=_T(e,"a","atan2"),a=_T(t,"b","atan2");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape);return m_.runKernelFunc((function(e,t){var n=e.atan2(r,a);return t([r,a]),n}),{$a:r,$b:a},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=DN(n.square(),r.square()),a=e.mul(r.div(t)),o=MN(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var t=DN(n.square(),r.square()),a=tR(e.mul(n.div(t))),o=MN(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}))}}),bR=UT({divStrict_:function(e,t){var n=_T(e,"a","div"),r=_T(t,"b","div");return oI(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),xR=UT({floorDiv_:function(e,t){var n,r=_T(e,"a","floorDiv"),a=_T(t,"b","floorDiv");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape);return m_.runKernelFunc((function(e,t){var n=e.floorDiv(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=MN(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=MN(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}}),"FloorDiv")}}),wR=UT({maximum_:function(e,t){var n,r=_T(e,"a","maximum"),a=_T(t,"b","maximum");return n=l_(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),FN(r.shape,a.shape),m_.runKernelFunc((function(e,t){var n=e.maximum(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}}),"Maximum")}}),kR=UT({maximumStrict_:function(e,t){var n=_T(e,"a","maximumStrict"),r=_T(t,"b","maximumStrict");return oI(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),ER=UT({minimum_:function(e,t){var n,r=_T(e,"a","minimum"),a=_T(t,"b","minimum");return n=l_(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),FN(r.shape,a.shape),m_.runKernelFunc((function(e,t){var n=e.minimum(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}}),"Minimum")}}),SR=UT({minimumStrict_:function(e,t){var n=_T(e,"a","minimumStrict"),r=_T(t,"b","minimumStrict");return oI(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),CR=UT({mod_:function(e,t){var n,r=_T(e,"a","mod"),a=_T(t,"b","mod");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape);return m_.runKernelFunc((function(e,t){var n=e.mod(r,a);return t([r,a]),n}),{$a:r,$b:a},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=MN(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),a=MN(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}}))}}),IR=UT({modStrict_:function(e,t){var n=_T(e,"a","modStrict"),r=_T(t,"b","modStrict");return oI(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),_R=UT({mul_:function(e,t){var n,r=_T(e,"a","mul"),a=_T(t,"b","mul");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape);return m_.runKernelFunc((function(e,t){var n=e.multiply(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),a=MN(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=MN(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}}),"Mul")}}),TR=UT({mulStrict_:function(e,t){var n=_T(e,"a","mul"),r=_T(t,"b","mul");return oI(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),NR=UT({pow_:function(e,t){var n,r=_T(e,"base","pow"),a=_T(t,"exp","pow");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape),o=[r,a];return m_.runKernelFunc((function(e,t){var n=e.pow(r,a);return t([r,a,n]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1],a=t[2];return{a:function(){var t=r.toFloat(),a=e.mul(t.mul(n.pow(t.sub(qT(1))))),o=MN(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var t=n.greater(0),o=n.log().where(t,nN(n)),s=e.mul(a.mul(o)),u=MN(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},o,[!0])}}),RR=UT({powStrict_:function(e,t){return oI(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),AR=UT({squaredDifferenceStrict_:function(e,t){var n=_T(e,"a","squaredDifferenceStrict"),r=_T(t,"b","squaredDifferenceStrict");return oI(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),OR=UT({sub_:function(e,t){var n,r=_T(e,"a","sub"),a=_T(t,"b","sub");n=l_(r,a),r=n[0],a=n[1];var i=FN(r.shape,a.shape);return m_.runKernelFunc((function(e){return e.subtract(r,a)}),{a:r,b:a},(function(e){return{a:function(){var t=e,n=MN(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=MN(a.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(a.shape)}}}),"Sub")}}),DR=UT({subStrict_:function(e,t){var n=_T(e,"a","subStrict"),r=_T(t,"b","subStrict");return oI(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),PR=UT({div_:function(e,t){var n,r=_T(e,"a","div"),a=_T(t,"b","div");if(n=l_(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return xR(r,a);var i={a:r,b:a};return m_.runKernelFunc((function(e,t){var n=e.realDivide(r,a);return t([r,a]),n}),i,null,IN,{})}});function MR(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=o[i],s.push(o[i]);var c=DI(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,a,u,c]}Object.freeze({prepareAndValidate:MR});function FR(e){return e<=30?e:OI(e,Math.floor(Math.sqrt(e)))}function LR(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+e[o+a]+")")}function BR(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}LR(n,t,e)}function UR(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:cI(t.shape)/u,sliceSize:o,strides:DI(n.slice(0,a)).concat([1]),outputSize:cI(n)}}Object.freeze({validateUpdateShape:LR,validateInput:BR,calculateShapes:UR});function VR(e,t,n){iI(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),iI(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){iI(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},a=0;a<e.rank;++a)r(a)}function zR(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function jR(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function WR(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),nI(0,i,s-1)}function HR(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?nI(0,i,s):nI(-1,i,s-1)}function qR(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function GR(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:VR,maskToAxes:zR,computeOutShape:jR,startForAxis:WR,stopForAxis:HR,isSliceContinous:qR,computeFlatOffset:GR});function KR(e){return m_.customGrad(e)}var XR=UT({softmax_:function(e,t){void 0===t&&(t=-1);var n=_T(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return m_.runKernelFunc((function(e,r){var a=e.softmax(n,t);return r([a]),a}),{logits:n},(function(e,n){var r=n[0],a=e.mul(r);return{logits:function(){return a.sub(a.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),$R=UT({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=_T(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return KR((function(e,n){var r=e.max(t,!0),a=e.sub(r),i=a.toFloat().sub(a.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),QR=UT({transpose_:function(e,t){var n=_T(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),iI(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){iI(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1)return n.clone();var r={perm:t};return m_.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},null,"Transpose",r)}}),YR=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),JR=function(){function e(){}return e.prototype.time=function(e){return ZR("time")},e.prototype.read=function(e){return ZR("read")},e.prototype.readSync=function(e){return ZR("readSync")},e.prototype.numDataIds=function(){return ZR("numDataIds")},e.prototype.disposeData=function(e){return ZR("disposeData")},e.prototype.write=function(e,t,n){return ZR("write")},e.prototype.move=function(e,t,n,r){return ZR("move")},e.prototype.memory=function(){return ZR("memory")},e.prototype.floatPrecision=function(){return ZR("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return ZR("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,ZR("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return ZR("slice")},e.prototype.stridedSlice=function(e,t,n,r){return ZR("stridedSlice")},e.prototype.unstack=function(e,t){return ZR("unstack")},e.prototype.reverse=function(e,t){return ZR("reverse")},e.prototype.concat=function(e,t){return ZR("concat")},e.prototype.neg=function(e){return ZR("neg")},e.prototype.add=function(e,t){return ZR("add")},e.prototype.addN=function(e){return ZR("addN")},e.prototype.subtract=function(e,t){return ZR("subtract")},e.prototype.multiply=function(e,t){return ZR("multiply")},e.prototype.realDivide=function(e,t){return ZR("realDivide")},e.prototype.floorDiv=function(e,t){return ZR("floorDiv")},e.prototype.sum=function(e,t){return ZR("sum")},e.prototype.prod=function(e,t){return ZR("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return ZR("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return ZR("argMin")},e.prototype.argMax=function(e,t){return ZR("argMax")},e.prototype.equal=function(e,t){return ZR("equal")},e.prototype.notEqual=function(e,t){return ZR("notEqual")},e.prototype.less=function(e,t){return ZR("less")},e.prototype.lessEqual=function(e,t){return ZR("lessEqual")},e.prototype.greater=function(e,t){return ZR("greater")},e.prototype.greaterEqual=function(e,t){return ZR("greaterEqual")},e.prototype.logicalNot=function(e){return ZR("logicalNot")},e.prototype.logicalAnd=function(e,t){return ZR("logicalAnd")},e.prototype.logicalOr=function(e,t){return ZR("logicalOr")},e.prototype.where=function(e){return ZR("where")},e.prototype.select=function(e,t,n){return ZR("select")},e.prototype.topk=function(e,t,n){return ZR("topk")},e.prototype.min=function(e,t){return ZR("min")},e.prototype.minimum=function(e,t){return ZR("minimum")},e.prototype.mod=function(e,t){return ZR("mod")},e.prototype.max=function(e,t){return ZR("max")},e.prototype.maximum=function(e,t){return ZR("maximum")},e.prototype.all=function(e,t){return ZR("all")},e.prototype.any=function(e,t){return ZR("any")},e.prototype.squaredDifference=function(e,t){return ZR("squaredDifference")},e.prototype.ceil=function(e){return ZR("ceil")},e.prototype.floor=function(e){return ZR("floor")},e.prototype.round=function(e){return ZR("round")},e.prototype.sign=function(e){return ZR("sign")},e.prototype.isNaN=function(e){return ZR("isNaN")},e.prototype.isInf=function(e){return ZR("isInf")},e.prototype.isFinite=function(e){return ZR("isFinite")},e.prototype.pow=function(e,t){return ZR("pow")},e.prototype.exp=function(e){return ZR("exp")},e.prototype.expm1=function(e){return ZR("expm1")},e.prototype.softmax=function(e,t){return ZR("softmax")},e.prototype.log=function(e){return ZR("log")},e.prototype.log1p=function(e){return ZR("log1p")},e.prototype.sqrt=function(e){return ZR("sqrt")},e.prototype.rsqrt=function(e){return ZR("rsqrt")},e.prototype.square=function(e){return ZR("square")},e.prototype.reciprocal=function(e){return ZR("reciprocal")},e.prototype.relu=function(e){return ZR("relu")},e.prototype.relu6=function(e){return ZR("relu6")},e.prototype.prelu=function(e,t){return ZR("prelu")},e.prototype.elu=function(e){return ZR("elu")},e.prototype.eluDer=function(e,t){return ZR("eluDer")},e.prototype.selu=function(e){return ZR("selu")},e.prototype.int=function(e){return ZR("int")},e.prototype.clip=function(e,t,n){return ZR("clip")},e.prototype.abs=function(e){return ZR("abs")},e.prototype.complexAbs=function(e){return ZR("complexAbs")},e.prototype.sigmoid=function(e){return ZR("sigmoid")},e.prototype.softplus=function(e){return ZR("softplus")},e.prototype.sin=function(e){return ZR("sin")},e.prototype.cos=function(e){return ZR("cos")},e.prototype.tan=function(e){return ZR("tan")},e.prototype.asin=function(e){return ZR("asin")},e.prototype.acos=function(e){return ZR("acos")},e.prototype.atan=function(e){return ZR("atan")},e.prototype.atan2=function(e,t){return ZR("atan2")},e.prototype.sinh=function(e){return ZR("sinh")},e.prototype.cosh=function(e){return ZR("cosh")},e.prototype.tanh=function(e){return ZR("tanh")},e.prototype.asinh=function(e){return ZR("asinh")},e.prototype.acosh=function(e){return ZR("acosh")},e.prototype.atanh=function(e){return ZR("atanh")},e.prototype.erf=function(e){return ZR("erf")},e.prototype.step=function(e,t){return ZR("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ZR("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return ZR("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return ZR("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return ZR("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ZR("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return ZR("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return ZR("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return ZR("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return ZR("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return ZR("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return ZR("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return ZR("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return ZR("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return ZR("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return ZR("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return ZR("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return ZR("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return ZR("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return ZR("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return ZR("reshape")},e.prototype.cast=function(e,t){return ZR("cast")},e.prototype.tile=function(e,t){return ZR("tile")},e.prototype.pad=function(e,t,n){return ZR("pad")},e.prototype.transpose=function(e,t){return ZR("transpose")},e.prototype.gather=function(e,t,n){return ZR("gather")},e.prototype.gatherND=function(e,t){return ZR("gatherND")},e.prototype.scatterND=function(e,t,n){return ZR("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return ZR("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return ZR("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return ZR("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return ZR("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return ZR("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return ZR("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,a,i){return ZR("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,a){return ZR("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,a,i,o){return ZR("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return ZR("multinomial")},e.prototype.oneHot=function(e,t,n,r){return ZR("oneHot")},e.prototype.cumsum=function(e,t,n,r){return ZR("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,a){return ZR("nonMaxSuppression")},e.prototype.fft=function(e){return ZR("fft")},e.prototype.ifft=function(e){return ZR("ifft")},e.prototype.complex=function(e,t){return ZR("complex")},e.prototype.real=function(e){return ZR("real")},e.prototype.imag=function(e){return ZR("imag")},e.prototype.cropAndResize=function(e,t,n,r,a,i){return ZR("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return ZR("depthToSpace")},e.prototype.split=function(e,t,n){return ZR("split")},e.prototype.sparseToDense=function(e,t,n,r){return ZR("sparseToDense")},e.prototype.diag=function(e){return ZR("diag")},e.prototype.fill=function(e,t,n){return ZR("fill")},e.prototype.onesLike=function(e){return ZR("onesLike")},e.prototype.zerosLike=function(e){return ZR("zerosLike")},e.prototype.linspace=function(e,t,n){return ZR("linspace")},e.prototype.dispose=function(){return ZR("dispose")},e}();function ZR(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function eA(e,t,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,u=iA(t),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,e[1],e[1]]}return nA(e,s,n,r,a,i,!1,o)}function tA(e,t,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,u,c=oA(t),l=c[0],f=c[1],h=c[2];if("NDHWC"===o)u="channelsLast",s=[l,f,h,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,f,h,e[1],e[1]]}return rA(e,s,n,r,a,!1,u,i)}function nA(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3];if("channelsLast"===s)c=e[0],l=e[1],f=e[2],h=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],h=e[1],l=e[2],f=e[3]}var d,p=t[0],v=t[1],m=t[3],g=iA(n),y=g[0],b=g[1],x=iA(r),w=x[0],k=x[1],E=sA(p,w),S=sA(v,k),C=function(e,t,n,r,a,i,o,s){var u,c,l;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=aA(e,t,n));var i=e[1],o=uA((e[0]-t+2*r)/n+1,a);iI(fI(o),(function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"}));var s=uA((i-t+2*r)/n+1,a);return iI(fI(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[o,s]}([t,n],i,r,e,s);c=f[0],l=f[1]}else if("same"===e){c=Math.ceil(t/r),l=Math.ceil(n/a);var h=Math.max(0,(c-1)*r+i-t),d=Math.max(0,(l-1)*a+o-n),p=Math.floor(h/2),v=h-p,m=Math.floor(d/2);u={top:p,bottom:v,left:m,right:d-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),l=Math.ceil((n-o+1)/a)}return{padInfo:u,outHeight:c,outWidth:l}}(a,l,f,y,b,E,S,i),I=C.padInfo,_=C.outHeight,T=C.outWidth,N=o?m*h:m;return"channelsFirst"===s?d=[c,N,_,T]:"channelsLast"===s&&(d=[c,_,T,N]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:h,outHeight:_,outWidth:T,outChannels:N,padInfo:I,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:v,effectiveFilterHeight:E,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:k,inShape:e,outShape:d,filterShape:t}}function rA(e,t,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3],d=u[4];if("channelsLast"===o)c=e[0],l=e[1],f=e[2],h=e[3],d=e[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=e[0],d=e[1],l=e[2],f=e[3],h=e[4]}var p,v=t[0],m=t[1],g=t[2],y=t[4],b=oA(n),x=b[0],w=b[1],k=b[2],E=oA(r),S=E[0],C=E[1],I=E[2],_=sA(v,S),T=sA(m,C),N=sA(g,I),R=function(e,t,n,r,a,i,o,s,u,c,l){var f,h,d,p;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=aA(e,t,r));var o=e[1],s=e[2],u=uA((e[0]-t+2*a)/r+1,i);iI(fI(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=uA((o-t+2*a)/r+1,i);iI(fI(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=uA((s-t+2*a)/r+1,i);return iI(fI(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([t,n,r,1],s,0,a,e,l);h=v[0],d=v[1],p=v[2]}else if("same"===e){var m=((h=Math.ceil(t/a))-1)*a+s-t,g=((d=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(m/2),x=m-b,w=Math.floor(g/2),k=g-w,E=Math.floor(y/2);f={top:w,bottom:k,left:E,right:y-E,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/a),d=Math.ceil((n-u+1)/i),p=Math.ceil((r-c+1)/o)}return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}(a,l,f,h,x,w,k,_,T,N,s),A=R.padInfo,O=R.outDepth,D=R.outHeight,P=R.outWidth,M=i?y*d:y;return"channelsFirst"===o?p=[c,M,O,D,P]:"channelsLast"===o&&(p=[c,O,D,P,M]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:f,inWidth:h,inChannels:d,outDepth:O,outHeight:D,outWidth:P,outChannels:M,padInfo:A,strideDepth:x,strideHeight:w,strideWidth:k,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:_,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationDepth:S,dilationHeight:C,dilationWidth:I,inShape:e,outShape:p,filterShape:t}}function aA(e,t,n,r){void 0===r&&(r=1);var a=sA(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function iA(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function oA(e){return"number"==typeof e?[e,e,e]:e}function sA(e,t){return t<=1?e:e+(e-1)*(t-1)}function uA(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function cA(e){var t=iA(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function lA(e,t){return cA(e)||cA(t)}function fA(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function hA(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=YT(e.shape),a=e.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!EI(e.dtype,t))return m_.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e);return i=o.cast(t),o.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=qT(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function dA(e,t){return m_.makeTensorFromDataId(e.dataId,t,e.dtype)}function pA(e,t,n){var r=(t-e)/(n-1),a=LI(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return GT(a,"float32")}Object.freeze({castTensor:hA,reshapeTensor:dA,linspaceImpl:pA,upcastType:u_,axesAreInnerMostDims:NT,combineLocations:RT,computeOutAndReduceShapes:AT,expandShapeToKeepDim:OT,assertAxesAreInnerMostDims:DT,getAxesPermutation:PT,getUndoAxesPermutation:MT,getInnerMostAxes:FT,getBroadcastDims:PN,getReductionAxes:MN,assertAndGetBroadcastShape:FN,assertParamsConsistent:LT,computeOutShape:BT,computePool2DInfo:eA,computePool3DInfo:tA,computeConv2DInfo:nA,computeConv3DInfo:rA,computeDefaultPad:aA,tupleValuesAreOne:cA,eitherStridesOrDilationsAreOne:lA,convertConv2DDataFormat:fA,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:FR});function vA(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function mA(e,t){return{real:e[2*t],imag:e[2*t+1]}}function gA(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function yA(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function bA(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||xA)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function xA(e,t){return e>t?1:e<t?-1:0}function wA(e,t,n,r,a){return EA(e,t,n,r,a,0).selectedIndices}function kA(e,t,n,r,a,i){var o=EA(e,t,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function EA(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map((function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}})).filter((function(e){return e.score>a})).sort(IA),c=i>0?-.5/i:0,l=[],f=[];l.length<n&&u.length>0;){var h=u.pop(),d=h.score,p=h.boxIndex,v=h.suppressBeginIndex;if(d<a)break;for(var m=!1,g=l.length-1;g>=v;--g){var y=SA(e,p,l[g]);if(y>=r){m=!0;break}if(h.score=h.score*CA(r,c,y),h.score<=a)break}h.suppressBeginIndex=l.length,m||(h.score===d?(l.push(p),f.push(h.score)):h.score>a&&bA(u,h,IA))}var b=l.length;return s&&(l.fill(0,b),f.fill(0,b)),{selectedIndices:GT(l,"int32"),selectedScores:GT(f,"float32"),numValidOutputs:qT(b,"int32")}}function SA(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),d=(s-i)*(u-o),p=(f-c)*(h-l);if(d<=0||p<=0)return 0;var v=Math.max(i,c),m=Math.max(o,l),g=Math.min(s,f),y=Math.min(u,h),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(d+p-b)}function CA(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function IA(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function _A(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map((function(t){a[n]=t;var i=e.slice(r,a);return r[n]+=t,i}))}function TA(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var a=cN(n,e.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=i[s]%e.shape[s];var u=e.locToIndex(o);a.values[r]=e.values[u]}return a.toTensor()}function NA(e,t,n,r,a){for(var i=t[t.length-1],o=[e.length/i,i],s=o[0],u=o[1],c=bI(n,s*r),l=bI("int32",s*r),f=0;f<s;f++){for(var h=f*u,d=e.subarray(h,h+u),p=[],v=0;v<d.length;v++)p.push({value:d[v],index:v});p.sort((function(e,t){return t.value-e.value}));var m=f*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}var b=t.slice();return b[b.length-1]=r,[WT(c,b,n),WT(l,b,"int32")]}function RA(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var a=cN(e,"int32"),i=cN([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*e.length;i.values.set(o,s)}return i.toTensor()}var AA=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},OA=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},DA=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,a=e.batchSize,i=e.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function PA(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function MA(e,t){return 1===t?[e]:PA(e,t)}function FA(){var e,t,n,r,a,i,o,s,u,c;return 2===qC().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function LA(e,t,n){void 0===n&&(n="index");var r=DI(t);return r.map((function(t,a){return"int "+e[a]+" = "+n+" / "+t+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+t:"index -= "+e[a]+" * "+t)+";"})).join("")}function BA(e){var t=DI(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var UA="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function VA(e,t,n,r){var a=[];e.forEach((function(e){var t=cI(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(a.push("uniform sampler2D "+e.name+";"),a.push("uniform int offset"+e.name+";"))}));var i,o,s=a.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?jA(e):zA(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=PN(e.shapeInfo.logicalShape,t.logicalShape),c=$A(s),l=s-o,f=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+f[e+l]+" = 0;"})).join("\n");var h;h=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+f[t+l]})).join(", ");var d="return outputValue;",p=1===cI(e.shapeInfo.logicalShape),v=1===cI(t.logicalShape);if(1!==o||p||v){if(p&&!v)d=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=o-2,g=o-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?d="return vec4(outputValue.x);":u.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+h+");\n      "+d+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&lI(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=$A(u),f=PN(e.shapeInfo.logicalShape,t.logicalShape),h=u-s,d=["x","y","z","w","u","v"];c=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords."+d[e+h]+" = 0;"})).join("\n");var p;return p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+d[t+h]})).join(", "),"\n    float "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+p+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=FA(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),h=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+WA+"\n    "+HA+"\n    "+qA+"\n  "}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(lI(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)o="\n      int b"+u+" = index / "+(i*=e[e.length-u-1])+";\n      index -= b"+u+" * "+i+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,a,i,o}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return lI(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=LA(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=LA(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=LA(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=LA(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(h+=GA),[h,f,o,s,i,u,n].join("\n")}function zA(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+KA(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+XA(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=KA(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&lI(t,a)){var i=a[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var o=yI(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length)return"\n      "+zA(QA(e,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+YA(["row","col"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+XA(e)+"\n      }\n    ";var l=a[0],f=a[1],h=KA(n);return 1===f?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===l?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+f+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+h+";\n    vec2 uv = uvFromFlat("+l+", "+f+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=yI(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length)return"\n        "+zA(QA(e,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+YA(["row","col","depth"],u)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+XA(e)+"\n      }\n    ";var l=e.shapeInfo.texShape,f=l[0],h=l[1],d=e.shapeInfo.flatOffset;return h===a&&null==d?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+f+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":h===i&&null==d?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+KA(n)+";\n        vec2 uv = uvFromFlat("+f+", "+h+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=yI(t),u=s.newShape,c=s.keptDims;if(u.length<t.length)return"\n      "+zA(QA(e,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+YA(["row","col","depth","depth2"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+XA(e)+"\n      }\n    ";var l=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1];return d===o&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":d===a&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+h+", "+d+", index + "+KA(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=yI(t),c=u.newShape,l=u.keptDims;if(c.length<t.length)return"\n      "+zA(QA(e,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+YA(["row","col","depth","depth2","depth3"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+XA(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1];return p===s&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===a&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+KA(n)+";\n      vec2 uv = uvFromFlat("+d+", "+p+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=yI(t),i=a.newShape,o=a.keptDims;if(i.length<t.length)return"\n      "+zA(QA(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+YA(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    ";var s=t[5],u=t[4]*s,c=t[3]*u,l=t[2]*c,f=t[1]*l;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+l+", "+c+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+XA(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],v=d[1];return v===f&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+l+", "+c+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":v===s&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+l+" + depth * "+c+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+KA(n)+";\n      vec2 uv = uvFromFlat("+p+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function jA(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+FA().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=FA();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=FA();if(null!=a&&lI(t,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0])return"\n        "+jA(QA(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+YA(["b","row","col"],[1,2])+");\n        }\n      ";var o=i[0],s=i[1],u=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+o+", "+s+", "+u*Math.ceil(t[1]/2)+", "+u+", b, row, col);\n      return "+FA().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",h="b * "+l+" + (row / 2) * "+c+" + (col / 2)",d=2;d<n-1;d++)f="int b"+d+", "+f,h="b"+d+" * "+(l*=t[n-d-1])+" + "+h;return"\n    vec4 "+a+"("+f+") {\n      int index = "+h+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+FA().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var WA="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",HA="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",qA="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",GA="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function KA(e){return"offset"+e}function XA(e){var t=e.name,n=cI(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function $A(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function QA(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function YA(e,t){return t.map((function(t){return e[t]})).join(", ")}var JA=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,iI(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=$A(c),f=MA("coords",c);if(1===i){var h=$A(s=c+1);o="\n        "+h+" sourceLocR = "+h+"("+f.join()+", 0);\n        ++"+f[c-1]+";\n        "+h+" sourceLocG = "+h+"("+f.join()+", 0);\n        ++"+f[c-2]+";\n        "+h+" sourceLocA = "+h+"("+f.join()+", 0);\n        --"+f[c-1]+";\n        "+h+" sourceLocB = "+h+"("+f.join()+", 0);\n        --"+f[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+f[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+f[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+f[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+f[c-2]+";";var d=["x","y","z","w","u","v"].slice(0,s),p="."+d[s-1],v=d.map((function(e){return"int "+e})),m=MA("sourceLocR",s-1).concat("inIdx.r"),g=MA("sourceLocG",s-1).concat("inIdx.g"),y=MA("sourceLocB",s-1).concat("inIdx.b"),b=MA("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",k="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",E=r?"":"\n      float getBestIndicesAChannel("+v.join()+") {\n        return getChannel(getBestIndicesA("+d.join()+"),\n                                          vec2("+d.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+v.join()+") {\n        return getChannel(getA("+d.join()+"),\n                               vec2("+d.slice(-2).join()+"));\n      }\n      "+E+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+f[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+f[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+k+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+k+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},ZA=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eO=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=f-1-e.padInfo.top,v=h-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+f+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},tO=function(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],FN(e,t),FN(e,n);var o="0.0";null!=r&&(FN(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(FN(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},nO=function(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],FN(e,t),FN(e,n);var o="vec4(0.0)";null!=r&&(FN(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(FN(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},rO=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=FN(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},aO="return a + b;",iO="return a - b;",oO="return a * b;",sO="return (a < 0.) ? b * a : a;",uO=function(e,t,n){this.variableNames=["A","B"],this.outputShape=FN(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},cO="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",lO=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=FN(t,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===cI(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+$A(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=MA("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},fO=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),hO=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),dO=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},pO=function(e){this.outputShape=[],this.outputShape=BT(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var a=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=t.length,o=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},vO=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=BT(e,t);var n=this.outputShape,r=n.length,a=$A(r),i=MA("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=o[t],l=o.slice(-2),f=o.join(),h="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+f+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var d=s[u-1];h+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+mO(o,c,d)+"),\n            vec2("+mO(l,c,d)+"));\n        }"}var p=s.length,v=s[s.length-1];h+="\n        return getChannel(\n          getT"+p+"("+mO(o,c,v)+"),\n          vec2("+mO(l,c,v)+"));",this.userCode="\n      float getValue("+o.map((function(e){return"int "+e}))+") {\n        "+h+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function mO(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var gO=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yO=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},bO=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+a+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},xO=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wO=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},kO=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},EO=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),d=e.inChannels%4,p="channelsLast"===e.dataFormat,v=p?1:2,m=p?2:3,g=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===d)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+h+") *\n                    getW(wR, wC, "+h+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+h+", xR, xC) *\n                    getW(wR, wC, "+h+", d2);\n              }\n\n            } else if ("+(2===d)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===d)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2),\n                getW(wR, wC, "+h+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1),\n                  getX(batch, xR, xC, "+h+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC),\n                  getX(batch, "+h+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},SO=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,f=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CO=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=e.outChannels/e.inChannels,v="",m="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+h+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+f+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+m+"\n        setOutput(result);\n      }\n    "},IO=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=d,v="int xR; int xC; int xCOffset;",m=0;m<h;m++)for(var g=0;g<d;g++)v+="\n          vec4 xTexelR"+m+"C"+2*g+" = vec4(0.);\n          vec4 wR"+m+"C"+g+" = vec4(0.);\n          vec4 xR"+m+"C"+g+" = vec4(0.);";for(m=0;m<h;m++)for(var y=0;y<p;y++){if(v+="\n          xR = xRCorner + "+m*l+";\n          xC = xCCorner + "+(g=2*y)*f+";\n        ",1===c){if(g<d&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+g+" = vec4(previous.zw, xTexelR"+m+"C"+g+".xy);\n                } else {\n                  xR"+m+"C"+g+" = vec4(0, 0, xTexelR"+m+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = xTexelR"+m+"C"+g+";\n              ",g+1<d)){var b=s%2==0?rI(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",f>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+g+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(g+1)+" = xTexelR"+m+"C"+(g+2)+";\n                "}}else g<d&&(v+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n              ",g+1<d&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(g+1)+" = vec4(xTexelR"+m+"C"+(g+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".xy, xTexelR"+m+"C"+(g+2)+".xy);\n              ",g+1<d&&(v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n                ")),v+="}");g<d&&(v+="\n            vec4 wTexelR"+m+"C"+g+" = getW("+m+", "+g+", d1, q);\n            wR"+m+"C"+g+" = vec4(wTexelR"+m+"C"+g+".xz, wTexelR"+m+"C"+g+".xz);\n          ",g+1<d&&(v+="\n              vec4 wTexelR"+m+"C"+(g+1)+" = getW("+m+", "+(g+1)+", d1, q);\n              wR"+m+"C"+(g+1)+" =\n                vec4(wTexelR"+m+"C"+(g+1)+".xz, wTexelR"+m+"C"+(g+1)+".xz);"))}for(m=0;m<h;m++)for(g=0;g<d;g++)v+="dotProd += xR"+m+"C"+g+" * wR"+m+"C"+g+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+k+"\n        "+w+"\n        setOutput(result);\n      }\n    "},_O=function(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],s=e[2],u=e[3],c=t[0],l=n[0],f=n[1];this.outputShape=[c,l,f,u];var h="bilinear"===r?1:0,d=[o-1+".0",s-1+".0"],p=d[0],v=d[1],m=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],g=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],w=x[0],k=x[1],E=x[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+k+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+E+";\n        if( in_x < 0.0 || in_x > "+v+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+h+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},TO=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+$A(r)+" coords = getOutputCoords();\n        int end = "+NO(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+NO(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function NO(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var RO=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=b_.DENSE;var t=__(e),n=FA();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+LA(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},AO=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=b_.DENSE;var t=__(e),n=FA();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+LA(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},OO=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),DO=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},PO=function(e){this.variableNames=["A"],this.outTexUsage=x_.DOWNLOAD;var t=FA();this.outputShape=e,this.userCode="\n      "+UA+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},MO=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=x_.DOWNLOAD;var t=FA();this.outputShape=e,this.userCode="\n      "+UA+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},FO=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=FA(),a=t[0],i=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+BA(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},LO=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=FA(),a=t[0],i=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+BA(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},BO=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},UO=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),VO=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var a=$A(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)i===t?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(e,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},zO=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=$A(t.length),a=$A(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function jO(e,t){var n=FA();return P_(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function WO(e,t){return j_(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function HO(e,t){return W_(e,t,new Uint16Array([0,1,2,2,1,3]))}function qO(e,t,n,r,a,i,o){q_(n,r);var s=H_(e,t),u=e.TEXTURE_2D;return R_(e,t,(function(){return e.bindTexture(u,s)})),R_(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),R_(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),R_(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),R_(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),R_(e,t,(function(){return e.texImage2D(u,0,a,n,r,0,i,o,null)})),R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function GO(e,t,n,r,a){var i=I_(n,r);return qO(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function KO(e,t,n,r,a){var i=I_(n,r);return qO(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function XO(e,t,n,r,a){var i=I_(n,r);return qO(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function $O(e,t,n,r,a){var i=T_(n,r);return qO(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function QO(e,t,n,r,a){var i=T_(n,r);return qO(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function YO(e,t,n,r){return R_(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),K_(e,t,n,"clipSpacePos",r,3,20,0)&&K_(e,t,n,"uv",r,2,20,12)}function JO(e,t,n,r,a,i,o){var s,u,c;R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),u=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),R_(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,u,s)})),R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function ZO(e,t,n,r){R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?R_(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):R_(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),R_(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function eD(e,t,n,r,a){var i=e.createBuffer();R_(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var o=16*n*r;return R_(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)})),R_(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),R_(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}function tD(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function nD(e,t,n,r,a){var i=I_(n,r),o=i[0],s=i[1],u=new Uint8Array(n*r*4);return R_(e,t,(function(){return e.readPixels(0,0,o,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function rD(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=T_(e,t);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function aD(e,t,n,r){var a=new Float32Array(n*r*4);return R_(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)})),a}var iD=Object.freeze({createVertexShader:jO,createVertexBuffer:WO,createIndexBuffer:HO,createFloat32MatrixTexture:GO,createFloat16MatrixTexture:KO,createUnsignedBytesMatrixTexture:XO,createPackedMatrixTexture:$O,createFloat16PackedMatrixTexture:QO,bindVertexProgramAttributeStreams:YO,uploadDenseMatrixToTexture:JO,uploadPixelDataToTexture:ZO,createBufferFromOutputTexture:eD,downloadFloat32MatrixFromBuffer:tD,downloadByteEncodedFloatMatrixFromOutputTexture:nD,downloadPackedMatrixFromBuffer:rD,downloadMatrixFromPackedOutputTexture:aD}),oD=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=qC().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,S_(t,e)):this.gl=C_(t);var n="WEBGL_color_buffer_float";if(1===qC().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=D_(this.gl,this.debug,"OES_texture_float"),dT(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=D_(this.gl,this.debug,"OES_texture_half_float");else if(qC().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),dT(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=D_(this.gl,this.debug,"EXT_color_buffer_half_float");else if(qC().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",dT(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!dT(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=WO(this.gl,this.debug),this.indexBuffer=HO(this.gl,this.debug),this.framebuffer=G_(this.gl,this.debug),this.textureConfig=N_(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return qC().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;R_(t,this.debug,(function(){return t.finish()})),R_(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),R_(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),R_(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),R_(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),R_(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),GO(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),KO(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),XO(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),ZO(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),JO(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),QO(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),$O(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Z_(this.gl,this.debug,this.framebuffer),this.outputTexture=null),R_(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return nD(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,a,i){return rD(this.gl,e,0,0,0,a,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return tD(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=eD(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(qC().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return aD(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=M_(t,this.debug,e),r=jO(t,this.debug),a=U_(t,this.debug);return R_(t,this.debug,(function(){return t.attachShader(a,r)})),R_(t,this.debug,(function(){return t.attachShader(a,n)})),V_(t,this.debug,a),this.debug&&z_(t,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=YO(t,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&R_(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&z_(this.gl,this.debug,this.program),R_(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?$_(this.gl,this.debug,e,t):Q_(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),R_(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Y_(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=T_(t,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&z_(this.gl,this.debug,this.program),eT(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),R_(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),R_(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=D_(this.gl,this.debug,2===qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(2!==qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return zC(this,void 0,void 0,(function(){var t=this;return jC(this,(function(n){switch(n.label){case 0:return[4,vI((function(){return t.disposed||t.isQueryAvailable(e,qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||vI((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),J_(this.gl,this.debug,e,this.framebuffer),this.debug&&eT(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(J_(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&eT(this.gl)):Z_(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;J_(r,this.debug,e,this.framebuffer),this.debug&&eT(r),this.outputTexture=e,R_(r,this.debug,(function(){return r.viewport(0,0,t,n)})),R_(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var a=this;this.throwIfDisposed(),R_(this.gl,this.debug,(function(){return a.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function sD(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!lI(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!lI(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var uD=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,f=n.dataFormat,h=s.left,d=s.top,p=a*r,v=FA(),m="channelsLast"===f,g=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+d+";\n            d0 = offsetY + "+l+" * (pos / "+p+");\n\n            if(d0 < "+t[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+p+".) / "+a+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+v.output+" = result;\n      }\n    "},cD=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},lD=function(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},fD=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},hD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,u=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},dD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,d=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+f+", "+h+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+d+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},pD=function(e,t,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";i&&(d=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+d+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+f[0]+" * "+h[0]+");\n          result += ("+f[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+v+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},vD=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),mD=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},gD=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=MA("rc",t),r=$A(t),a=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",a=e-2;a<e;a++)r+=n[a]+" >= "+t[a],a<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),o=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<e;o++)i=t[t.length-1-o]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},yD=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,a=$A(r),i=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},bD=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,a=$A(r),i=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=MA("rc",r),u=MA("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",f=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",p=0,v=1===r?2:4;p<v;p++)d+="\n        "+f[p]+"\n        if ("+h+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";d+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+d+"\n        setOutput(result);\n      }\n    "},xD=function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var p="avg"===t,v="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",g="0.0";if(p||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+s+");\n        const ivec2 pads = ivec2("+h+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+c+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = "+(r?a?v:m:"wR * "+f+" + wC")+";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(i/4),x=i%4,w="\n      if ("+p+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+h+", "+d+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+u+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+b+"; wC += 4) {\n            int xC = xCCorner + wC * "+c+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              getValue(batch, xR, xC + 3 * "+c+", d)\n            );\n\n            "+w+"\n          }\n\n          int xC = xCCorner + "+b+";\n          if ("+(1===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(2===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(3===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              initializationValue\n            );\n\n            "+w+"\n          }\n        }\n        setOutput("+y+");\n      }\n    "}},wD=function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,v=e.padInfo.front,m=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;var y="avg"===t,b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+s+", "+u+");\n        const ivec3 pads = ivec3("+v+", "+m+", "+g+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+h+";\n              wD += "+c+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+p+";\n                  wC += "+f+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = "+(r?a?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+d+" * "+p+" +\n                      wR * "+p+" + wC")+";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(x="avgValue / count");var w=4*Math.floor(i/4),k=i%4,E="\n      if ("+y+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+s+", "+u+");\n      const ivec3 pads = ivec3("+v+", "+m+", "+g+");\n      const float initializationValue = "+b+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+b+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+h+";\n            wD += "+c+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+w+"; wC += 4) {\n              int xC = xCCorner + wC * "+f+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+f+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+f+", ch)\n              );\n\n              "+E+"\n            }\n\n            int xC = xCCorner + "+w+";\n            if ("+(1===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(2===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(3===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+f+", ch),\n                initializationValue\n              );\n\n              "+E+"\n            }\n          }\n          setOutput("+x+");\n        }\n      }\n    "}},kD=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,f="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="vec4";"all"===t?(o="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(o="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var d="";a%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(2===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(3===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+f+"\n        }\n        setOutput("+u+");\n      }\n    "},ED=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+LA(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+BA(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},SD=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],d=1/f,p=1/h,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},CD=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},ID=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},_D=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],d=1/f,p=1/h,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},TD=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},ND=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),a=$A(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},RD=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=MA("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=$A(n);function s(n){var r=e.map((function(r,a){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},AD=function(e,t,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=$A(a.length),u=$A(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",f="";1===r?f="i":2===r&&(f="i, coords[1]");var h="getUpdates("+f+")",d=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+d+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+h+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},OD=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+f+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},DD=function(e,t,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&o.push(""+i[u]);r=o.join(),a=s.join()}var c=$A(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},PD=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=$A(this.rank),r="uniform int start["+this.rank+"];",a=function(e){if(1===e)return"sourceLoc";if(e<=6)return MD.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+MD[t]+" = start["+t+"] + coords."+MD[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+a+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),MD=["x","y","z","w","u","v"],FD=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=$A(this.rank),n=MA("coords",this.rank),r=MA("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),LD=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=$A(n.length),i=$A(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+e+");\n      "+a+" strides = "+a+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},BD=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,a=UD(t,n),i=VD(e,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===w_.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===w_.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===w_.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===w_.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===w_.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var a=VD(t,UD(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function UD(e,t){if(e===x_.UPLOAD)return w_.PACKED_2X2_FLOAT32;if(e===x_.RENDER||null==e)return function(e){return qC().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?w_.PACKED_2X2_FLOAT32:w_.UNPACKED_FLOAT32:e?w_.PACKED_2X2_FLOAT16:w_.UNPACKED_FLOAT16}(t);if(e===x_.DOWNLOAD||e===x_.PIXELS)return w_.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function VD(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var zD=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var a=$A(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod("+n[a]+", "+e[a]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},jD=1.7580993408473768,WD=1.0507009873554805,HD=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},qD="if (isnan(x)) return x;",GD="return abs(x);",KD=qD+"\n  return (x < 0.0) ? 0.0 : x;\n",XD=qD+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",$D="return (x >= 0.0) ? x : (exp(x) - 1.0);",QD="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+jD+";\n  float scale = "+WD+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",YD="return -x;",JD="return ceil(x);",ZD="return floor(x);",eP="return exp(x);",tP="return exp(x) - 1.0;",nP=qD+"\n  return sin(x);\n",rP=qD+"\n  return cos(x);\n",aP=qD+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",iP=qD+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",oP=qD+"\n  return atan(x);\n",sP=qD+"return log(x + sqrt(x * x + 1.0));",uP=qD+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",cP=qD+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",lP="return x;",fP="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",hP="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",dP="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",pP=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},vP=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=MA("rc",t),r=$A(t),a=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},mP={};function gP(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?fP:KD;if("elu"===e)return t?dP:$D;if("relu6"===e)return t?hP:XD;if("prelu"===e)return t?cO:sO;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var yP=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!qC().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var a=C_(qC().getNumber("WEBGL_VERSION"));r.binaryCache=((n=qC().getNumber("WEBGL_VERSION"))in mP||(mP[n]={}),mP[n]),r.gpgpu=new oD(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new BD(r.gpgpu),r.numMBBeforeWarning=null==qC().global.screen?1024:qC().global.screen.height*qC().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new YR(r,m_),r}return VC(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(qC().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:x_.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(qC().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:x_.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new pP(o,lP):new HD(o,lP);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,h,d=null!=this.activeTimers;return d&&(f=BI()),h="complex64"===r?vA(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(e),d&&(this.downloadWaitMs+=BI()-f),this.convertAndCacheOnCPU(e,h)},t.prototype.read=function(e){return zC(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l,f,h,d,p,v,m,g,y,b,x,w,k;return jC(this,(function(E){switch(E.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.complexTensors,u=n.isPacked,null!=i)return void 0,c=u?new pP(a,lP):new HD(a,lP),l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),f=this.read(l.dataId),this.disposeData(l.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!qC().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===qC().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==o&&qC().get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(e),p=this.texData.get(d.dataId),h=(k=this.gpgpu).createBufferFromTexture.apply(k,[p.texture].concat(__(a)))),this.pendingRead.set(e,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=E.sent(),g=m[0],y=m[1],v=vA(g,y),[3,5];case 4:null==h?v=this.getValuesFromTexture(e):(b=cI(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(h,b)),E.label=5;case 5:return null!=d&&this.disposeData(d.dataId),x=this.convertAndCacheOnCPU(e,v),w=this.pendingRead.get(e),this.pendingRead.delete(e),w.forEach((function(e){return e(x)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,x]}}))}))},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!A_(n)){if(qC().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.isPacked,o=cI(r);if(qC().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),c=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(__(r))).subarray(0,o);return this.disposeData(s.dataId),c}var l=qC().getBool("WEBGL_PACK")&&!0===i,f=l?oT(r):r,h=l?new MO(f):new PO(f),d=this.runWebGLProgram(h,[{shape:f,dtype:a,dataId:e}],"float32"),p=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,o);return this.disposeData(d.dataId),v},t.prototype.time=function(e){return zC(this,void 0,void 0,(function(){var t,n,r,a,i,o,s;return jC(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),a=uI(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=uI(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return s=u.sent(),o.kernelMs=aI(s),o.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:BI(),endMs:null}},t.prototype.endTimer=function(e){return qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=BI(),e)},t.prototype.getQueryTime=function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){return qC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return qC().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=m_.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&cI(e.shape)<t}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:m_.keep(e.clone()),imag:m_.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===cI(n))return WT([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=qR(e.shape,t,n);if(r||!a){var i=qC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FD(n):new PD(n),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var o=GR(t,e.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=jR(t,n,r);if(a.some((function(e){return 0===e})))return WT([],a);var i=new LD(t,r,a);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=qC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RD(e.shape,t):new ND(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return zT(e)})),r=e.map((function(e){return jT(e)}));return VT(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>qC().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),i=this.concat(e.slice(0,a),t),o=this.concat(e.slice(a),t);return this.concat([i,o],t)}if(qC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new vO(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=BT(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,cI(e.shape.slice(t)))})),l=new pO(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YD,e.dtype);var t=new HD(e.shape,YD);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===a||1===i)&&o>1e3){n&&(e=QR(e,[0,2,1])),r&&(t=QR(t,[0,2,1]));var u=1===i?e:e.as3D(s,o,1),c=1===i?2:1,l=1===i?t.as3D(s,1,o):t;return this.multiply(u,l).sum(c,!0)}var f=u_(e.dtype,t.dtype),h=new pD(e.shape,[s,a,i],n,r);return this.compileAndRun(h,[e,t],f)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],l=t.shape[0],f=u_(t.dtype,n.dtype),h=null!=i,d=null!=s,p=o?gP(o,!0):null,v=new pD(t.shape,[l,u,c],r,a,h,p,d),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,f)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new rO("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new rO("return areal * bimag + aimag * breal;",e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(a,o),u=this.compileAndRun(i,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,oO,e.dtype);var l=new uO(oO,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){var o=[e,t,n],s=null;null!=i&&(s=i.shape,o.push(i));var u=null;if(null!=a&&(u=a.shape,o.push(a)),qC().getBool("WEBGL_PACK_NORMALIZATION")){var c=new nO(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,o)}var l=new tO(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,o)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){var i=qC().getBool("WEBGL_PACK_NORMALIZATION")?new fD(e.shape,t,n,r,a):new cD(e.shape,t,n,r,a);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){var s=new lD(t.shape,r,a,i,o);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return zI(e)}));return TA(cN(e.shape,e.dtype,n),t)}var r=new zD(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=qC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bD(e.shape,t,n):new yD(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new VO(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){iI(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=wN(e.shape,t,r),i=kN(a.length,t.length),o=EN(e.shape,t,r),s=SN(n,t.length),u=CN(o,n,t.length);return QR(e.reshape(a),i).reshape(o).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){iI(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=wN(o.shape,t,r,!1),u=kN(s.length,t.length,!1),c=EN(o.shape,t,r,!1);return QR(o.reshape(s),u).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],a=e.shape[1],i=FR(a),o=new kD({windowSize:i,inSize:a,batchSize:r},t),s=this.compileAndRun(o,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=FR(a),o=new DA({windowSize:i,inSize:a,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,a=FR(r[r.length-1]),i=new JA(r,a,t,null==n),o=null==n?[e]:[e,n],s=this.compileAndRun(i,o,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){DT("sum",t,e.rank);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a),o=c_(e.dtype);return this.reduce(i,"sum",o).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a),o=c_(e.dtype);return this.reduce(i,"prod",o).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,a=PT([r],e.rank),i=e;null!=a&&(i=QR(e,a),r=FT(1,e.rank)[0]);var o=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=cI([i.shape[r]]),u=i.as2D(-1,s),c=c_(e.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",t,c,n).reshape(o);return null!=a&&(l=QR(l,MT(a))),l},t.prototype.segOpCompute=function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=OI(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=OI(e,n+1);return n}(o,a),u=new OD({windowSize:s,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(u,[e,n],r);return c.shape[1]===a?c:(n=eN(0,a).tile([o/s]),this.segOpCompute(c,t,n,r,a))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(DT("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!qC().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=AT(e.shape,r),i=a[0],o=cI(a[1]),s=e.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var a=new TO(e.shape,n,r);return this.compileAndRun(a,[e])},t.prototype.equal=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new uO("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new uO("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new uO("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new uO("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new uO("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new uO("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new HD(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new uO("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new uO("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new DD(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],u_(t.dtype,n.dtype))},t.prototype.where=function(e){ST("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return RA(e.shape,t)},t.prototype.topk=function(e,t,n){return NA(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){DT("min",t,e.rank);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new uO("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new uO("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);DT("max",t,e.rank);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new uO("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){DT("all",t,e.rank);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){DT("any",t,e.rank);var n=AT(e.shape,t),r=n[0],a=cI(n[1]),i=e.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.floorDiv=function(e,t){if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new uO("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,aO);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=u_(e.dtype,t.dtype);if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,aO,n);var r=new uO(aO,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new pP(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,a){void 0===a&&(a=!1);var i=new lO(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(e,i),u=r.makeComplexComponentTensorInfo(t,o),c=new uO(n,e.shape,t.shape);return r.compileAndRun(c,[s,u],u_(i.dtype,o.dtype))})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>qC().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map((function(e){return e.dtype})).reduce((function(e,t){return u_(e,t)})),i=e.map((function(e){return e.shape})),o=qC().getBool("WEBGL_PACK")?new OA(e[0].shape,i):new AA(e[0].shape,i);return this.compileAndRun(o,e,a)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,iO);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=u_(e.dtype,t.dtype);if(qC().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,iO,e.dtype);var r=new uO(iO,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new uO("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=u_(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,JD,e.dtype);var t=new HD(e.shape,JD);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ZD,e.dtype);var t=new HD(e.shape,ZD);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new HD(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new HD(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new HD(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new HD(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new HD(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,eP,e.dtype);var t=new HD(e.shape,eP);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tP,e.dtype);var t=new HD(e.shape,tP);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=gI([t],e.shape),r=this.max(e,n),a=OT(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return PR(o,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new HD(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new HD(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new HD(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new HD(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new HD(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=qC().getBool("WEBGL_PACK")?new pP(e.shape,fP):new HD(e.shape,KD),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=qC().getBool("WEBGL_PACK")?new pP(e.shape,hP):new HD(e.shape,XD),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO(cO,e.shape,t.shape):new uO(sO,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,dP,e.dtype);var t=new HD(e.shape,$D);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new uO("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new HD(e.shape,QD);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new HD(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,a=(r=qC().getBool("WEBGL_PACK_CLIP")?new hO(e.shape):new fO(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(qC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,GD,e.dtype);var t=new HD(e.shape,GD);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new dO(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new HD(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new HD(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new HD(e.shape,nP);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new HD(e.shape,rP);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new HD(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new HD(e.shape,aP);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new HD(e.shape,iP);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new HD(e.shape,oP);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new uO("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new HD(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new HD(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new HD(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new HD(e.shape,sP);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new HD(e.shape,uP);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new HD(e.shape,cP);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new HD(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new HD(e.shape,function(e){return void 0===e&&(e=0),qD+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,a,i){var o=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,c=o[0]*o[1]*o[2],l=n.outChannels,f="channelsLast"===n.dataFormat,h=(1===c||1===l)&&u>1e3,d=o[2]%2!=0&&!!s.isPacked;if(h||!qC().getBool("WEBGL_LAZILY_UNPACK")||!qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var p=f?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],v=this.reshape(e,[1,p,n.inChannels]),m=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:m,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var g=f?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),y={dataId:e.dataId,shape:[1,g,n.inChannels],dtype:e.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,iI(cT(s.shape,y.shape),(function(){return"packed reshape "+s.shape+" to "+y.shape+" isn't free"}));var x=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:y,b:x,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),k=this.texData.get(w.dataId);return iI(k.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=b,k.shape=n.outShape,m_.makeTensorFromDataId(w.dataId,n.outShape,w.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,h=o*s*u,d=l*c,p=[h,d],v=e.squeeze([0]),m=t.reshape([1,h,-1]),g=new uD(p,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,p[0],p[1]]),b=null!=r,x=null!=i,w=a?gP(a,!0):null,k=new pD(y.shape,[1,d,n.outChannels],!0,!1,b,w,x),E=[y,m];r&&E.push(r),x&&E.push(i);var S=this.compileAndRun(k,E);return f?S.reshape([1,l,c,n.outChannels]):S.reshape([1,n.outChannels,l,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(qC().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var s=null!=a,u=null!=o,c=i?gP(i,!1):null,l=new EO(r,s,c,u),f=[t,n];return a&&f.push(a),o&&f.push(o),this.compileAndRun(l,f)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(qC().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new EO(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new yO(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new gO(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=qC().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?gP(o,u):null,l=[n,r],f=null!=i,h=null!=s;return f&&l.push(i),h&&l.push(s),u?(t=new IO(a,f,c,h),this.compileAndRun(t,l)):(t=new CO(a,f,c,h),this.compileAndRun(t,l))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return qC().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new IO(n),this.compileAndRun(r,[e,t])):(r=new CO(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new kO(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new wO(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new SO(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new xO(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new bO(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new xD(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new xD(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var a=new xD(r,"max",!0),i=this.compileAndRun(a,[t]),o=new hD(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new ZA(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return hA(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[t]=i,u[i]=this.slice(e,o,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new wD(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new eO(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new wD(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var a=new wD(r,"max",!0),i=this.compileAndRun(a,[t]),o=new dD(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!cT(e.shape,t)&&(null===n.texture||!cT(n.shape,t))){var r=this.packedReshape(e,t);return m_.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return dA(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var a=qC().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ID(e.shape,t,n,r):new CD(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new SD(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var a=new TD(e.shape,t,n,r);return this.compileAndRun(a,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new _D(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var a=t?e:XR(e),i=a.shape[0],o=a.shape[1],s=new vD(i,o,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var a=new mD(e.size,t,n,r);return this.compileAndRun(a,[e])},t.prototype.diag=function(e){var t=new DO(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return ST("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),wA(e.dataSync(),t.dataSync(),n,r,a)},t.prototype.cropAndResize=function(e,t,n,r,a,i){var o=new _O(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){iI(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],s=a*t,u=i*t,c=o/(t*t),l=new OO("NHWC"===n?[r,s,u,c]:[r,c,s,u],t,n);return this.compileAndRun(l,[e])},t.prototype.split=function(e,t,n){return _A(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=UR(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=e.reshape([i,a]),f=t.reshape([i,o]);if(0===u)return dA(WT([]),n);var h=qT(0),d=new AD(i,a,l.rank,f.rank,s,c);return this.compileAndRun(d,[f,l,h]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var a=UR(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,u=a.outputSize,c=new AD(o,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new BO("return real * expR - imag * expI;",e.shape,t),a=new BO("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),u=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=MR(e,t),i=a[0],o=a[1],s=a[2],u=a[3],c=t.reshape([o,r]),l=e.reshape([e.size/s,s]),f=new zO(r,u,[o,s]);return this.compileAndRun(f,[l,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||RI(t))){var r=xI(n,cI(e));return r.fill(t),m_.makeTensor(r,e,n,this)}var a=new UO(e,t),i=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return pA(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return m_.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new vP(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new gD(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[aT(e.shape)].concat(iT(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[aT(t)].concat(iT(t)),i=new ED(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=oT(a);return t=r?new AO(o):new RO(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===b_.DENSE){var u=__(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===cI(o.shape))return s.values=bI(o.dtype,0),o;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&cI(t.shape)<=qC().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!cT(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),c.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var f,h={shape:o.shape,texData:s,isUniform:!1},d=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var a=e.userCode;return e.constructor.name+"_"+r+"_"+a}(e,l,h),p=this.getAndSaveBinary(d,(function(){return function(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=VA(i,s,a,t.packedInputs),c=e.createProgram(u),l=null,f=e.getUniformLocation(c,"NAN",!1);1===qC().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var h={},d=0;d<t.variableNames.length;d++){var p=t.variableNames[d];h[p]=e.getUniformLocation(c,p,!1),h["offset"+p]=e.getUniformLocation(c,"offset"+p,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:h,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:f}}(i.gpgpu,e,l,h)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(e,t,n,r,a){sD(t.inShapeInfos,n),sD([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===qC().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(cI(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,p,l,h,r),c.forEach((function(e){return i.disposeData(e.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!qC().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var m=this.unpackTensor(o);return this.disposeData(o.dataId),m}return o},t.prototype.compileAndRun=function(e,t,n,r,a){void 0===a&&(a=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return m_.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(qC().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=kT((function(){if(!qC().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=qC().getBool("DEBUG");qC().set("DEBUG",!1);var n=e.abs(qT(1e-8)).dataSync()[0];if(qC().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=BI());var f=n.texShape;if(null==f&&(f=sT(r,u),n.texShape=f),null!=i){var h=oT(r),d=void 0,p=f[1],v=f[0],m=i instanceof Uint8Array;u?(p=(t=T_(f[0],f[1]))[0],v=t[1],d=new LO(h,[v,p],m)):d=new FO(h,[v,p],m);var g=this.makeTensorInfo([v,p],a);this.texData.get(g.dataId).usage=m?x_.PIXELS:x_.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,v,i);var y=this.runWebGLProgram(d,[g],a,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=BI()-c)}else{var x=this.acquireTexture(f,s,a,u);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*CI(t)},t}(JR);function bP(e,t){return e(t={exports:{}},t.exports),t.exports}g_()&&m_.registerBackend("webgl",(function(){return new yP}),2),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var xP=bP((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.alea=i}(0,e)})),wP=bP((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xor128=i}(0,e)})),kP=bP((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xorwow=i}(0,e)})),EP=bP((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xorshift7=i}(0,e)})),SP=bP((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xor4096=i}(0,e)})),CP=bP((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.tychei=i}(0,e)})),IP=bP((function(e){!function(t,r){var a,i=this,o=256,s="random",u=r.pow(o,6),c=r.pow(2,52),l=2*c,f=255;function h(e,n,f){var h=[],g=v(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(e){}return a.length?a:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),h),y=new d(h),b=function(){for(var e=y.g(6),t=u,n=0;e<c;)e=(e+n)*o,t*=o,n=y.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(m(y.S),t),(n.pass||f||function(e,t,n,a){return a&&(a.S&&p(a,y),e.state=function(){return p(y,{})}),n?(r[s]=e,t):e})(b,g,"global"in n?n.global:this==r,n.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=f&i+e[a%n]+(t=s[a])],s[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,s=r.S;e--;)t=s[a=f&a+1],n=n*o+s[f&(s[a]=s[i=f&i+t])+(s[i]=t)];return r.i=a,r.j=i,n})(o)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=h,v(r.random(),t),e.exports){e.exports=h;try{a=n(902)}catch(e){}}}([],Math)}));IP.alea=xP,IP.xor128=wP,IP.xorwow=kP,IP.xorshift7=EP,IP.xor4096=SP,IP.tychei=CP;var _P=IP.alea,TP=UT({addN_:function(e){iI(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),iI(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return _T(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!lI(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return m_.runKernelFunc((function(e,n){return e.addN(t)}),r,null,"AddN")}});function NP(){wT("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function RP(e){return 0===e.rank||1===e.rank?e.as4D(1,1,1,e.size):2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function AP(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=_T(e,"x","batchNorm"),c=_T(t,"mean","batchNorm"),l=_T(n,"variance","batchNorm");null!=a&&(o=_T(a,"scale","batchNorm")),null!=r&&(s=_T(r,"offset","batchNorm")),iI(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),iI(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),iI(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var f={x:u,scale:o,offset:s,mean:c,variance:l},h={varianceEpsilon:i};return m_.runKernelFunc((function(e,t){var n=RP(u),r=e.batchNormalization(n,OP(c),OP(l),i,OP(o),OP(s));return t([u,c,l,o]),r}),f,null,"FusedBatchNorm",h).reshape(u.shape)}function OP(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var DP=UT({batchNormalization_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),NP(),AP(e,t,n,i,a,r)}}),PP=UT({batchNorm_:AP});function MP(e,t,n,r,a,i){var o,s,u=_T(e,"x","batchNorm"),c=_T(t,"mean","batchNorm"),l=_T(n,"variance","batchNorm");return null!=a&&(o=_T(a,"scale","batchNorm")),null!=r&&(s=_T(r,"offset","batchNorm")),iI(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),iI(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),iI(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&iI(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&iI(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),PP(u,c,l,s,o,i)}var FP=UT({batchNormalization2d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),NP(),MP(e,t,n,i,a,r)}}),LP=UT({batchNorm2d_:MP});function BP(e,t,n,r,a,i){var o,s,u=_T(e,"x","batchNorm"),c=_T(t,"mean","batchNorm"),l=_T(n,"variance","batchNorm");return null!=a&&(o=_T(a,"scale","batchNorm")),null!=r&&(s=_T(r,"offset","batchNorm")),iI(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),iI(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),iI(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&iI(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&iI(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),PP(u,c,l,s,o,i)}var UP=UT({batchNormalization3d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),NP(),BP(e,t,n,i,a,r)}}),VP=UT({batchNorm3d_:BP});function zP(e,t,n,r,a,i){var o,s,u=_T(e,"x","batchNorm"),c=_T(t,"mean","batchNorm"),l=_T(n,"variance","batchNorm");return null!=a&&(o=_T(a,"scale","batchNorm")),null!=r&&(s=_T(r,"offset","batchNorm")),iI(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),iI(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),iI(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&iI(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&iI(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),PP(u,c,l,s,o,i)}var jP=UT({batchNormalization4d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),NP(),zP(e,t,n,i,a,r)}}),WP=UT({batchNorm4d_:zP}),HP=UT({broadcastTo_:function(e,t){var n=_T(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=n.reshape(a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===u.length)return n.clone();var c={x:n},l={shape:t,inputShape:i};return m_.runKernelFunc((function(e){return e.tile(n,o)}),c,(function(e){return{x:function(){return e.sum(u,!0)}}}),TN,l)}}),qP=UT({clone_:function(e){var t=_T(e,"x","clone",null);return m_.runKernelFunc((function(){return m_.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{x:t},null,RN)}}),GP=UT({logicalAnd_:function(e,t){var n=_T(e,"a","logicalAnd","bool"),r=_T(t,"b","logicalAnd","bool");return FN(n.shape,r.shape),m_.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),KP=UT({logicalNot_:function(e){var t=_T(e,"x","logicalNot","bool");return m_.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),XP=UT({logicalOr_:function(e,t){var n=_T(e,"a","logicalOr","bool"),r=_T(t,"b","logicalOr","bool");return FN(n.shape,r.shape),m_.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),$P=UT({logicalXor_:function(e,t){var n=_T(e,"a","logicalXor","bool"),r=_T(t,"b","logicalXor","bool");return FN(n.shape,r.shape),XP(e,t).logicalAnd(GP(e,t).logicalNot())}}),QP=UT({where_:function(e,t,n){var r=_T(t,"a","where"),a=_T(n,"b","where"),i=_T(e,"condition","where","bool");return oI(r.shape,a.shape,"Error in where: "),1===i.rank?iI(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):oI(i.shape,a.shape,"Error in where: "),m_.runKernelFunc((function(e,t){var n=e.select(i,r,a);return t([i]),n}),{$condition:i,$a:r,$b:a},(function(e,t){var n=t[0];return{$condition:function(){return nN(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),YP=function(e){return zC(this,void 0,void 0,(function(){var t,n,r;return jC(this,(function(a){switch(a.label){case 0:return[4,(t=_T(e,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=RA(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},JP=UT({divNoNan_:function(e,t){var n,r=_T(e,"a","div"),a=_T(t,"b","div");r=(n=l_(r,a))[0],a=n[1];var i=PR(r,a),o=nN(i),s=a.equal(o);return QP(s,o,i)}}),ZP=UT({tile_:function(e,t){var n=_T(e,"x","tile",null);iI(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}));var r=[n],a={x:n},i={reps:t};return m_.runKernelFunc((function(e,r){var a=e.tile(n,t);return r([n]),a}),a,null,AN,i,r)}}),eM=UT({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var a=cN([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return ZP(pN(s,0),[n[0],1,1]);if(2===n.length)return ZP(pN(pN(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return ZP(pN(pN(pN(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),tM=UT({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var a=_T(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,u=m_.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===o?u.as1D():u}}),nM=UT({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=_T(e,"indices","oneHot","int32"),i=a.shape.concat([t]),o={indices:a=a.flatten()},s={depth:t,onValue:n,offValue:r};return m_.runKernelFunc((function(e,i){return i([a]),e.oneHot(a,t,n,r)}),o,null,NN,s).reshape(i)}}),rM=UT({pad_:function(e,t,n){void 0===n&&(n=0);var r=_T(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return m_.runKernelFunc((function(e,a){return a([r]),e.pad(r,t,n)}),i,null,ON,a)}}),aM=UT({pad1d_:function(e,t,n){return void 0===n&&(n=0),iI(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),rM(e,[t],n)}}),iM=UT({pad2d_:function(e,t,n){return void 0===n&&(n=0),iI(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),rM(e,t,n)}}),oM=UT({pad3d_:function(e,t,n){return void 0===n&&(n=0),iI(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),rM(e,t,n)}}),sM=UT({pad4d_:function(e,t,n){return void 0===n&&(n=0),iI(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),rM(e,t,n)}}),uM=UT({rand_:function(e,t,n){var r=cI(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return m_.makeTensor(a,e,n)}});function cM(){return 32===m_.backend.floatPrecision()?.001:.1}function lM(e,t,n){var r=!0;if((SI(e)||SI(t))&&(r=!1),SI(e)&&SI(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var o=CT(e),s=CT(t);if(!lI(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=SI(e)?e:uI(e),c=SI(t)?t:uI(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var f=u[l],h=c[l];if(!n(f,h))throw new Error("Arrays differ: actual["+l+"] = "+f+", expected["+l+"] = "+h+".\nActual:   "+u+".\nExpected: "+c+".")}}function fM(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=cM()),lM(e,t,(function(e,t){return fM(e,t,n)}))},testEpsilon:cM,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return _I(e)||_I(e[0])||_I(t)||_I(t[0])?lM(e,n,(function(e,t){return e==t})):lM(e,t,(function(e,t){return fM(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=cM()),!fM(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}});var hM=function(){function e(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=_P(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),dM=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var a=r||Math.random();this.randu=_P(a.toString()),this.randn=new hM(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),pM=function(){function e(e,t,n,r){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=_P(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),vM=UT({randomGamma_:function(e,t,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new dM(t,n,r,a),o=cN(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),mM=UT({randomNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new hM(t,n,r,!1,a),o=cN(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),gM=UT({randomUniform_:function(e,t,n,r,a){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=cN(e,r),o=new pM(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),yM=UT({square_:function(e){var t=_T(e,"x","square"),n=[t];return m_.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}}),bM=UT({squaredDifference_:function(e,t){var n,r=_T(e,"a","squaredDifference"),a=_T(t,"b","squaredDifference");n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape);var i={a:r,b:a},o=[r,a];return m_.runKernelFunc((function(e,t){var n=e.squaredDifference(r,a);return t([r,a]),n}),i,(function(e,t){var n=t[0],r=t[1],a=qT(2);return{a:function(){return e.mul(n.sub(r).mul(a))},b:function(){return e.mul(r.sub(n).mul(a))}}}),_N,{},o,[])}}),xM=UT({truncatedNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new hM(t,n,r,!0,a),o=cN(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),wM=UT({equal_:function(e,t){var n,r=_T(e,"a","equal"),a=_T(t,"b","equal");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e){return e.equal(r,a)}),{$a:r,$b:a})}}),kM=UT({equalStrict_:function(e,t){var n=_T(e,"a","equalStrict"),r=_T(t,"b","equalStrict");return oI(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),EM=UT({greater_:function(e,t){var n,r=_T(e,"a","greater"),a=_T(t,"b","greater");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e){return e.greater(r,a)}),{a:r,b:a},null,"Greater")}}),SM=UT({greaterEqual_:function(e,t){var n,r=_T(e,"a","greaterEqual"),a=_T(t,"b","greaterEqual");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e,t){var n=e.greaterEqual(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return nN(n)},b:function(){return nN(r)}}}),"GreaterEqual")}}),CM=UT({greaterEqualStrict_:function(e,t){var n=_T(e,"a","greaterEqualStrict"),r=_T(t,"b","greaterEqualStrict");return oI(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),IM=UT({greaterStrict_:function(e,t){var n=_T(e,"a","greaterStrict"),r=_T(t,"b","greaterStrict");return oI(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),_M=UT({less_:function(e,t){var n,r=_T(e,"a","less"),a=_T(t,"b","less");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e){return e.less(r,a)}),{a:r,b:a},null,"Less")}}),TM=UT({lessEqual_:function(e,t){var n,r=_T(e,"a","lessEqual"),a=_T(t,"b","lessEqual");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e,t){var n=e.lessEqual(r,a);return t([r,a]),n}),{a:r,b:a},null,"LessEqual")}}),NM=UT({lessEqualStrict_:function(e,t){var n=_T(e,"a","lessEqualStrict"),r=_T(t,"b","lessEqualStrict");return oI(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),RM=UT({lessStrict_:function(e,t){var n=_T(e,"a","lessStrict"),r=_T(t,"b","lessStrict");return oI(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),AM=UT({notEqual_:function(e,t){var n,r=_T(e,"a","notEqual"),a=_T(t,"b","notEqual");return n=l_(r,a),r=n[0],a=n[1],FN(r.shape,a.shape),m_.runKernelFunc((function(e){return e.notEqual(r,a)}),{a:r,b:a},null,"NotEqual")}}),OM=UT({notEqualStrict_:function(e,t){var n=_T(e,"a","notEqualStrict"),r=_T(t,"b","notEqualStrict");return oI(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function DM(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function PM(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var MM=UT({gather_:function(e,t,n){void 0===n&&(n=0);var r=_T(e,"x","gather"),a=_T(t,"indices","gather","int32");n=gI(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)a.push(t.shape[s]);for(s=n+1;s<e.rank;s++)a.push(e.shape[s]),o*=e.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return m_.runKernelFunc((function(e,t){var i=e.gather(r,a.flatten(),n);return t([a]),i}),{x:r,indices:a},(function(e,t){var a=t[0];return{x:function(){var t=r.shape,i=a.size,o=t.slice(0,n),s=o.length,u=t.slice(n,t.length).slice(1),c=u.length,l=DM(0,s),f=DM(s+1,s+1+c),h=PM([o,[i],u]),d=e.reshape(h),p=a.reshape([i]),v=PM([[s],l,f]),m=d.transpose(v),g=FM(m,p,r.shape[n]),y=MT(v);return g.transpose(y)},indices:function(){return a}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),FM=UT({unsortedSegmentSum_:function(e,t,n){var r=_T(e,"x","unsortedSegmentSum"),a=_T(t,"segmentIds","unsortedSegmentSum","int32");return iI(fI(n),(function(){return"numSegments must be of dtype int"})),m_.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,a,n);return t([a]),i}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=wR(t,nN(t)),r=MM(e,n),a=SM(t,qT(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=pN(a,o+1);a=GP(a,QT(r.shape,"bool"));var s=nN(r);return QP(a,r,s)}(e,n)}}}))}});function LM(e,t,n,r,a,i,o){void 0===i&&(i="NHWC"),iI(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),iI(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),iI(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),iI(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];iI(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),iI(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&iI(fI(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var h=fA(i),d=nA(s,n.shape,r,1,a,o,!1,h),p=m_.runKernelFunc((function(e,t){var r=e.conv2dDerInput(u,n,d);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return zM(e,n,r,a,i,1,o)},filter:function(){return WM(e,s,n.shape,r,a,i,o)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function BM(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function UM(e,t,n,r,a){iI(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];iI(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),iI(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),iI(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),iI(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),iI(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=rA(i,n.shape,r,1,a),f=m_.runKernelFunc((function(e){return e.conv3dDerInput(o,n,l)}),{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var VM=UT({conv1d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=_T(e,"x","conv1d"),u=_T(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),iI(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),iI(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&iI(fI(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),iI(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),iI(lA(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),iI("NWC"===a,(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),h=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),d=zM(h,f,[1,n],r,"NHWC",[1,i],o);return l?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),zM=UT({conv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=_T(e,"x","conv2d"),u=_T(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),iI(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),iI(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&iI(fI(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var f="NHWC"===a?c.shape[3]:c.shape[1];iI(f===u.shape[2],(function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."})),iI(lA(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var h=fA(a),d=nA(c.shape,u.shape,n,i,r,o,!1,h),p=[u,c],v=m_.runKernelFunc((function(e,t){var n=e.conv2d(c,u,d);return t([u,c]),n}),{x:c,filter:u},(function(e,t){var o=t,s=o[0],u=o[1];return iI(cA(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return HM(u.shape,e,s,n,r,a)},filter:function(){return WM(u,e,s.shape,n,r,a)}}}),"Conv2D",d,p);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),jM=UT({conv3d_:function(e,t,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=_T(e,"x","conv3d"),s=_T(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),iI(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),iI(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),iI(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),iI(function(e,t){return BM(e)||BM(t)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),iI("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var l=rA(u.shape,s.shape,n,i,r),f=m_.runKernelFunc((function(e,t){var n=e.conv3d(u,s,l);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){iI(BM(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var a=t[0],o=t[1];return{x:function(){return UM(a.shape,e,o,n,r)},$filter:function(){return function(e,t,n,r,a){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var o=t;4===o.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),iI(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),iI(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),iI(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),iI(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),iI(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=rA(i.shape,n,r,1,a);return m_.runKernelFunc((function(e){return e.conv3dDerFilter(i,o,s)}),{x5D:i,dy5D:o})}(a,e,o.shape,n,r)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),WM=UT({conv2dDerFilter_:function(e,t,n,r,a,i,o){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),iI(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),iI(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),iI(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];iI(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),iI(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&iI(fI(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var f=fA(i),h=nA(s.shape,n,r,1,a,o,!1,f);return m_.runKernelFunc((function(e){return e.conv2dDerFilter(s,u,h)}),{x4D:s,dy4D:u})}}),HM=UT({conv2dDerInput_:LM}),qM=UT({depthwiseConv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=_T(e,"x","depthwiseConv2d"),u=_T(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),iI(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),iI(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),iI(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),iI(lA(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=o&&iI(fI(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var f=nA(c.shape,u.shape,n,i,r,o,!0),h=[c,u],d=m_.runKernelFunc((function(e,t){var n=e.depthwiseConv2D(c,u,f);return t([c,u]),n}),{x:c,filter:u},(function(e,t){iI(cA(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=t[0],r=t[1];return{x:function(){return GM(n.shape,e,r,f)},filter:function(){return KM(n,e,r.shape,f)}}}),"DepthwiseConv2dNative",f,h);return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),GM=UT({depthwiseConv2dDerInput_:function(e,t,n,r){var a=t,i=!1;3===t.rank&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=m_.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(a,n,r)}),{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),KM=UT({depthwiseConv2dDerFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),m_.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(a,i,r)}),{x4D:a,dy4D:i})}}),XM=UT({separableConv2d_:function(e,t,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=_T(e,"x","separableConv2d"),u=_T(t,"depthwiseFilter","separableConv2d"),c=_T(n,"pointwiseFilter","separableConv2d"),l=s,f=!1;if(3===s.rank&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");iI(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),iI(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),iI(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),iI(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),iI(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var h=u.shape[2],d=u.shape[3];iI(c.shape[2]===h*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*d+", but got "+c.shape[2]+"."}));var p=qM(l,u,r,a,o,i),v=zM(p,c,1,"valid",o);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),$M=UT({conv2dTranspose_:function(e,t,n,r,a,i){return LM(n,_T(e,"x","conv2dTranspose"),_T(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),QM=UT({conv3dTranspose_:function(e,t,n,r,a){return UM(n,_T(e,"x","conv3dTranspose"),_T(t,"filter","conv3dTranspose"),r,a)}}),YM=UT({matMul_:function(e,t,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=_T(e,"a","matMul"),o=_T(t,"b","matMul");a=l_(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=i.shape.slice(0,-2),h=o.shape.slice(0,-2),d=cI(f),p=cI(h);iI(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."})),iI(lI(f,h),(function(){return"Error in matMul: outer dimensions ("+f+") and ("+h+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."})),iI(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=i.shape.slice(0,-2).concat([c,l]),m=n?i.as3D(d,s,c):i.as3D(d,c,s),g=r?o.as3D(p,l,u):o.as3D(p,u,l),y={transposeA:n,transposeB:r};return m_.runKernelFunc((function(e,t){var a=e.batchMatMul(m,g,n,r);return t([m,g]),a}),{a:m,b:g},(function(e,t){var a=t,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return e.matMul(o,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return o.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(o,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}}),"BatchMatMul",y).reshape(v)}}),JM=UT({dot_:function(e,t){var n=_T(e,"t1","dot"),r=_T(t,"t2","dot");iI(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return iI(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ZM=UT({outerProduct_:function(e,t){var n=_T(e,"v1","outerProduct"),r=_T(t,"v2","outerProduct");return iI(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),eF=UT({reverse_:function(e,t){var n=_T(e,"x","reverse");if(0===n.rank)return n.clone();var r=gI(t,n.shape);return m_.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),tF=UT({reverse1d_:function(e){var t=_T(e,"x","reverse");return iI(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),eF(t,0)}}),nF=UT({reverse2d_:function(e,t){var n=_T(e,"x","reverse");return iI(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),eF(n,t)}}),rF=UT({reverse3d_:function(e,t){var n=_T(e,"x","reverse");return iI(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),eF(n,t)}}),aF=UT({reverse4d_:function(e,t){var n=_T(e,"x","reverse");return iI(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),eF(n,t)}});function iF(e,t,n,r,a,i){var o=_T(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),iI(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),iI(lA(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&iI(fI(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=eA(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&lI(c.inShape,c.outShape))return o.clone();var l=[s],f=m_.runKernelFunc((function(e,t){var n=e.maxPool(s,c);return t([s,n]),n}),{x:s},(function(e,i){var o=i[0],s=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var u=_T(e,"dy","maxPoolBackprop"),c=_T(t,"input","maxPoolBackprop"),l=_T(n,"output","maxPoolBackprop");iI(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),iI(lA(a,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),iI(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),iI(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var f=eA(c.shape,r,a,i,o,s);return m_.runKernelFunc((function(e){return e.maxPoolBackprop(u,c,l,f)}),{$dy:u,$input:c})}(e,o,s,t,n,r,a)}}}),"MaxPool",c,l);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function oF(e,t,n,r,a,i){var o=_T(e,"x","avgPool","float32");null==r&&(r=[1,1]),iI(lA(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),iI(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&iI(fI(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=eA(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&lI(c.inShape,c.outShape))return o.clone();var l=m_.runKernelFunc((function(e){return e.avgPool(s,c)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,a,i){var o=_T(e,"dy","avgPoolBackprop"),s=_T(t,"input","avgPoolBackprop");iI(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==a&&(a=[1,1]),iI(lA(r,a),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),iI(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),iI(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var f=eA(u.shape,n,r,a,i),h=m_.runKernelFunc((function(e){return e.avgPoolBackprop(c,u,f)}),{dy4D:c,input4D:u});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}(e,s,t,n,r,a)}}}),"AvgPool",c);return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var sF=UT({maxPool_:function(e,t,n,r,a){return iF(e,t,n,1,r,a)}}),uF=UT({avgPool_:function(e,t,n,r,a){return oF(e,t,n,1,r,a)}}),cF=UT({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=_T(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),iI(lA(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var c,l=eA(s.shape,t,i,a,r),f=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([l.filterHeight,l.filterWidth],f):[[0,0],[0,0]];var h=1===f[0]&&1===f[1],d=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,o[t]]}))]}([l.inHeight,l.inWidth],f,c),p=d[0],v=d[1],m=h?r:"valid",g=h?s:mN(s,f,p),y=("avg"===n?function(){return oF(g,t,i,1,m)}:function(){return iF(g,t,i,1,m)})(),b=h?y:lN(y,f,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),lF=UT({maxPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=_T(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),iI(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),iI("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),iI(lA(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&iI(fI(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=tA(u.shape,t,n,o,r,a,i),f=m_.runKernelFunc((function(e,t){var n=e.maxPool3d(u,l);return t([u,n]),n}),{x:u},(function(e,i){var s=i[0],u=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var u=_T(e,"dy","maxPool3dBackprop"),c=_T(t,"input","maxPool3dBackprop"),l=_T(n,"output","maxPool3dBackprop"),f=u,h=c,d=l,p=!1;4===c.rank&&(p=!0,f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),h=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),iI(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+f.rank+"."})),iI(5===h.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+h.rank+"."})),iI(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+d.rank+"."})),null==i&&(i=[1,1,1]),iI(lA(a,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),null!=s&&iI(fI(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var v=tA(h.shape,r,a,i,o,s),m=m_.runKernelFunc((function(e){return e.maxPool3dBackprop(f,h,d,v)}),{dy5D:f,input5D:h});return p?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,u,t,n,o,r,a)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),fF=UT({avgPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=_T(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),iI(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),iI("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),iI(lA(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&iI(fI(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=tA(u.shape,t,n,o,r,a,i),f=m_.runKernelFunc((function(e){return e.avgPool3d(u,l)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,a,i,o){var s=_T(e,"dy","avgPool3dBackprop"),u=_T(t,"input","avgPool3dBackprop"),c=s,l=u,f=!1;4===u.rank&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),iI(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),iI(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==a&&(a=[1,1,1]),iI(lA(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"})),null!=o&&iI(fI(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=tA(l.shape,n,r,a,i,o),d=m_.runKernelFunc((function(e){return e.avgPool3dBackprop(c,l,h)}),{dy5D:c,input5D:l});return f?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}(e,u,t,n,o,r,a)}}}));return f=f.cast(u.dtype),c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),hF=UT({maxPoolWithArgmax_:function(e,t,n,r,a){void 0===a&&(a=!1);var i=_T(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=m_.runKernel("MaxPoolWithArgmax",{x:i},o);return{result:s[0],indexes:s[1]}}}),dF=UT({slice_:function(e,t,n){var r,a,i=_T(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){iI(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(iI(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),i.shape[t]-r[t])})),VR(i,r,a);var o=i.shape,s={begin:r,size:a};return m_.runKernelFunc((function(e){return e.slice(i,r,a)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return rM(e,t)}}}),"Slice",s)}}),pF=UT({slice1d_:function(e,t,n){var r=_T(e,"x","slice1d");return iI(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),dF(r,[t],[n])}}),vF=UT({slice2d_:function(e,t,n){var r=_T(e,"x","slice2d");return iI(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),dF(r,t,n)}}),mF=UT({slice3d_:function(e,t,n){var r=_T(e,"x","slice3d");return iI(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),dF(r,t,n)}}),gF=UT({slice4d_:function(e,t,n){var r=_T(e,"x","slice4d");return iI(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),dF(r,t,n)}});function yF(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(OT(t.shape,r))),e.rank<n.rank&&(e=e.reshape(OT(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==a?r:r.transpose(a)}}}var bF=UT({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","all","bool"),a=gI(t,r.shape),i=a,o=PT(i,r.rank);null!=o&&(r=r.transpose(o),i=FT(i.length,r.rank));var s=m_.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=OT(s.shape,a);return s.reshape(u)}return s}}),xF=UT({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","any","bool"),a=gI(t,r.shape),i=a,o=PT(i,r.rank);null!=o&&(r=r.transpose(o),i=FT(i.length,r.rank));var s=m_.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=OT(s.shape,a);return s.reshape(u)}return s}}),wF=UT({argMax_:function(e,t){void 0===t&&(t=0);var n=_T(e,"x","argMax");null==t&&(t=0);var r=gI(t,n.shape),a=PT(r,n.rank);null!=a&&(n=n.transpose(a),r=FT(r.length,n.rank));var i={axis:r[0]},o=[n];return m_.runKernelFunc((function(e,t){var a=e.argMax(n,r[0]);return t([n]),a}),{x:n},(function(e,t){var n=t[0];return{x:function(){return nN(n)}}}),"ArgMax",i,o)}}),kF=UT({argMin_:function(e,t){void 0===t&&(t=0);var n=_T(e,"x","argMin");null==t&&(t=0);var r=gI(t,n.shape),a=PT(r,n.rank);return null!=a&&(n=n.transpose(a),r=FT(r.length,n.rank)),m_.runKernelFunc((function(e,t){var a=e.argMin(n,r[0]);return t([n]),a}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return nN(n)}}}))}}),EF=UT({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","logSumExp"),a=gI(t,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var u=OT(s.shape,a);return s.reshape(u)}return s}}),SF=UT({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","max"),a=r,i=gI(t,r.shape),o=i,s=PT(o,r.rank);null!=s&&(r=r.transpose(s),o=FT(o.length,r.rank));var u=[r],c=m_.runKernelFunc((function(e,t){var n=e.max(r,o);return t([a,n]),n}),{x:r},(function(e,t){return yF(e,t[1],t[0],i,s)}),"Max",{axes:o},u,[!0]);if(n){var l=OT(c.shape,i);c=c.reshape(l)}return c}}),CF=UT({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","mean"),a=gI(t,r.shape),i=cI(AT(r.shape,a)[1]);return KR((function(e){var r=qT(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(QT(e.shape,"float32")).div(i)}}}))(r)}}),IF=UT({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","min"),a=r,i=gI(t,r.shape),o=i,s=PT(o,r.rank);null!=s&&(r=r.transpose(s),o=FT(o.length,r.rank));var u=[r],c=m_.runKernelFunc((function(e,t){var n=e.min(r,o);return t([a,n]),n}),{x:r},(function(e,t){return yF(e,t[1],t[0],i,s)}),"Min",{axes:o},u,[!0]);if(n){var l=OT(c.shape,i);c=c.reshape(l)}return c}}),_F=UT({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=gI(t,(e=_T(e,"x","moments")).shape),a=e.mean(r,n),i=a.shape;n||(i=OT(a.shape,r));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),TF=UT({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=gI(t,r.shape);return KR((function(e){var t=PT(a,e.rank),r=a,i=e;null!=t&&(i=e.transpose(t),r=FT(r.length,e.rank));var o=function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(QT(e.shape,"float32"))},s={axes:r},u=m_.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return o(e)}}}),"Sum",s);if(n){var c=OT(u.shape,a);u=u.reshape(c)}return{value:u,gradFunc:o}}))(r)}}),NF=UT({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_T(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=gI(t,r.shape),i=PT(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=FT(o.length,r.rank));var u=m_.runKernelFunc((function(e){return e.prod(s,o)}),{permutedX:s});if(n){var c=OT(u.shape,a);u=u.reshape(c)}return u}}),RF=UT({elu_:function(e){var t=_T(e,"x","elu");return m_.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return m_.runKernelFunc((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),AF=UT({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=_T(e,"x","leakyRelu");return wR(qT(t).mul(n),n)}}),OF=UT({prelu_:function(e,t){var n=_T(e,"x","prelu"),r=_T(t,"alpha","prelu");return m_.runKernelFunc((function(e,t){var a=e.prelu(n,r);return t([n,r]),a}),{x:n,alpha:r},(function(e,t){var n=t[0],r=t[1],a=n.greater(0);return{x:function(){return QP(a,e,e.mul(r))},alpha:function(){var t=QP(a,nN(e),e.mul(n)),i=MN(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}}),"Prelu")}}),DF=UT({relu_:function(e){var t=_T(e,"x","relu");return"bool"===t.dtype?t.toInt():m_.runKernelFunc((function(e,n){var r=e.relu(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}}),"Relu")}}),PF=UT({relu6_:function(e){var t=_T(e,"x","relu6");return"bool"===t.dtype?t.toInt():m_.runKernelFunc((function(e,n){var r=e.relu6(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}}),"Relu6")}}),MF=UT({selu_:function(e){var t=_T(e,"x","selu");return m_.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(qT(0)),r=qT(jD),a=qT(WD),i=e.mul(a),o=e.mul(r).mul(n.toFloat().exp());return QP(t,i,o)}}}))}}),FF=UT({localResponseNormalization_:function(e,t,n,r,a){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=_T(e,"x","localResponseNormalization");iI(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),iI(fI(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=m_.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(o,t,n,r,a);return i([o,s]),s}),{x4D:o},(function(e,i){var o=i[0],s=i[1];return{x4D:function(){return m_.runKernelFunc((function(i){return i.LRNGrad(e,o,s,t,n,r,a)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),LF=UT({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(qT(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=_T(e,"x","norm"),t,n),i=a.shape;if(r){var o=gI(n,e.shape);i=OT(a.shape,o)}return a.reshape(i)}}),BF=UT({basicLSTMCell_:function(e,t,n,r,a,i){var o=_T(e,"forgetBias","basicLSTMCell"),s=_T(t,"lstmKernel","basicLSTMCell"),u=_T(n,"lstmBias","basicLSTMCell"),c=_T(r,"data","basicLSTMCell"),l=_T(a,"c","basicLSTMCell"),f=_T(i,"h","basicLSTMCell"),h=c.concat(f,1).matMul(s).add(u),d=h.shape[0],p=h.shape[1]/4,v=[d,p],m=h.slice([0,0],v),g=h.slice([0,p],v),y=h.slice([0,2*p],v),b=h.slice([0,3*p],v),x=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),UF=UT({multiRNNCell_:function(e,t,n,r){for(var a=_T(t,"data","multiRNNCell"),i=TT(n,"c","multiRNNCell"),o=TT(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var f=[],h=[];for(c=0;c<u.length;c+=2)f.push(u[c]),h.push(u[c+1]);return[f,h]}}),VF=UT({movingAverage_:function(e,t,n,r,a){void 0===a&&(a=!0);var i=_T(e,"v","movingAverage"),o=_T(t,"x","movingAverage"),s=_T(n,"decay","movingAverage");f_(i,o),iI(lI(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=qT(1),c=u.sub(s),l=o.sub(i).mul(c);if(a){iI(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=_T(r,"step","movingAverage");l=l.div(u.sub(NR(s,f)))}return i.add(l)}}),zF=UT({stridedSlice_:function(e,t,n,r,a,i,o,s,u){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=_T(e,"x","stridedSlice"),l=zR(s),f=c.shape.slice();l.forEach((function(e){t[e]=0,n[e]=1,f.splice(e,0,1)})),c=c.reshape(f);for(var h=0;h<c.rank;h++)t[h]=WR(a,t,r,c.shape,h),n[h]=HR(i,n,r,c.shape,h),r[h]=r[h]||1;var d=zR(u);d.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var p=jR(t,n,r),v=p.filter((function(e,t){return-1===d.indexOf(t)}));return r.every((function(e){return 1===e}))?dF(c,t,p).reshape(v):m_.runKernelFunc((function(e){return e.stridedSlice(c,t,n,r)}),{$x:c}).reshape(v)}}),jF=UT({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=_T(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=m_.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),WF=UT({scatterND_:function(e,t,n){var r=_T(e,"indices","scatterND","int32"),a=_T(t,"updates","scatterND");return BR(a,r,n),m_.runKernelFunc((function(e){return e.scatterND(r,a,n)}),{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),HF=UT({fft_:function(e){iI("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return m_.runKernelFunc((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),qF=UT({ifft_:function(e){iI("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return m_.runKernelFunc((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),GF=UT({rfft_:function(e,t){iI("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(YT(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=VT(n,u).as2D(a,r),l=HF(c),f=Math.floor(r/2)+1,h=zT(l),d=jT(l),p=h.split([f,r-f],h.shape.length-1),v=d.split([f,r-f],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,VT(p[0],v[0]).reshape(m)}}),KF=UT({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=qF(r);return zT(a)}var i=[n,2*(t-1)],o=zT(e).as2D(n,t),s=jT(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(qT(-1)),l=o.concat(u,1),f=s.concat(c,1);return r=VT(l,f).as2D(i[0],i[1]),a=qF(r),zT(a)}}),XF=Object.freeze({fft:HF,ifft:qF,rfft:GF,irfft:KF}),$F=UT({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var a=_T(e,"sparseIndices","sparseToDense","int32"),i=_T(t,"sparseValues","sparseToDense"),o=_T(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+a+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),m_.runKernelFunc((function(e){return e.sparseToDense(a,i,n,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),QF=UT({gatherND_:function(e,t){var n=_T(t,"indices","gatherND","int32"),r=_T(e,"x","gatherND");return m_.runKernelFunc((function(e){return e.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),YF=UT({diag_:function(e){var t=_T(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return m_.runKernelFunc((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),JF=UT({dropout_:function(e,t,n,r){var a=_T(e,"x","dropout");if(iI("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),iI(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof e_?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(lI(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=gM(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function ZF(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return GT(a,"float32")}var eL,tL=UT({hannWindow_:function(e){return ZF(e,.5,.5)}}),nL=UT({hammingWindow_:function(e){return ZF(e,.54,.46)}}),rL=UT({frame_:function(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+t<=e.size;)o.push(dF(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=rN([dF(e,i,t-s),JT([s],a)]);o.push(u),i+=n}return 0===o.length?KT([],[0,t]):rN(o).as2D(o.length,t)}}),aL=UT({stft_:function(e,t,n,r,a){var i;void 0===a&&(a=tL),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=rL(e,t,n),s=_R(o,a(t)),u=[],c=0;c<o.shape[0];c++)u.push(GF(s.slice([c,0],[1,t]),r));return rN(u)}}),iL=Object.freeze({hannWindow:tL,hammingWindow:nL,frame:rL,stft:aL});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(eL||(eL={}));var oL=UT({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=eL.SUM_BY_NONZERO_WEIGHTS);var a=_T(e,"labels","absoluteDifference"),i=_T(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=_T(n,"weights","absoluteDifference")),oI(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return sL(s,o,r)}}),sL=UT({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=eL.SUM_BY_NONZERO_WEIGHTS);var r=_T(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=_T(t,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===eL.NONE)return i;if(n===eL.SUM)return i.sum();if(n===eL.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(qT(o)):s}if(n===eL.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(qT(r.size));var u=a.mul(QT(r.shape)).notEqual(qT(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),uL=UT({cosineDistance_:function(e,t,n,r,a){void 0===a&&(a=eL.SUM_BY_NONZERO_WEIGHTS);var i=_T(e,"labels","cosineDistance"),o=_T(t,"predictions","cosineDistance"),s=null;null!=r&&(s=_T(r,"weights","cosineDistance")),oI(i.shape,o.shape,"Error in cosineDistance: ");var u=qT(1).sub(i.mul(o).sum(n,!0));return sL(u,s,a)}}),cL=UT({hingeLoss_:function(e,t,n,r){void 0===r&&(r=eL.SUM_BY_NONZERO_WEIGHTS);var a=_T(e,"labels","hingeLoss"),i=_T(t,"predictions","hingeLoss"),o=null;null!=n&&(o=_T(n,"weights","hingeLoss")),oI(a.shape,i.shape,"Error in hingeLoss: ");var s=qT(1);a=qT(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return sL(u,o,r)}}),lL=UT({huberLoss_:function(e,t,n,r,a){void 0===r&&(r=1),void 0===a&&(a=eL.SUM_BY_NONZERO_WEIGHTS);var i=_T(e,"labels","huberLoss"),o=_T(t,"predictions","huberLoss"),s=null;null!=n&&(s=_T(n,"weights","huberLoss")),oI(i.shape,o.shape,"Error in huberLoss: ");var u=qT(r),c=o.sub(i).abs(),l=ER(c,u),f=c.sub(l),h=qT(.5).mul(l.square()).add(u.mul(f));return sL(h,s,a)}}),fL=UT({logLoss_:function(e,t,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=eL.SUM_BY_NONZERO_WEIGHTS);var i=_T(e,"labels","logLoss"),o=_T(t,"predictions","logLoss"),s=null;null!=n&&(s=_T(n,"weights","logLoss")),oI(i.shape,o.shape,"Error in logLoss: ");var u=qT(1),c=qT(r),l=i.mul(o.add(c).log()).neg().sub(u.sub(i).mul(u.sub(o).add(c).log()));return sL(l,s,a)}}),hL=UT({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=eL.SUM_BY_NONZERO_WEIGHTS);var a=_T(e,"labels","meanSquaredError"),i=_T(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=_T(n,"weights","meanSquaredError")),oI(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return sL(s,o,r)}}),dL=UT({sigmoidCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=eL.SUM_BY_NONZERO_WEIGHTS);var i=_T(e,"multiClassLabels","sigmoidCrossEntropy"),o=_T(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=_T(n,"weights","sigmoidCrossEntropy")),oI(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=qT(r),c=qT(1),l=qT(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var f=function(e,t){var n=_T(e,"labels","sigmoidCrossEntropyWithLogits"),r=_T(t,"logits","sigmoidCrossEntropyWithLogits");oI(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return sL(f,s,a)}}),pL=UT({softmaxCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=eL.SUM_BY_NONZERO_WEIGHTS);var i=_T(e,"onehotLabels","softmaxCrossEntropy"),o=_T(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=_T(n,"weights","softmaxCrossEntropy")),oI(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=qT(r),c=qT(1),l=qT(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var f=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return KR((function(e,t,r){var a=t.logSumExp([n],!0),i=t.toFloat().sub(a);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],a=t[1],i=OT(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(a.exp())),e.reshape(i).mul(a.exp().sub(r.toFloat()))]}}}))(e,t)}(i,o);return sL(f,s,a)}}),vL=Object.freeze({get Reduction(){return eL},absoluteDifference:oL,computeWeightedLoss:sL,cosineDistance:uL,hingeLoss:cL,huberLoss:lL,logLoss:fL,meanSquaredError:hL,sigmoidCrossEntropy:dL,softmaxCrossEntropy:pL});function mL(e,t){return void 0===t&&(t=!1),m_.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],a=eM(n),i=e.clone(),o=KT([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=a;t=m_.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),c=i.slice([e,e],[1,1]),l=KT([[-1]]).where(c.greater(0),KT([[1]])),f=c.sub(l.mul(u)),h=t.div(f);s=1===h.shape[0]?o.clone():o.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var d=l.matMul(f).div(u).neg(),p=i.slice([e,0],[n-e,r]),v=d.mul(s),m=s.transpose();if(0===e)i=p.sub(v.matMul(m.matMul(p)));else{var g=p.sub(v.matMul(m.matMul(p)));i=i.slice([0,0],[e,r]).concat(g,0)}var y=v.transpose(),b=a.slice([0,e],[n,a.shape[1]-e]);if(0===e)a=b.sub(b.matMul(s).matMul(y));else{var x=b.sub(b.matMul(s).matMul(y));a=a.slice([0,0],[n,e]).concat(x,1)}return[s,i,a]})),s=t[0],i=t[1],a=t[2],ET([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]}))}var gL=UT({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=_T(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=eN(0,o,1,"int32").reshape([-1,1]),c=eN(0,s,1,"int32"),l=OR(u,c),f=GP(l.lessEqual(qT(+t,"int32")),l.greaterEqual(qT(-n,"int32"))),h=YT([o,s],r.dtype);return yN(bN(r.reshape([-1,o,s])).map((function(e){return QP(f,e,h)}))).reshape(a)}}),yL=UT({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,iI(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){iI(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},a=1;a<e.length;++a)r(a)}else t=!0,e=uN(e,e.shape[0],0).map((function(e){return gN(e,[0])}));iI(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var i=[],o=e,s=function(e){i.push(m_.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=TF(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(LF(t,"euclidean"))})))};for(a=0;a<e.length;++a)s(a);return t?yN(i,0):i}}),bL=UT({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return mL(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=bN(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=mL(e,t),r=n[0],o=n[1];a.push(r),i.push(o)})),[yN(a,0).reshape(e.shape),yN(i,0).reshape(e.shape)]}}),xL=Object.freeze({bandPart:gL,gramSchmidt:yL,qr:bL});function wL(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),iI(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),iI(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),iI(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),iI(1===t.rank,(function(){return"scores must be a 1D tensor"})),iI(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]})),iI(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var kL=UT({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=_T(e,"images","resizeBilinear");iI(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),iI(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=m_.runKernelFunc((function(e,t){return t([a]),e.resizeBilinear(a,o,s,n)}),{x:a},(function(e,t){return{x:function(){return m_.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),EL=UT({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=_T(e,"images","resizeNearestNeighbor");iI(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),iI(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),iI("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=m_.runKernelFunc((function(e,t){return t([a]),e.resizeNearestNeighbor(a,o,s,n)}),{batchImages:a},(function(e,t){return{batchImages:function(){return m_.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),SL=UT({nonMaxSuppression_:function(e,t,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=_T(e,"boxes","nonMaxSuppression"),o=_T(t,"scores","nonMaxSuppression"),s=wL(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return m_.runKernelFunc((function(e){return e.nonMaxSuppression(i,o,n,r,a)}),{boxes:i,scores:o},null,"NonMaxSuppressionV3",u)}}),CL=UT({nonMaxSuppressionWithScore_:function(e,t,n,r,a,i){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var o=_T(e,"boxes","nonMaxSuppression"),s=_T(t,"scores","nonMaxSuppression"),u=wL(o,s,n,r,a,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=m_.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),IL=UT({cropAndResize_:function(e,t,n,r,a,i){var o=_T(e,"image","cropAndResize"),s=_T(t,"boxes","cropAndResize","float32"),u=_T(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return iI(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),iI(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),iI(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),iI(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),iI(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),iI("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was "+a})),m_.runKernelFunc((function(e,t){return e.cropAndResize(o,s,u,r,a,i)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),_L=Object.freeze({resizeBilinear:kL,resizeNearestNeighbor:EL,nonMaxSuppression:SL,nonMaxSuppressionAsync:function(e,t,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),zC(this,void 0,void 0,(function(){var i,o,s,u,c,l,f;return jC(this,(function(h){switch(h.label){case 0:return i=_T(e,"boxes","nonMaxSuppressionAsync"),o=_T(t,"scores","nonMaxSuppressionAsync"),s=wL(i,o,n,r,a),n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return u=h.sent(),c=u[0],l=u[1],f=wA(c,l,n,r,a),i!==e&&i.dispose(),o!==t&&o.dispose(),[2,f]}}))}))},nonMaxSuppressionWithScore:CL,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,a,i){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),zC(this,void 0,void 0,(function(){var o,s,u,c,l,f,h;return jC(this,(function(d){switch(d.label){case 0:return o=_T(e,"boxes","nonMaxSuppressionAsync"),s=_T(t,"scores","nonMaxSuppressionAsync"),u=wL(o,s,n,r,a,i),n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return c=d.sent(),l=c[0],f=c[1],h=kA(l,f,n,r,a,i),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,h]}}))}))},cropAndResize:IL}),TL=function(e,t){return!(e>0)||"linear"===t},NL=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},RL=function(e,t){var n=t,r=MN(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},AL=function(e,t,n){if("linear"===t)return e;if("relu"===t)return DF(e);if("elu"===t)return RF(e);if("relu6"===t)return PF(e);if("prelu"===t)return OF(e,n);throw new Error("Unknown fused activation "+t+".")},OL=UT({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,i=void 0!==a&&a,o=e.transposeB,s=void 0!==o&&o,u=e.bias,c=e.activation,l=void 0===c?"linear":c,f=e.preluActivationWeights;if(!1===TL(m_.state.gradientDepth,l)){var h=YM(n,r,i,s);return null!=u&&(h=DN(h,u)),AL(h,l,f)}var d=_T(n,"a","fused matMul"),p=_T(r,"b","fused matMul");t=l_(d,p),d=t[0],p=t[1];var v=i?d.shape[d.rank-2]:d.shape[d.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],g=i?d.shape[d.rank-1]:d.shape[d.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=d.shape.slice(0,-2),x=p.shape.slice(0,-2),w=cI(b),k=cI(x);iI(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+d.rank+" and "+p.rank+"."})),iI(lI(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+d.shape+" and "+p.shape+" must match."})),iI(v===m,(function(){return"Error in fused matMul: inner shapes ("+v+") and ("+m+") of Tensors with shapes "+d.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var E,S,C=d.shape.slice(0,-2).concat([g,y]),I=i?d.as3D(w,v,g):d.as3D(w,g,v),_=s?p.as3D(k,y,m):p.as3D(k,m,y);null!=u&&FN(C,(E=l_(E=_T(u,"bias","fused matMul"),d)[0]).shape),null!=f&&(S=_T(f,"prelu weights","fused matMul"));var T={a:I,b:_};null!=u&&(T.bias=E),null!=f&&(T.preluActivationWeights=S);var N=[I,_];return m_.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:I,b:_,transposeA:i,transposeB:s,bias:E,activation:l,preluActivationWeights:S});return t([I,_,n]),n}),T,(function(e,t){var n=t[0],r=t[1],a=t[2],o=NL(e,a,l),c={};return null!=u&&(c={bias:function(){return RL(E,o)}}),i||s?!i&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},N,[!0]).reshape(C)}}),DL=UT({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,d=e.preluActivationWeights;if(h=h||"linear",!1===TL(m_.state.gradientDepth,h)){var p=zM(t,n,r,a,o,u,c);return null!=l&&(p=DN(p,l)),AL(p,h,d)}var v=_T(t,"x","conv2d"),m=_T(n,"filter","conv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),iI(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),iI(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=c&&iI(fI(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."})),iI(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),iI(lA(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),iI("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var b,x,w=nA(g.shape,m.shape,r,u,a,c);null!=l&&(b=l_(b=_T(l,"bias","fused conv2d"),v)[0],FN(w.outShape,b.shape)),null!=d&&(x=_T(d,"prelu weights","fused conv2d"));var k={x:g,filter:m};null!=l&&(k.bias=b),null!=d&&(k.preluActivationWeights=x);var E=[m,g],S=m_.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:g,filter:m,convInfo:w,bias:b,activation:h,preluActivationWeights:x});return t([m,g,n]),n}),k,(function(e,t){var n=t,i=n[0],o=n[1],s=n[2],c=NL(e,s,h);iI(cA(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var f={};return null!=l&&(f={bias:function(){return RL(b,c)}}),Object.assign({x:function(){return HM(o.shape,c,i,r,a)},filter:function(){return WM(o,c,i.shape,r,a)}},f)}),"FusedConv2D",{convInfo:w,activation:h},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),PL=UT({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,d=e.preluActivationWeights;if(!1===TL(m_.state.gradientDepth,h)){var p=qM(t,n,r,a,o,u,c);return null!=l&&(p=DN(p,l)),AL(p,h,d)}var v=_T(t,"x","depthwiseConv2d"),m=_T(n,"filter","depthwiseConv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),iI(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),iI(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."})),iI(g.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."})),null==u&&(u=[1,1]),iI(lA(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&iI(fI(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."}));var b,x,w=nA(g.shape,m.shape,r,u,a,c,!0);null!=l&&(b=l_(b=_T(l,"bias","fused conv2d"),v)[0],FN(w.outShape,b.shape)),null!=d&&(x=_T(d,"prelu weights","fused depthwiseConv2d"));var k={x:g,filter:m};null!=l&&(k.bias=b),null!=d&&(k.preluActivationWeights=x);var E=[m,g],S=m_.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:g,filter:m,convInfo:w,bias:b,activation:h,preluActivationWeights:x});return t([m,g,n]),n}),k,(function(e,t){iI(cA(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=t[0],r=t[1],a=t[2],i=NL(e,a,h),o={};return null!=l&&(o={bias:function(){return RL(b,i)}}),Object.assign({x:function(){return GM(r.shape,i,n,w)},filter:function(){return KM(r,i,n.shape,w)}},o)}),"FusedDepthwiseConv2D",{convInfo:w,activation:h},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),ML=Object.freeze({matMul:OL,conv2d:DL,depthwiseConv2d:PL}),FL=Object.freeze({image:_L,linalg:xL,losses:vL,spectral:XF,fused:ML,signal:iL,add:DN,addN:TP,batchNorm:PP,batchNormalization:DP,batchNorm2d:LP,batchNormalization2d:FP,batchNorm3d:VP,batchNormalization3d:UP,batchNorm4d:WP,batchNormalization4d:jP,broadcastTo:HP,clone:qP,div:PR,divNoNan:JP,eye:eM,multinomial:tM,oneHot:nM,pad:rM,pad1d:aM,pad2d:iM,pad3d:oM,pad4d:sM,rand:uM,randomGamma:vM,randomNormal:mM,randomUniform:gM,square:yM,squaredDifference:bM,tile:ZP,truncatedNormal:xM,conv1d:VM,conv2d:zM,conv3d:jM,depthwiseConv2d:qM,separableConv2d:XM,conv2dTranspose:$M,conv3dTranspose:QM,op:UT,booleanMaskAsync:function(e,t,n){return zC(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,d,p,v;return jC(this,(function(m){switch(m.label){case 0:for(r=_T(e,"tensor","boolMask"),a=_T(t,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape,iI(o>0,(function(){return"mask cannot be scalar"})),oI(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+o;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+o)),f=r.reshape(l),h=a.reshape([-1]),[4,YP(h)];case 1:return d=m.sent(),p=d.squeeze([1]),v=MM(f,p,i),e!==r&&r.dispose(),t!==a&&a.dispose(),p.dispose(),f.dispose(),h.dispose(),d.dispose(),[2,v]}}))}))},complex:VT,real:zT,imag:jT,concat:rN,concat1d:aN,concat2d:iN,concat3d:oN,concat4d:sN,split:uN,matMul:YM,dot:JM,outerProduct:ZM,reverse:eF,reverse1d:tF,reverse2d:nF,reverse3d:rF,reverse4d:aF,maxPool:sF,avgPool:uF,pool:cF,maxPool3d:lF,avgPool3d:fF,maxPoolWithArgmax:hF,slice:dF,slice1d:pF,slice2d:vF,slice3d:mF,slice4d:gF,abs:LN,acos:BN,acosh:UN,asin:VN,asinh:zN,atan:jN,atanh:WN,ceil:HN,clipByValue:qN,cos:GN,cosh:KN,erf:XN,exp:$N,expm1:QN,floor:YN,log:JN,log1p:ZN,logSigmoid:eR,neg:tR,reciprocal:nR,round:rR,rsqrt:aR,sigmoid:iR,sign:oR,isNaN:sR,isInf:uR,isFinite:cR,sin:lR,sinh:fR,softplus:hR,sqrt:dR,step:pR,tan:vR,tanh:mR,all:bF,any:xF,argMax:wF,argMin:kF,logSumExp:EF,max:SF,mean:CF,min:IF,moments:_F,sum:TF,prod:NF,equal:wM,equalStrict:kM,greater:EM,greaterEqual:SM,greaterEqualStrict:CM,greaterStrict:IM,less:_M,lessEqual:TM,lessEqualStrict:NM,lessStrict:RM,notEqual:AM,notEqualStrict:OM,addStrict:gR,atan2:yR,divStrict:bR,floorDiv:xR,maximum:wR,maximumStrict:kR,minimum:ER,minimumStrict:SR,mod:CR,modStrict:IR,mul:_R,mulStrict:TR,pow:NR,powStrict:RR,squaredDifferenceStrict:AR,sub:OR,subStrict:DR,elu:RF,leakyRelu:AF,prelu:OF,relu:DF,relu6:PF,selu:MF,logicalAnd:GP,logicalNot:KP,logicalOr:XP,logicalXor:$P,where:QP,whereAsync:YP,buffer:cN,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:lN,cast:fN,cumsum:hN,depthToSpace:dN,expandDims:pN,reshape:vN,spaceToBatchND:mN,squeeze:gN,stack:yN,unstack:bN,setdiff1dAsync:xN,fill:JT,linspace:ZT,ones:QT,range:eN,scalar:qT,tensor:WT,tensor1d:GT,tensor2d:KT,tensor3d:XT,tensor4d:$T,tensor5d:function(e,t,n){if(sI(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=CT(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return HT(e,t,r,n)},tensor6d:function(e,t,n){if(sI(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=CT(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return HT(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),m_.makeVariable(e,t,n,r)},zeros:YT,onesLike:tN,zerosLike:nN,transpose:QR,softmax:XR,logSoftmax:$R,localResponseNormalization:FF,norm:LF,gather:MM,unsortedSegmentSum:FM,basicLSTMCell:BF,multiRNNCell:UF,movingAverage:VF,stridedSlice:zF,topk:jF,scatterND:WF,fft:HF,ifft:qF,rfft:GF,irfft:KF,sparseToDense:$F,gatherND:QF,diag:YF,dropout:JF,hannWindow:tL,hammingWindow:nL,frame:rL,stft:aL,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),zC(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,d,p,v,m;return jC(this,(function(g){switch(g.label){case 0:return r=_T(e,"predictions","inTopK"),a=_T(t,"targets","inTopK"),iI(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),iI(r.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank})),oI(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],iI(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return o=g.sent(),[4,a.data()];case 2:for(s=g.sent(),u=[o.length/i,i],l=u[1],f=bI("bool",c=u[0]),h=0;h<c;h++){for(d=h*l,p=o.subarray(d,d+l),v=[],m=0;m<p.length;m++)v.push({value:p[m],index:m});for(v.sort((function(e,t){return t.value-e.value})),f[h]=0,m=0;m<n;m++)if(v[m].index===s[h]){f[h]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),[2,WT(f,a.shape,"bool")]}}))}))}});function LL(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&iI("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))}function BL(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,h=a.padInfo.top,d=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=cN(a.outShape,n),m=v.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var w=x*g,k=x*r[0],E=0;E<a.inChannels;++E)for(var S=0;S<a.outHeight;++S)for(var C=S*o-h,I=Math.max(0,C),_=Math.min(a.inHeight,l+C),T=w+S*y,N=0;N<a.outWidth;++N){for(var R=N*s-d,A=Math.max(0,R),O=Math.min(a.inWidth,f+R),D=p,P=0,M=0,F=I;F<_;F+=u){for(var L=k+F*r[1],B=A;B<O;B+=c){var U=e[L+B*r[2]+E];"max"===i&&U>D?D=U:"avg"===i&&(P+=U,M++)}if(isNaN(D))break}m[T+N*b+E]="avg"===i?P/M:D}return v}function UL(e,t,n,r,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1);for(var o=cN(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,v=cN(t,n,e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-d,x=b;x<0;)x+=c;for(var w=Math.min(r.inHeight,f+b),k=0;k<r.outWidth;++k){for(var E=k*u-p,S=E;S<0;)S+=l;for(var C=Math.min(r.inWidth,h+E),I=Number.NEGATIVE_INFINITY,_=-1,T=x;T<w;T+=c)for(var N=T-b,R=S;R<C;R+=l){var A=R-E,O=v.get(m,T,R,g);O>I&&(I=O,_=a?i?((m*r.inHeight+T)*r.inWidth+R)*r.inChannels+g:(T*r.inWidth+R)*r.inChannels+g:N*h+A)}o.set(_,m,y,k,g)}}return o}function VL(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var zL=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new YR(t,m_),t}return VC(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,qC().get("IS_NODE")&&ST("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?vA(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return zI(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return cN(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return m_.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){return t=BI(),e(),[2,{kernelMs:BI()-t}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:m_.keep(e.clone()),imag:m_.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(LL(e,"slice"),qR(e.shape,t,n)){var r=GR(t,e.strides),a=cI(n);return WT(this.readSync(e.dataId).subarray(r,r+a),n,e.dtype)}for(var i=cN(n,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(e,n){return e+t[n]}));i.values[s]=o.get.apply(o,u)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){LL(e,"stridedSlice");var a=jR(t,n,r);if(a.some((function(e){return 0===e})))return WT([],a);for(var i=cN(a,e.dtype),o=this.bufferSync(e),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+t[l];i.set.apply(i,[o.get.apply(o,c)].concat(u))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=cN([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[t]=i,u[i]=this.slice(e,o,s).reshape(r);return u},t.prototype.reverse=function(e,t){LL(e,"reverse");for(var n=cN(e.shape,e.dtype),r=this.bufferSync(e),a=function(a){var i=n.indexToLoc(a),o=i.slice();t.forEach((function(t){return o[t]=e.shape[t]-1-o[t]})),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return zT(e)})),a=e.map((function(e){return jT(e)}));return VT(this.concat(r,t),this.concat(a,t))}var i=e.map((function(e){var n=cI(e.shape.slice(t));return e.as2D(-1,n)})),o=BT(i.map((function(e){return e.shape})),1),s=cN(o,e[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var c=0;i.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,a=0;a<e.shape[0];++a)for(var i=a*o[1]+c,u=0;u<e.shape[1];++u)s[i+u]=t[r++];c+=e.shape[1]}))}var l=BT(e.map((function(e){return e.shape})),t);return WT(s,l,e[0].dtype)},t.prototype.neg=function(e){return LL(e,"neg"),this.multiply(qT(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,u_(e.dtype,t.dtype),(function(e,t){return e+t}))},t.prototype.addN=function(e){var t=this;LL(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=cN(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=gI([t],e.shape),r=this.max(e,n),a=OT(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return PR(o,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,u_(e.dtype,t.dtype),(function(e,t){return e-t}))},t.prototype.pow=function(e,t){return LL([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},t.prototype.batchMatMul=function(e,t,n,r){LL([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],f=l[0],h=l[1],d=l[2],p=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],v=p[0],m=p[1],g=p[2],y=i*o,b=cN([s,i,o],e.dtype),x=b.values,w=this.blockSize,k=0;k<s;k++)for(var E=0;E<i;E+=w)for(var S=0;S<o;S+=w)for(var C=0;C<a;C+=w)for(var I=Math.min(E+w,i),_=Math.min(S+w,o),T=Math.min(C+w,a),N=E;N<I;N++)for(var R=S;R<_;R++){for(var A=0,O=C;O<T;O++)A+=u[k*f+N*h+O*d]*c[O*v+R*m+k*g];x[k*y+(N*o+R)]+=A}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,a);return i&&(u=this.add(u,i)),o&&(u=VL(this,u,o,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,u_(e.dtype,t.dtype),(function(e,t){return e*t}))},t.prototype.floorDiv=function(e,t){return LL([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},t.prototype.sum=function(e,t){LL(e,"sum"),DT("sum",t,e.rank);for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,u_(e.dtype,"int32")),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=0,h=0;h<o;++h)f+=u[l+h];s[c]=f}return i},t.prototype.prod=function(e,t){LL(e,"sum");for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,u_(e.dtype,"int32")),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=1,h=0;h<o;++h)f*=u[l+h];s[c]=f}return i},t.prototype.unsortedSegmentSum=function(e,t,n){LL(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var o=qT(i,"int32"),s=wM(o,t).asType("float32").mul(e).sum(0);r.push(s)}return yN(r)},t.prototype.argMin=function(e,t){LL(e,"argMin");var n=[t];DT("argMin",n,e.rank);for(var r=AT(e.shape,n),a=r[0],i=r[1],o=YT(a,"int32"),s=cI(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],d=0,p=0;p<s;++p){var v=c[f+p];v<h&&(h=v,d=p)}u[l]=d}return o},t.prototype.argMax=function(e,t){LL(e,"argMax");var n=[t];DT("argMax",n,e.rank);for(var r=AT(e.shape,n),a=r[0],i=r[1],o=YT(a,"int32"),s=cI(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],d=0,p=0;p<s;++p){var v=c[f+p];v>h&&(h=v,d=p)}u[l]=d}return o},t.prototype.cumsum=function(e,t,n,r){if(LL(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var a=u_(e.dtype,"int32"),i=YT(e.shape,a),o=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var f=0;f<u;f++){var h=c(l,f);if(0===f)o[h]=n?0:s[h];else{var d=c(l,f-1);o[h]=n?s[d]+o[d]:s[h]+o[d]}}return i},t.prototype.equal=function(e,t){return LL([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},t.prototype.notEqual=function(e,t){return LL([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},t.prototype.less=function(e,t){return LL([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},t.prototype.lessEqual=function(e,t){return LL([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},t.prototype.greater=function(e,t){return LL([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},t.prototype.greaterEqual=function(e,t){return LL([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},t.prototype.logicalNot=function(e){LL(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return LL([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},t.prototype.logicalOr=function(e,t){return LL([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},t.prototype.select=function(e,t,n){LL([e,t,n],"select");for(var r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=this.readSync(n.dataId),o=YT(t.shape,u_(t.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===e.rank||e.rank>1||1===t.rank?1:cI(t.shape.slice(1)),l=0;l<r.length;l++)for(var f=0;f<c;f++)1===r[l]?s[u++]=a[l]:s[u++]=i[l];return o},t.prototype.where=function(e){LL([e],"where");var t=this.readSync(e.dataId);return RA(e.shape,t)},t.prototype.topk=function(e,t,n){return LL(e,"topk"),NA(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){LL(e,"min"),DT("min",t,e.rank);for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,e.dtype),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var d=u[l+h];d<f&&(f=d)}s[c]=f}return i},t.prototype.minimum=function(e,t){return LL([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},t.prototype.mod=function(e,t){return LL([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},t.prototype.max=function(e,t){LL(e,"max"),DT("max",t,e.rank);for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,e.dtype),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var d=u[l+h];d>f&&(f=d)}s[c]=f}return i},t.prototype.maximum=function(e,t){return LL([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},t.prototype.all=function(e,t){LL(e,"all"),DT("all",t,e.rank);for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,e.dtype),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var d=u[l+h];f=f&&d}s[c]=f}return i},t.prototype.any=function(e,t){LL(e,"any"),DT("any",t,e.rank);for(var n=AT(e.shape,t),r=n[0],a=n[1],i=YT(r,e.dtype),o=cI(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var d=u[l+h];f=f||d}s[c]=f}return i},t.prototype.squaredDifference=function(e,t){return LL([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},t.prototype.ceil=function(e){LL(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){LL(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){LL(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){LL(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){LL(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){LL(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){LL(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);t[r]-a<.5?n[r]=Math.floor(t[r]):t[r]-a>.5?n[r]=Math.ceil(t[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){LL(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){LL(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){LL(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){LL(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log1p(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){LL(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){LL(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){LL(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){LL(e,"relu");for(var t=YT(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t},t.prototype.relu6=function(e){LL(e,"relu");for(var t=YT(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t},t.prototype.prelu=function(e,t){return LL([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},t.prototype.elu=function(e){LL(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){LL([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){LL(e,"selu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?1.0507009873554805*a:1.7580993408473768*(Math.exp(a)-1)}return this.makeOutput(t,e.shape,"float32")},t.prototype.clip=function(e,t,n){LL(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var a=n[2*r],i=n[2*r+1];t[r]=Math.hypot(a,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){LL(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){LL(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){LL(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i,o=r[a]>-t,s=r[a]<t,u=Math.exp(r[a]);i=s?u:o?r[a]:Math.log(1+u),n[a]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){LL(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){LL(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){LL(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){LL(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){LL(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){LL(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return LL([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},t.prototype.sinh=function(e){LL(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){LL(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){LL(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=hI(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){LL(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){LL(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){LL(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){LL(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);t[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),LL(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return a&&(s=this.add(s,a)),i&&(s=VL(this,s,i,o)),s},t.prototype.conv2d=function(e,t,n){LL([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=cN(n.outShape,e.dtype),f=e.strides[0],h=c?e.strides[1]:e.strides[2],d=c?e.strides[2]:1,p=c?1:e.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=l.values,k=0;k<n.batchSize;++k)for(var E=k*f,S=k*v,C=0;C<n.outHeight;++C)for(var I=S+C*m,_=C*n.strideHeight-u,T=0;T<r;T++){var N=_+T*i;if(!(N<0||N>=n.inHeight))for(var R=T*t.strides[0],A=E+N*h,O=0;O<n.outWidth;++O)for(var D=I+O*g,P=O*n.strideWidth-s,M=0;M<a;M++){var F=P+M*o;if(!(F<0||F>=n.inWidth))for(var L=A+F*d,B=R+M*t.strides[1],U=0;U<n.inChannels;++U){for(var V=b[L+U*p],z=0;z<n.outChannels;++z)w[D+z*y]+=V*x[B+z];B+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,f=n.padInfo.top,h=cN(n.outShape,e.dtype),d=this.readSync(e.dataId),p=this.readSync(t.dataId),v=h.values,m=0;m<n.batchSize;++m)for(var g=m*e.strides[0],y=m*h.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*h.strides[1],w=b*n.strideDepth-c,k=0;k<r;k++){var E=w+k*o;if(!(E<0||E>=n.inDepth))for(var S=k*t.strides[0],C=g+E*e.strides[1],I=0;I<n.outHeight;++I)for(var _=x+I*h.strides[2],T=I*n.strideHeight-f,N=0;N<a;N++){var R=T+N*s;if(!(R<0||R>=n.inHeight))for(var A=S+N*t.strides[1],O=C+R*e.strides[2],D=0;D<n.outWidth;++D)for(var P=_+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<i;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=A+F*t.strides[2],U=O+L*n.inChannels,V=B,z=0;z<n.inChannels;++z){for(var j=d[U+z],W=0;W<n.outChannels;++W)v[P+W]+=j*p[V+W];V+=n.outChannels}}}}return h.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){LL([e,t],"conv2dDerInput");for(var r=cN(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),s=t.strides,u=s[0],c=s[1],l=s[2],f=n.batchSize,h=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,k=n.dataFormat,E=h-1-n.padInfo.top,S=d-1-n.padInfo.left,C="channelsLast"===k,I=r.strides[0],_=C?r.strides[1]:r.strides[2],T=C?r.strides[2]:1,N=C?1:r.strides[1],R=e.strides[0],A=C?e.strides[1]:e.strides[2],O=C?e.strides[2]:1,D=C?1:e.strides[1],P=0;P<f;++P)for(var M=0;M<p;++M)for(var F=0;F<v;++F)for(var L=F-E,B=Math.max(0,Math.ceil(L/x)),U=Math.min(y,(h+L)/x),V=0;V<m;++V){for(var z=V-S,j=Math.max(0,Math.ceil(z/w)),W=Math.min(b,(d+z)/w),H=0,q=B;q<U;++q)for(var G=q*x-L,K=j;K<W;++K)for(var X=R*P+A*q+O*K,$=u*(h-1-G)+c*(d-1-(K*w-z))+l*M,Q=0;Q<g;++Q)H+=i[X+D*Q]*o[$+Q];a[I*P+_*F+T*V+N*M]=H}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=cN(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),f=e.strides,h=f[0],d=f[1],p=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],k=n.batchSize,E=n.filterDepth,S=n.filterHeight,C=n.filterWidth,I=n.inChannels,_=n.inDepth,T=n.inHeight,N=n.inWidth,R=n.outChannels,A=n.outDepth,O=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=E-1-n.padInfo.front,B=S-1-n.padInfo.top,U=C-1-n.padInfo.left,V=0;V<k;++V)for(var z=0;z<I;++z)for(var j=0;j<_;++j)for(var W=j-L,H=Math.max(0,Math.ceil(W/P)),q=Math.min(A,(E+W)/P),G=0;G<T;++G)for(var K=G-B,X=Math.max(0,Math.ceil(K/M)),$=Math.min(O,(S+K)/M),Q=0;Q<N;++Q){for(var Y=Q-U,J=Math.max(0,Math.ceil(Y/F)),Z=Math.min(D,(C+Y)/F),ee=0,te=H;te<q;++te)for(var ne=te*P-W,re=X;re<$;++re)for(var ae=re*M-K,ie=J;ie<Z;++ie)for(var oe=h*V+d*te+p*re+v*ie,se=y*(E-1-ne)+b*(S-1-ae)+x*(C-1-(ie*F-Y))+w*z,ue=0;ue<R;++ue)ee+=l[oe+ue]*m[se+ue];a[o*V+s*j+u*G+c*Q+z]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){LL([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=cN(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,f=this.bufferSync(e),h=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),m=0;m<o;++m)for(var g=Math.max(0,Math.ceil((c-m)/a)),y=Math.min(n.outWidth,(n.inWidth+c-m)/a),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,k=0;k<n.batchSize;++k)for(var E=p;E<v;++E)for(var S=d+E*r-l,C=g;C<y;++C){var I=m+C*a-c;w+=s?f.get(k,S,I,b)*h.get(k,E,C,x):f.get(k,b,S,I)*h.get(k,x,E,C)}u.set(w,d,m,b,x)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=cN(n.filterShape,"float32"),l=c.values,f=c.strides,h=f[0],d=f[1],p=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],k=this.readSync(e.dataId),E=e.strides,S=E[0],C=E[1],I=E[2],_=E[3],T=n.padInfo.front,N=n.padInfo.left,R=n.padInfo.top,A=0;A<o;++A)for(var O=Math.max(0,Math.ceil((T-A)/r)),D=Math.min(n.outDepth,(n.inDepth+T-A)/r),P=A*h,M=0;M<s;++M)for(var F=Math.max(0,Math.ceil((R-M)/a)),L=Math.min(n.outHeight,(n.inHeight+R-M)/a),B=M*d+P,U=0;U<u;++U)for(var V=Math.max(0,Math.ceil((N-U)/i)),z=Math.min(n.outWidth,(n.inWidth+N-U)/i),j=U*p+B,W=0;W<n.inChannels;++W)for(var H=W*v+j,q=0;q<n.outChannels;++q){for(var G=0,K=0;K<n.batchSize;++K)for(var X=K*S,$=K*y,Q=O;Q<D;++Q)for(var Y=(A+Q*r-T)*C+X,J=Q*b+$,Z=F;Z<L;++Z)for(var ee=(M+Z*a-R)*I+Y,te=Z*x+J,ne=V;ne<z;++ne){var re=ne*w+te;G+=k[(U+ne*i-N)*_+ee+W]*m[re+q]}l[H+q]=G}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return a&&(s=this.add(s,a)),i&&(s=VL(this,s,i,o)),s},t.prototype.depthwiseConv2D=function(e,t,n){LL([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=cN(n.outShape,e.dtype),f=this.readSync(e.dataId),h=this.readSync(t.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*e.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,x=0;x<r;++x){var w=b+x*i;if(!(w<0||w>=n.inHeight))for(var k=x*t.strides[0],E=v+w*e.strides[1],S=0;S<n.outWidth;++S)for(var C=y+S*l.strides[2],I=S*n.strideWidth-u,_=0;_<a;++_){var T=I+_*o;if(!(T<0||T>=n.inWidth))for(var N=k+_*t.strides[1],R=E+T*n.inChannels,A=C,O=N,D=0;D<n.inChannels;++D){for(var P=f[R+D],M=0;M<c;++M)d[A+M]+=P*h[O+M];A+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){LL([e,t],"depthwiseConv2DDerInput");for(var r=cN(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=this.readSync(e.dataId),l=e.strides,f=l[0],h=l[1],d=l[2],p=this.readSync(t.dataId),v=t.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,k=n.inChannels,E=n.inHeight,S=n.inWidth,C=n.outChannels,I=n.outHeight,_=n.outWidth,T=n.strideHeight,N=n.strideWidth,R=x-1-n.padInfo.top,A=w-1-n.padInfo.left,O=C/k,D=0;D<b;++D)for(var P=0;P<k;++P)for(var M=0;M<E;++M)for(var F=M-R,L=Math.max(0,Math.ceil(F/T)),B=Math.min(I,(x+F)/T),U=0;U<S;++U){for(var V=U-A,z=Math.max(0,Math.ceil(V/N)),j=Math.min(_,(w+V)/N),W=0,H=L;H<B;++H)for(var q=H*T-F,G=z;G<j;++G)for(var K=f*D+h*H+d*G,X=m*(x-1-q)+g*(w-1-(G*N-V))+y*P,$=0;$<O;++$)W+=c[K+(P*O+$)]*p[X+$];a[o*D+s*M+u*U+P]=W}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){LL([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=cN(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,f=this.bufferSync(e),h=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<o;++m)for(var g=Math.max(0,Math.ceil((u-m)/a)),y=Math.min(n.outWidth,(n.inWidth+u-m)/a),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/l),w=b%l,k=0,E=0;E<n.batchSize;++E)for(var S=p;S<v;++S)for(var C=d+S*r-c,I=g;I<y;++I){var _=m+I*a-u;k+=f.get(E,C,_,x)*h.get(E,S,I,b)}s.set(k,d,m,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return LL(e,"tile"),TA(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){LL(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),a=t.map((function(e){return e[0]})),i=this.bufferSync(e),o=cN(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),c=u.map((function(e,t){return e+a[t]}));o.set.apply(o,[i.get.apply(i,u)].concat(c))}return o.toTensor()},t.prototype.gather=function(e,t,n){LL([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=cN(r,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=a[u[n]];var l=o.locToIndex(c);i.values[s]=o.values[l]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){LL([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),a=wN(e.shape,t,r),i=kN(a.length,t.length),o=EN(e.shape,t,r),s=SN(n,t.length),u=CN(o,n,t.length);return QR(e.reshape(a),i).reshape(o).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){LL([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=wN(o.shape,t,r,!1),u=kN(s.length,t.length,!1),c=EN(o.shape,t,r,!1);return QR(o.reshape(s),u).reshape(c)},t.prototype.maxPool=function(e,t){return LL(e,"maxPool"),BL(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"max").toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){LL([t,n],"maxPoolBackprop");for(var a=this.readSync(t.dataId),i=cN(r.outShape,t.dtype,UL(a,t.shape,t.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=f-1-r.padInfo.left,d=l-1-r.padInfo.top,p=cN(t.shape,"float32"),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-d,w=b-h,k=0,E=0;E<l;E+=u){var S=(x+E)/o;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var C=0;C<f;C+=c){var I=(w+C)/s;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var _=l*f-1-i.get(m,S,I,g)===E*f+C?1:0;0!==_&&(k+=v.get(m,S,I,g)*_)}}}p.set(k,m,y,b,g)}return p.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){LL([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,f=l-1-n.padInfo.left,h=c-1-n.padInfo.top,d=cN(t.shape,"float32"),p=1/(i*o),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-h,w=b-f,k=0,E=0;E<c;E+=s){var S=(x+E)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var C=0;C<l;C+=u){var I=(w+C)/a;I<0||I>=n.outWidth||Math.floor(I)!==I||(k+=v.get(m,S,I,g))}}d.set(k*p,m,y,b,g)}return d.toTensor()},t.prototype.pool3d=function(e,t,n){LL(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),g=cN(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],k=t.outShape[4],E=0;E<t.batchSize;++E)for(var S=E*b,C=E*e.strides[0],I=0;I<t.inChannels;++I)for(var _=0;_<t.outDepth;++_){for(var T=_*r-h,N=T;N<0;)N+=o;for(var R=Math.min(t.inDepth,c+T),A=S+_*x,O=0;O<t.outHeight;++O){for(var D=O*a-d,P=D;P<0;)P+=s;for(var M=Math.min(t.inHeight,l+D),F=A+O*w,L=0;L<t.outWidth;++L){for(var B=L*i-p,U=B;U<0;)U+=u;for(var V=Math.min(t.inWidth,f+B),z=F+L*k,j=v,W=0,H=0,q=N;q<R;q+=o){for(var G=C+q*e.strides[1],K=P;K<M;K+=s){for(var X=G+K*e.strides[2],$=U;$<V;$+=u){var Q=m[X+$*e.strides[3]+I];if("max"===n&&Q>j?j=Q:"avg"===n&&(W+=Q,H++),isNaN(j))break}if(isNaN(j))break}if(isNaN(j))break}y[z+I]="avg"===n?W/H:j}}}return g.toTensor()},t.prototype.avgPool3d=function(e,t){return LL(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){LL([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=h-1-n.padInfo.front,m=p-1-n.padInfo.left,g=d-1-n.padInfo.top,y=cN(t.shape,"float32"),b=1/(o*s*u),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var k=0;k<n.inChannels;++k)for(var E=0;E<n.inDepth;++E)for(var S=0;S<n.inHeight;++S)for(var C=0;C<n.inWidth;++C){for(var I=E-v,_=S-g,T=C-m,N=0,R=0;R<h;R+=c){var A=(I+R)/r;if(!(A<0||A>=n.outDepth||Math.floor(A)!==A))for(var O=0;O<d;O+=l){var D=(_+O)/a;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var P=0;P<p;P+=f){var M=(T+P)/i;M<0||M>=n.outWidth||Math.floor(M)!==M||(N+=x.get(w,A,D,M,k))}}}y.set(N*b,w,E,S,C,k)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return LL(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=cN(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-h,x=b;x<0;)x+=o;for(var w=Math.min(t.inDepth,c+b),k=0;k<t.outHeight;++k){for(var E=k*a-d,S=E;S<0;)S+=s;for(var C=Math.min(t.inHeight,l+E),I=0;I<t.outWidth;++I){for(var _=I*i-p,T=_;T<0;)T+=u;for(var N=Math.min(t.inWidth,f+_),R=Number.NEGATIVE_INFINITY,A=-1,O=x;O<w;O+=o)for(var D=O-b,P=S;P<C;P+=s)for(var M=P-E,F=T;F<N;F+=u){var L=F-_,B=v.get(m,O,P,F,g);B>=R&&(R=B,A=D*l*f+M*l+L)}n.set(A,m,y,k,I,g)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){LL([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=f-1-r.padInfo.front,v=d-1-r.padInfo.left,m=h-1-r.padInfo.top,g=cN(t.shape,"float32"),y=this.bufferSync(a),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var k=0;k<r.inDepth;++k)for(var E=0;E<r.inHeight;++E)for(var S=0;S<r.inWidth;++S){for(var C=k-p,I=E-m,_=S-v,T=0,N=0;N<f;N+=u){var R=(C+N)/i;if(!(R<0||R>=r.outDepth||Math.floor(R)!==R))for(var A=0;A<h;A+=c){var O=(I+A)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var D=0;D<d;D+=l){var P=(_+D)/s;if(!(P<0||P>=r.outWidth||Math.floor(P)!==P)){var M=f*h*d-1-y.get(x,R,O,P,w)===N*h*d+A*d+D?1:0;0!==M&&(T+=b.get(x,R,O,P,w)*M)}}}}g.set(T,x,k,E,S,w)}return g.toTensor()},t.prototype.cast=function(e,t){return hA(e,t,this)},t.prototype.reshape=function(e,t){return dA(e,t)},t.prototype.avgPool=function(e,t){return LL(e,"avgPool"),LL(e,"maxPool"),BL(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){LL(e,"resizeBilinear");for(var a=e.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(e.dataId),l=new Float32Array(cI([i,t,n,u])),f=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=0,p=f[0]/h[0],v=f[1]/h[1],m=0;m<i;m++)for(var g=0;g<t;g++)for(var y=p*g,b=Math.floor(y),x=y-b,w=Math.min(o-1,Math.ceil(y)),k=m*e.strides[0]+b*e.strides[1],E=m*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var C=v*S,I=Math.floor(C),_=C-I,T=Math.min(s-1,Math.ceil(C)),N=k+I*e.strides[2],R=E+I*e.strides[2],A=k+T*e.strides[2],O=E+T*e.strides[2],D=0;D<u;D++){var P=c[N+D],M=c[R+D],F=P+(c[A+D]-P)*_,L=F+(M+(c[O+D]-M)*_-F)*x;l[d++]=L}return WT(l,[i,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){LL([e,t],"resizeBilinearBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(a*i*o*s),h=[n&&c>1?i-1:i,n&&l>1?o-1:o],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=h[0]/d[0],v=h[1]/d[1],m=this.readSync(e.dataId),g=0,y=0;y<a;y++)for(var b=y*t.strides[0],x=0;x<c;x++)for(var w=x*p,k=Math.floor(w),E=Math.min(Math.ceil(w),i-1),S=b+k*t.strides[1],C=b+E*t.strides[1],I=w-k,_=1-I,T=0;T<l;T++)for(var N=T*v,R=Math.floor(N),A=Math.min(Math.ceil(N),o-1),O=N-R,D=1-O,P=S+R*t.strides[2],M=S+A*t.strides[2],F=C+R*t.strides[2],L=C+A*t.strides[2],B=_*D,U=_*O,V=I*D,z=I*O,j=0;j<s;j++){var W=m[g++];f[P+j]+=W*B,f[M+j]+=W*U,f[F+j]+=W*V,f[L+j]+=W*z}return $T(f,[a,o,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){LL(e,"resizeNearestNeighbor");for(var a=e.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*u),f=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=f[0]/h[0],p=f[1]/h[1],v=0,m=0;m<i;m++)for(var g=m*e.strides[0],y=0;y<t;y++)for(var b=d*y,x=g+Math.min(o-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var k=p*w,E=x+Math.min(s-1,r?Math.round(k):Math.floor(k))*e.strides[2],S=0;S<u;S++){var C=c[E+S];l[v++]=C}return WT(l,[i,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){LL([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(a*i*o*s),h=this.readSync(e.dataId),d=[n&&c>1?i-1:i,n&&l>1?o-1:o],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,x=2*Math.ceil(y)+2,w=0;w<a;w++)for(var k=w*t.strides[0],E=0;E<i;E++)for(var S=k+E*t.strides[1],C=Math.floor(E*g),I=Math.floor(C-b/2),_=0;_<o;_++)for(var T=S+_*t.strides[2],N=Math.floor(_*y),R=Math.floor(N-x/2),A=0;A<s;A++){for(var O=0,D=0;D<b;D++){var P=D+I;if(!(P<0||P>=c)){var M=k+P*e.strides[1],F=P*v;if(E===Math.min(i-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<x;L++){var B=L+R;if(!(B<0||B>=l)){var U=M+B*e.strides[2],V=B*m;_===Math.min(o-1,n?Math.round(V):Math.floor(V))&&(O+=h[U+A])}}}}f[T+A]=O}return $T(f,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){LL([e,t,n,a,i],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(o.length),h=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,b=0,x=0;x<o.length;++x)f[x]=l[m++]+(o[x]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),m>=h&&(m=0),g>=v&&(g=0),y>=d&&(y=0),b>=p&&(b=0);return $T(f,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){LL(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),u=0;r<=a;r++){var c=s[r];u+=c*c}return u}for(var f=0;f<u;f++){var h=l(f),d=s[f]*Math.pow(n+r*h,-a);c[f]=d}return $T(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){LL(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),f=new Float32Array(e.size),h=e.size,d=0;d<h;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);for(g=i*g+a,y=v;y<m;y++){var b=-2*i*o*c[y]*l[d]/g;d===y&&(b+=Math.pow(g,-o)),b*=u[d],f[y]+=b}}return $T(f,e.shape)},t.prototype.multinomial=function(e,t,n,r){LL(e,"multinomial");for(var a=t?e:XR(e),i=a.shape[0],o=a.shape[1],s=YT([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var f=l*o,h=new Float32Array(o-1);h[0]=c[f];for(var d=1;d<h.length;++d)h[d]=h[d-1]+c[f+d];for(var p=_P(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=h.length;for(var y=0;y<h.length;y++)if(g<h[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){LL(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return KT(a,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return LL(e,"nonMaxSuppression"),wA(this.readSync(e.dataId),this.readSync(t.dataId),n,r,a)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],a=cN(e.shape,"float32"),i=cN(e.shape,"float32"),o=zT(e).as2D(n,r),s=jT(e).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),f=VT(c,l),h=this.readSync(this.fftImpl(f,t).dataId),d=0;d<r;d++){var p=mA(h,d);a.values[u*r+d]=p.real,i.values[u*r+d]=p.imag}return VT(a.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=VT(zT(a).div(qT(r)),jT(a).div(qT(r)))),a}var i=this.readSync(e.dataId),o=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return VT(o.real,o.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),o=VT(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),u=VT(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),u=this.fftRadix2(u,a,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(t,n),l=VT(c.real,c.imag).mul(u),f=o.add(l),h=o.sub(l),d=zT(f).concat(zT(h)),p=jT(f).concat(jT(h));return VT(d,p).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=yA(a*s,t,n),c=mA(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),gA(r,i,o,a)}return r},t.prototype.depthToSpace=function(e,t,n){iI("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),iI(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],a=e.shape[1],i=e.shape[2],o=e.shape[3],s=a*t,u=i*t,c=o/(t*t),l=this.readSync(e.dataId),f=new Float32Array(r*s*u*c),h=0,d=0;d<r;++d)for(var p=0;p<s;++p)for(var v=Math.floor(p/t),m=p%t,g=0;g<u;++g)for(var y=Math.floor(g/t),b=(m*t+g%t)*c,x=0;x<c;++x){var w=x+b+o*(y+i*(v+a*d));f[h++]=l[w]}return $T(f,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var a=FN(e.shape,t.shape),i=cN(a,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=PN(e.shape,a),c=PN(t.shape,a),l=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;++f)l[f]=r(o[f%o.length],s[f%s.length]);else{var h=this.bufferSync(e),d=this.bufferSync(t),p=function(n){var a=i.indexToLoc(n),f=a.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var p=h.locToIndex(f),v=a.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var m=d.locToIndex(v);l[n]=r(o[p],s[m])};for(f=0;f<l.length;++f)p(f)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=FN(e.shape,t.shape),a=cN(r,"float32"),i=cN(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=PN(e.shape,r),c=PN(t.shape,r),l=a.values,f=i.values;if(u.length+c.length===0)for(var h=0;h<l.length;h++){var d=h%o.length,p=h%s.length,v=n(o[2*d],o[2*d+1],s[2*p],s[2*p+1]);l[h]=v.real,f[h]=v.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=a.indexToLoc(r),h=i.slice(-e.rank);u.forEach((function(e){return h[e]=0}));var d=m.locToIndex(h),p=i.slice(-t.rank);c.forEach((function(e){return p[e]=0}));var v=g.locToIndex(p),y=n(o[2*d],o[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,f[r]=y.imag};for(h=0;h<l.length;h++)y(h)}return this.complex(a.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return _A(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,a,i){for(var o=e.shape,s=o[0],u=o[1],c=o[2],l=o[3],f=t.shape[0],h=r[0],d=r[1],p=cN([f,h,d,l],"float32"),v=this.readSync(t.dataId),m=this.readSync(n.dataId),g=this.readSync(e.dataId),y=e.strides,b=p.strides,x=0;x<f;x++){var w=4*x,k=v[w],E=v[w+1],S=v[w+2],C=v[w+3],I=m[x];if(!(I>=s))for(var _=h>1?(S-k)*(u-1)/(h-1):0,T=d>1?(C-E)*(c-1)/(d-1):0,N=0;N<h;N++){var R=h>1?k*(u-1)+N*_:.5*(k+S)*(u-1);if(R<0||R>u-1)for(var A=0;A<d;A++)for(var O=0;O<l;O++){var D=O+A*b[2]+N*b[1]+x*b[0];p.values[D]=i}else if("bilinear"===a){var P=Math.floor(R),M=Math.ceil(R),F=R-P;for(A=0;A<d;A++)if((q=d>1?E*(c-1)+A*T:.5*(E+C)*(c-1))<0||q>c-1)for(O=0;O<l;O++)D=O+A*b[2]+N*b[1]+x*b[0],p.values[D]=i;else{var L=Math.floor(q),B=Math.ceil(q),U=q-L;for(O=0;O<l;O++){var V=g[D=O+L*y[2]+P*y[1]+I*y[0]],z=g[D=O+B*y[2]+P*y[1]+I*y[0]],j=g[D=O+L*y[2]+M*y[1]+I*y[0]],W=V+(z-V)*U,H=j+(g[D=O+B*y[2]+M*y[1]+I*y[0]]-j)*U;D=O+A*b[2]+N*b[1]+x*b[0],p.values[D]=W+(H-W)*F}}}else for(A=0;A<d;++A){var q;if((q=d>1?E*(c-1)+A*T:.5*(E+C)*(c-1))<0||q>c-1)for(O=0;O<l;O++)D=O+A*b[2]+N*b[1]+x*b[0],p.values[D]=i;else{var G=Math.round(q),K=Math.round(R);for(O=0;O<l;O++){var X=O+G*y[2]+K*y[1]+I*y[0],$=O+A*b[2]+N*b[1]+x*b[0];p.values[$]=g[X]}}}}}return p.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var a=UR(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,u=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,s,o,i,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=MR(e,t),i=a[0],o=a[1],s=a[2],u=a[3];if(0===o)return WT([],i,e.dtype);for(var c=new QI([o,s],e.dtype),l=this.readSync(t.dataId),f=this.readSync(e.dataId),h=0;h<o;h++){for(var d=[],p=0,v=0;v<r;v++){var m=l[h*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: "+d+" does not index into "+e.shape);for(var g=0;g<s;g++)c.values[h*s+g]=f[p*s+g]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=UR(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=qT(0);return this.scatter(e,t,n,u,o,i,a,s,c,!0)},t.prototype.fill=function(e,t,n){var r=xI(n=n||RI(t),cI(e));return r.fill(t),m_.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=xI(e.dtype,cI(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return pA(e,t,n)},t.prototype.scatter=function(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],f=this.readSync(e.dataId),h=this.readSync(t.dataId);if(0===r)return WT([],n,t.dtype);var d=new QI(l,t.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<i;p++){for(var v=[],m=0,g=0;g<o;g++){var y=f[p*o+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/a)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<a;b++)c?d.values[m*a+b]+=h[p*a+b]:d.values[m*a+b]=0===t.rank?h[0]:h[p*a+b]}return d.toTensor().reshape(n)},t}(JR);function jL(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,a=n.backend,i=r,o=i.a,s=i.b,u=a;LL([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,f=t(o.shape,s.shape,c,l,o.dtype),h=f[0],d=f[1];return{dataId:u.write(h,d,o.dtype),shape:d,dtype:o.dtype}}}}function WL(e){return function(t,n,r,a,i){var o=FN(t,n),s=o.length,u=DI(o),c=bI(i,cI(o)),l=t.length,f=n.length,h=DI(t),d=DI(n),p=PN(t,o),v=PN(n,o);if(p.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=e(r[m%r.length],a[m%a.length]);else{var g=function(t){var n=WI(t,s,u),i=n.slice(-l);p.forEach((function(e){return i[e]=0}));var o=jI(i,l,h),m=n.slice(-f);v.forEach((function(e){return m[e]=0}));var g=jI(m,f,d);c[t]=e(r[o],a[g])};for(m=0;m<c.length;++m)g(m)}return[c,o]}}m_.registerBackend("cpu",(function(){return new zL}),1);var HL=WL((function(e,t){return e/t})),qL=jL(IN,HL),GL={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;LL(a,"MaxPoolWithArgmax");var f=l.data.get(a.dataId).values,h=eA(a.shape,o,s,[1,1],u),d=function(e,t,n,r,a){var i=BL(e,0,n,DI(t),a,"max"),o=UL(e,t,n,a,!0,r);return[i.values,o.values]}(f,a.shape,a.dtype,c,h),p=d[0],v=d[1],m=l.write(p,h.outShape,a.dtype),g=l.write(v,h.outShape,a.dtype);return[{dataId:m,shape:h.outShape,dtype:a.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}},KL={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n;LL(i,"NonMaxSuppressionWithScore");var d=kA(h.data.get(i.dataId).values,h.data.get(o.dataId).values,u,c,l,f);return[d.selectedIndices,d.selectedScores]}},XL={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;LL(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},$L=WL((function(e,t){var n=e-t;return n*n}));function QL(e,t,n,r,a){for(var i=cI(t),o=t.length,s=DI(t),u=DI(a),c=bI(n,cI(a)),l=0;l<i;++l){for(var f=WI(l,o,s),h=new Array(f.length),d=0;d<h.length;d++)h[d]=f[r[d]];c[jI(h,o,u)]=e[l]}return c}for(var YL=0,JL=[KL,XL,jL(_N,$L),qL,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm,o=r;LL(a,"transpose");for(var s=a.shape.length,u=new Array(s),c=0;c<u.length;c++)u[c]=a.shape[i[c]];var l=QL(o.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:o.write(l,u,a.dtype),shape:u,dtype:a.dtype}}},GL];YL<JL.length;YL++)JC(JL[YL]);for(var ZL,eB=function(e){this.variableNames=["A"];var t=FA(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},tB=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=FA(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},nB=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var a=$A(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},rB=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=$A(this.rank),i=PA("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},aB=0,iB=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,u=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=u[0],l=u[1],f=[l,c],h=[l,c,i];(s||o)&&(null==ZL&&(ZL=document.createElement("canvas").getContext("2d")),ZL.canvas.width=c,ZL.canvas.height=l,ZL.drawImage(a,0,0,c,l),a=ZL.canvas);var d=n.makeTensorInfo(f,"int32");n.texData.get(d.dataId).usage=x_.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);var p=qC().getBool("WEBGL_PACK")?new tB(h):new eB(h),v=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),v}},{kernelName:IN,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(e,t,n){var r=new uO("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new lO("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",e.shape,t.shape,!0)),n.runWebGLProgram(r,[e,t],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;ST("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n,d=kA(h.readSync(i.dataId),h.readSync(o.dataId),u,c,l,f);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new HD(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:_N,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n,s=qC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lO("return (a - b) * (a - b);",a.shape,i.shape):new uO("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,a=e.backend,i=n.x,o=r.perm,s=a,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var f=QL(s.texData.get(i.dataId).values,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=f}else t=function(e,t,n){var r=qC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rB(e.shape,t):new nB(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}(i,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;iI(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.shape.length+"."}));var f=[1,1];iI(lA(s,f),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"}));var h=eA(a.shape,o,s,f,u),d=function(e,t,n,r){var a=new xD(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new xD(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,c,h,l);return[d[0],d[1]]}}];aB<iB.length;aB++)JC(iB[aB]);for(var oB=0,sB=[{kernelName:"Add",inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=FN(n.shape,r.shape);return{a:function(){var t=e,r=MN(n.shape,a);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},b:function(){var t=e,n=MN(r.shape,a);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},{kernelName:TN,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+i+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:IN,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=FN(n.shape,r.shape);return{a:function(){var t=PR(e,r.toFloat()),i=MN(n.shape,a);return i.length>0?TF(t,i).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),i=MN(r.shape,a);i.length>0&&(t=TF(t,i).reshape(r.shape));var o=yM(r);return tR(PR(t,o.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=t[0],i=t[1],o=t[2],s=t[3],u=RP(a),c=null==s?qT(1):s,l=MN(i.shape,u.shape),f=[];if(1===i.rank){for(var h=0;h<u.shape.length-1;++h)f.push(u.shape[h]);f.push(1)}var d=OR(a,i),p=_R(e,c),v=aR(DN(o,qT(r))),m=_R(_R(_R(v,v),v),qT(-.5));return{x:function(){return 1===i.rank?vN(_R(_R(e,ZP(v.as4D(1,1,1,i.shape[0]),f)),c),a.shape):vN(_R(_R(e,v),c),a.shape)},mean:function(){var e=_R(_R(v,qT(-1)),p);return 1===i.rank&&(e=TF(e,l)),vN(e,i.shape)},variance:function(){var e=_R(_R(m,d),p);return 1===i.rank&&(e=TF(e,l)),vN(e,i.shape)},scale:function(){var t=_R(d,v),n=_R(e,t);return 1===i.rank&&(n=TF(n,l)),vN(n,i.shape)},offset:function(){var t=e;return 1===i.rank&&(t=TF(t,l)),vN(t,i.shape)}}}},{kernelName:RN,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:NN,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return YT(n.shape,"float32")}}}},{kernelName:ON,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return e.slice(a,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:_N,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=qT(2);return{a:function(){return _R(e,_R(a,OR(n,r)))},b:function(){return _R(e,_R(a,OR(r,n)))}}}},{kernelName:AN,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.reps;return{x:function(){var t=nN(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=t.add(e.slice([n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<a[0];++n)for(var i=0;i<a[1];++i)t=t.add(e.slice([n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(var o=0;o<a[2];++o)t=t.add(e.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(o=0;o<a[2];++o)for(var s=0;s<a[3];++s)t=t.add(e.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=MT(n.perm);return{x:function(){return QR(e,r)}}}}];oB<sB.length;oB++)ZC(sB[oB]);var uB=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();qC().get("IS_BROWSER")&&qC().setPlatform("browser",new uB);var cB,lB=function(){function e(){this.util=n(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=qC().global.fetch?qC().global.fetch(e,t):(null==cB&&(cB=n(522)),cB(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();qC().get("IS_NODE")&&qC().setPlatform("node",new lB);var fB={float32:4,int32:4,uint16:2,uint8:1,bool:1};function hB(e,t){for(var n={},r=0,a=function(t){var a=t.name,i=t.dtype,o=t.shape,s=cI(o),u=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=fB[c.dtype],f=e.slice(r,r+s*l),h="uint8"===c.dtype?new Uint8Array(f):new Uint16Array(f);if("float32"===i)u=Float32Array.from(h,(function(e){return e*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=Int32Array.from(h,(function(e){return Math.round(e*c.scale+c.min)}))}r+=s*l}else if("string"===i){var d=cI(t.shape);u=[];for(var p=0;p<d;p++){var v=new Uint32Array(e.slice(r,r+4))[0];r+=4;var m=new Uint8Array(e.slice(r,r+v));u.push(m),r+=v}}else{var g=fB[i];if(f=e.slice(r,r+s*g),"float32"===i)u=new Float32Array(f);else if("int32"===i)u=new Int32Array(f);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=new Uint8Array(f)}r+=s*g}n[a]=WT(u,o,i)},i=0,o=t;i<o.length;i++)a(o[i]);return n}function dB(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var pB="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function vB(e){return pB?Buffer.byteLength(e):new Blob([e]).size}function mB(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function gB(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function yB(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:vB(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:vB(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var bB=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a},e}(),xB="://",wB=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){iI(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(xB)&&(t=t.slice(0,t.indexOf(xB))),iI(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();iI(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function kB(e){if(-1===e.indexOf(xB))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+wB.getSchemes().join(","));return{scheme:e.split(xB)[0],path:e.split(xB)[1]}}function EB(e,t,n){return void 0===n&&(n=!1),zC(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f;return jC(this,(function(h){switch(h.label){case 0:return iI(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),iI((r=bB.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),iI(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),a=r[0],iI((i=bB.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),iI(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),o=i[0],s=kB(e).scheme,u=kB(e).path,c=s===kB(e).scheme,[4,a.load()];case 1:return l=h.sent(),n&&c?[4,wB.getManager(s).removeModel(u)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[4,o.save(l)];case 4:return f=h.sent(),!n||c?[3,6]:[4,wB.getManager(s).removeModel(u)];case 5:h.sent(),h.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var SB="models_store",CB="model_info_store";function IB(){if(!qC().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function _B(e){var t=e.result;t.createObjectStore(SB,{keyPath:"modelPath"}),t.createObjectStore(CB,{keyPath:"modelPath"})}var TB=function(){function e(e){if(this.indexedDB=IB(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return _B(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(SB,"readonly"),s=o.objectStore(SB).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=yB(t),l=i.transaction(CB,"readwrite"),f=l.objectStore(CB),h=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var a=(u=i.transaction(SB,"readwrite")).objectStore(SB).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(f=l.objectStore(CB)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},h.onerror=function(e){return i.close(),r(h.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))},e.URL_SCHEME="indexeddb://",e}(),NB=function(e){return qC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(TB.URL_SCHEME)?(t=e.slice(TB.URL_SCHEME.length),new TB(t)):null;var t};bB.registerSaveRouter(NB),bB.registerLoadRouter(NB);var RB=function(){function e(){this.indexedDB=IB()}return e.prototype.listModels=function(){return zC(this,void 0,void 0,(function(){var e=this;return jC(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return _B(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(CB,"readonly"),i=a.objectStore(CB).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var a=r[n];e[a.modelPath]=a.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return zC(this,void 0,void 0,(function(){var t=this;return jC(this,(function(n){var r;return e=(r=e).startsWith(TB.URL_SCHEME)?r.slice(TB.URL_SCHEME.length):r,[2,new Promise((function(n,r){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return _B(a)},a.onsuccess=function(){var t,i=a.result,o=i.transaction(CB,"readwrite"),s=o.objectStore(CB),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var a=s.delete(e),o=function(){var a=(t=i.transaction(SB,"readwrite")).objectStore(SB).delete(e);a.onsuccess=function(){return n(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}}))]}))}))},e}();if(qC().getBool("IS_BROWSER"))try{wB.registerManager(TB.URL_SCHEME,new RB)}catch(ju){}var AB="/",OB="tensorflowjs_models",DB="info",PB="model_topology",MB="weight_specs",FB="weight_data",LB="model_metadata";function BB(e){return{info:[OB,e,DB].join(AB),topology:[OB,e,PB].join(AB),weightSpecs:[OB,e,MB].join(AB),weightData:[OB,e,FB].join(AB),modelMetadata:[OB,e,LB].join(AB)}}function UB(e){var t=e.split(AB);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(AB)}var VB=function(){function e(e){if(!qC().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=BB(this.modelPath)}return e.prototype.save=function(e){return zC(this,void 0,void 0,(function(){var t,n,r;return jC(this,(function(a){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=yB(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(pB)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return zC(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return jC(this,(function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(pB){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(o),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),zB=function(e){return qC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(VB.URL_SCHEME)?(t=e.slice(VB.URL_SCHEME.length),new VB(t)):null;var t};bB.registerSaveRouter(zB),bB.registerLoadRouter(zB);var jB=function(){function e(){iI(qC().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),iI("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return zC(this,void 0,void 0,(function(){var e,t,n,r,a,i;return jC(this,(function(o){for(e={},t=OB+AB,n=AB+DB,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(t)&&a.endsWith(n)&&(i=UB(a),e[i]=JSON.parse(this.LS.getItem(a)));return[2,e]}))}))},e.prototype.removeModel=function(e){return zC(this,void 0,void 0,(function(){var t,n;return jC(this,(function(r){var a;if(e=(a=e).startsWith(VB.URL_SCHEME)?a.slice(VB.URL_SCHEME.length):a,t=BB(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(qC().getBool("IS_BROWSER"))try{wB.registerManager(VB.URL_SCHEME,new jB)}catch(ju){}function WB(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var HB=function(){function e(t){if(!qC().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return zC(this,void 0,void 0,(function(){var t,n,r,a,i,o;return jC(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,WB((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=t,[4,WB((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:yB(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),qB=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return zC(this,void 0,void 0,(function(){var e,t,n=this;return jC(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,t)}catch(e){return void a(e)}var l=[],f=[],h=[];u.forEach((function(e){e.paths.forEach((function(e){f.push(e),h.push(null)})),l.push.apply(l,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,a=f.indexOf(e);h[a]=n,-1===h.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:mB(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},t.onerror=function(t){return a("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])}))}))}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return gB(e.name)})),a={},i=0,o=e;i<o.length;i++)o[i].paths.forEach((function(e){var i=gB(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return a},e}();function GB(e,t,n,r){!function(e){iI(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){iI(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),iI(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),iI(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function KB(e,t){return zC(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l;return jC(this,(function(f){switch(f.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?qC().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),a=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,GB(r,t.onProgress,a,i)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map((function(e){return e.arrayBuffer()})),u=.5,c=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=f.sent(),[3,8];case 6:return[4,GB(s,t.onProgress,u,c)];case 7:l=f.sent(),f.label=8;case 8:return[2,l]}}))}))}function XB(e){var t=this;return function(n,r,a){return void 0===r&&(r=""),zC(t,void 0,void 0,(function(){var t,i,o,s,u,c,l,f,h,d;return jC(this,(function(p){switch(p.label){case 0:if(t=n.map((function(){return!1})),i={},o=null!=a?a.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,c=fB[u]*cI(e.shape),l=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),o[n]=!0)})):l(),s.push(e.name),r+=c}))})),!o.every((function(e){return e})))throw u=a.filter((function(e,t){return!o[t]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),l=[],c.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;l.push(t)}))})),[4,e(l)];case 1:return f=p.sent(),h={},d=0,c.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=f[d+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<t;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}i[e].forEach((function(e){var t=hB(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),d+=t})),[2,h]}}))}))}}bB.registerSaveRouter((function(e){return qC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(HB.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new HB(e)}(e.slice(HB.URL_SCHEME.length)):null}));var $B=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(iI("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=qC().platform.fetch,iI(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&iI(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return zC(this,void 0,void 0,(function(){var t,n,r,a;return jC(this,(function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:yB(e),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}}))}))},e.prototype.load=function(){return zC(this,void 0,void 0,(function(){var e,t,n,r,a,i,o,s,u,c,l,f;return jC(this,(function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return t=h.sent(),[3,5];case 4:throw h.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,a=t.weightsManifest,i=t.generatedBy,o=t.convertedBy,s=t.format,u=t.userDefinedMetadata,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:f=h.sent(),c=f[0],l=f[1],h.label=7;case 7:return[2,{modelTopology:r,weightSpecs:c,weightData:l,userDefinedMetadata:u,generatedBy:i,convertedBy:o,format:s}]}}))}))},e.prototype.loadWeights=function(e){return zC(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l,f;return jC(this,(function(h){switch(h.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],a=n[1],i=this.weightPathPrefix||r,o=[],s=0,u=e;s<u.length;s++)c=u[s],o.push.apply(o,c.weights);return l=[],e.forEach((function(e){e.paths.forEach((function(e){l.push(i+e+a)}))})),[4,KB(l,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[o,mB(f)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function QB(e){return null!=e.match($B.URL_SCHEME_REGEX)}var YB=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return QB(e)})):QB(e))?JB(e,{onProgress:t}):null};function JB(e,t){return new $B(e,t)}bB.registerSaveRouter(YB),bB.registerLoadRouter(YB);var ZB,eU=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),tU=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),nU=Object.freeze({browserFiles:function(e){return new qB(e)},browserHTTPRequest:function(e,t){return JB(e,t)},concatenateArrayBuffers:mB,decodeWeights:hB,encodeWeights:function(e,t){return zC(this,void 0,void 0,(function(){var n,r,a,i,o,s=this;return jC(this,(function(u){switch(u.label){case 0:for(n=[],r=[],a=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),i=function(i){var o=a[i],u=Array.isArray(e)?e[i].tensor:e[o];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+u.dtype);var c={name:o,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(e){return zC(s,void 0,void 0,(function(){var t,n,r,a,i,o,s;return jC(this,(function(c){switch(c.label){case 0:return[4,u.bytes()];case 1:for(t=c.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+4*t.length,r=new Uint8Array(n),a=0,i=0;i<t.length;i++)o=t[i],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,a),a+=4,r.set(o,a),a+=o.length;return e(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=t&&(c.group=t),n.push(c)},o=0;o<a.length;++o)i(o);return[4,Promise.all(r)];case 1:return[2,{data:dB(u.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new eU(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eU({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eU({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return bB.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:yB,getSaveHandlers:function(e){return bB.getSaveHandlers(e)},http:JB,isHTTPScheme:QB,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),zC(this,void 0,void 0,(function(){return jC(this,(function(a){return[2,XB((function(e){return KB(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return bB.registerLoadRouter(e)},registerSaveRouter:function(e){return bB.registerSaveRouter(e)},weightsLoaderFactory:XB,withSaveHandler:function(e){return new tU(e)},copyModel:function(e,t){return zC(this,void 0,void 0,(function(){return jC(this,(function(n){return[2,EB(e,t,!1)]}))}))},listModels:function(){return zC(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return jC(this,(function(s){switch(s.label){case 0:e=wB.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(a=r[n],[4,wB.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())t[a+xB+o]=i[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return zC(this,void 0,void 0,(function(){return jC(this,(function(n){return[2,EB(e,t,!0)]}))}))},removeModel:function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){return t=kB(e),[2,wB.getManager(t.scheme).removeModel(t.path)]}))}))}}),rU=UT({confusionMatrix_:function(e,t,n){var r=_T(e,"labels","confusionMatrix"),a=_T(t,"predictions","confusionMatrix");iI(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),iI(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),iI(1===a.rank,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),iI(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),iI(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=nM(r.asType("int32"),n),o=nM(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),aU=(Object.freeze({confusionMatrix:rU}),UT({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=$C("FromPixels",m_.backendName))return m_.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,c=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],f=c[1];if(o?s=e.getContext("2d").getImageData(0,0,l,f).data:r||n?s=e.data:(i||a)&&(null==ZB&&(ZB=document.createElement("canvas").getContext("2d")),ZB.canvas.width=l,ZB.canvas.height=f,ZB.drawImage(e,0,0,l,f),s=ZB.getImageData(0,0,l,f).data),4===t)u=new Int32Array(s);else{var h=l*f;u=new Int32Array(h*t);for(var d=0;d<h;d++)for(var p=0;p<t;++p)u[d*t+p]=s[4*d+p]}return XT(u,[f,l,t],"int32")}})),iU=(Object.freeze({toPixels:function(e,t){return zC(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,f,h,d,p,v,m,g,y,b,x,w,k,E,S;return jC(this,(function(C){switch(C.label){case 0:if(n=_T(e,"img","toPixels"),e instanceof e_||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),f=l[0],h=l[1],d=f[0],p=h[0],u.dispose(),c.dispose(),"float32"===n.dtype){if(d<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+p+"].")}for(v="float32"===n.dtype?255:1,m=new Uint8ClampedArray(i*a*4),g=0;g<a*i;++g)y=void 0,b=void 0,x=void 0,w=void 0,1===o?(y=s[g]*v,b=s[g]*v,x=s[g]*v,w=255):3===o?(y=s[3*g]*v,b=s[3*g+1]*v,x=s[3*g+2]*v,w=255):4===o&&(y=s[4*g]*v,b=s[4*g+1]*v,x=s[4*g+2]*v,w=s[4*g+3]*v),m[0+(k=4*g)]=Math.round(y),m[k+1]=Math.round(b),m[k+2]=Math.round(x),m[k+3]=Math.round(w);return null!=t&&(t.width=i,t.height=a,E=t.getContext("2d"),S=new ImageData(m,i,a),E.putImageData(S,0,0)),n!==e&&n.dispose(),[2,m]}}))}))},fromPixels:aU}),function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}()),oU=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function sU(e){iI(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),iI("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),iI(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),oU.register(e)}Object.freeze({Serializable:iU,SerializationMap:oU,registerClass:sU}),Object.freeze({gpgpu_util:iD,webgl_util:bT,forceHalfFloat:function(){qC().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:yP,setWebGLContext:S_,GPGPUContext:oD});var uU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return VC(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return ET(i),t?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){iI(AI(e),(function(){return"The f passed in variableGrads(f) must be a function"})),iI(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof o_})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],m_.registeredVariables)t.push(m_.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;iI((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var o=m_.gradients(e,t,null,!0),s=o.value,u=o.grads;iI(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),iI(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&ET(this.iterations_)},t.prototype.saveIterations=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:qT(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(iU);Object.defineProperty(uU,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var cU=function(e){function t(t,n,r){void 0===r&&(r=null);var a=e.call(this)||this;return a.learningRate=t,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=m_.backend.epsilon()),a}return VC(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=m_.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:kT((function(){return nN(a).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:kT((function(){return nN(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;kT((function(){var e=o.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(a);a.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(ET(this.accumulatedGrads.map((function(e){return e.variable}))),ET(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(uU);sU(cU);var lU=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return VC(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=m_.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:kT((function(){return JT(a.shape,t.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;kT((function(){var e=o.add(i.square());o.assign(e);var n=i.div(e.add(m_.backend.epsilon()).sqrt()).mul(-t.learningRate).add(a);a.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&ET(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(uU);sU(lU);var fU=function(e){function t(t,n,r,a){void 0===a&&(a=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],kT((function(){i.accBeta1=qT(n).variable(),i.accBeta2=qT(r).variable()})),null==a&&(i.epsilon=m_.backend.epsilon()),i}return VC(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);kT((function(){var r=OR(1,t.accBeta1),a=OR(1,t.accBeta2);n.forEach((function(n,i){var o=m_.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:kT((function(){return nN(o).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:kT((function(){return nN(o).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),h=l.div(r),d=f.div(a);u.assign(l),c.assign(f);var p=h.div(d.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(p)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&ET(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&ET(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){var t,n=this;return jC(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),kT((function(){n.accBeta1.assign(NR(n.beta1,n.iterations_+1)),n.accBeta2.assign(NR(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(uU);sU(fU);var hU=function(e){function t(t,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],kT((function(){o.iteration=qT(0).variable(),o.accBeta1=qT(n).variable()})),null==a&&(o.epsilon=m_.backend.epsilon()),o}return VC(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);kT((function(){var r=OR(1,t.accBeta1),a=PR(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var o=m_.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:nN(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:nN(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2),h=s.abs(),d=f.maximum(h);u.assign(l),c.assign(d);var p=a.div(r).mul(l.div(d.add(t.epsilon))).add(o);o.assign(p)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&ET(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&ET(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(uU);sU(hU);var dU=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return VC(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=m_.registeredVariables[n];kT((function(){var e=t.c.mul(a).add(i);i.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return m_.keep(e)}(qT(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(uU);sU(dU);var pU=function(e){function t(t,n,r){void 0===r&&(r=!1);var a=e.call(this,t)||this;return a.learningRate=t,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=qT(a.momentum),a}return VC(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=m_.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:kT((function(){return nN(a).variable(!1)}))});var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&kT((function(){var e,n=t.m.mul(i).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(a):t.c.mul(n).add(a),i.assign(n),a.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&ET(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){return jC(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){return jC(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(dU);sU(pU);var vU=function(e){function t(t,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=e.call(this)||this;if(o.learningRate=t,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=m_.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return VC(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=m_.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:kT((function(){return nN(a).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:kT((function(){return nN(a).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:kT((function(){return nN(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;kT((function(){var e=o.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(u),s.assign(c);var l=a.sub(c);a.assign(l)}else{var f=o.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(f.add(t.epsilon).sqrt())),o.assign(f),s.assign(c),l=a.sub(c),a.assign(l)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&ET(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&ET(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&ET(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return zC(this,void 0,void 0,(function(){var e;return jC(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return zC(this,void 0,void 0,(function(){var t;return jC(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(uU);sU(vU);var mU=function(){function e(){}return e.sgd=function(e){return new dU(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new pU(e,t,n)},e.rmsprop=function(e,t,n,r,a){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new vU(e,t,n,r,a)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new fU(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new cU(e,t,n)},e.adamax=function(e,t,n,r,a){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new hU(e,t,n,r,a)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new lU(e,t)},e}();mU.sgd,mU.momentum,mU.adadelta,mU.adagrad,mU.rmsprop,mU.adamax,mU.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;e_.prototype.add=function(e){return DN(this,e)},e_.prototype.broadcastTo=function(e){return HP(this,e)},e_.prototype.div=function(e){return PR(this,e)},e_.prototype.divNoNan=function(e){return JP(this,e)},e_.prototype.squaredDifference=function(e){return bM(this,e)},e_.prototype.tile=function(e){return ZP(this,e)},e_.prototype.oneHot=function(e,t,n){return void 0===t&&(t=1),void 0===n&&(n=0),nM(this,e,t,n)},e_.prototype.transpose=function(e){return QR(this,e)},e_.prototype.pad=function(e,t){return rM(this,e,t)},e_.prototype.batchNorm=function(e,t,n,r,a){return PP(this,e,t,n,r,a)},JI=FL;var gU,yU,bU=function(){return(bU=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function xU(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function wU(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(gU||(gU={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(yU||(yU={}));var kU={};function EU(e){return kU[e]}function SU(e,t,n,r){var a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return CU(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return t.inputNames.slice(i,o).map((function(e){return CU(e,n,r)}));var s=Array.prototype.slice.call(CU(t.inputNames.slice(i)[0],n,r).dataSync());return"number"===a.type?s[0]:s}var u=t.attrParams[e];return u&&u.value}function CU(e,t,n){var r=TU(e),a=r[0],i=r[1],o=n.currentContextIds.find((function(e){return!!t[_U(a,e)]}));return void 0!==o?t[_U(a,o)][i]:void 0}function IU(e,t){var n=TU(e),r=n[0],a=n[1];return[_U(r,t&&t.currentContextId),a]}function _U(e,t){return t?e+"-"+t:e}function TU(e){var t=e.lastIndexOf(":");return-1===t?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function NU(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var RU=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),AU=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),OU=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),DU=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),PU=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),MU=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),FU=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),LU=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),BU=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),UU=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),VU=Object.freeze({json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),zU=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),jU=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),WU=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),HU=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),qU=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),GU=function(){function e(){var e=[RU,AU,OU,DU,PU,MU,FU,UU,BU,LU,VU,zU,jU,WU,HU,qU],t=[].concat.apply([],e.map((function(e){return e.json})));this.opMappers=t.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(e,t){var n=this;void 0===t&&(t={});var r=[],a=[],i=e.node.reduce((function(e,t){return e[t.name]=n.mapNode(t),t.op.startsWith("Placeholder")&&r.push(e[t.name]),"Const"===t.op&&a.push(e[t.name]),e}),{}),o=[],s=[],u={},c={};null!=t&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));var l=Object.keys(i);return l.forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=IU(e)[0];t.inputs.push(i[n]),i[n].children.push(t)}))})),0===Object.keys(c).length?l.forEach((function(e){var t=i[e];0===t.children.length&&s.push(t)})):Object.keys(c).forEach((function(e){var t=IU(e)[0],n=i[t];null!=n&&(n.signatureKey=c[e],s.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((function(e){var t=IU(e)[0],n=i[t];n&&(n.signatureKey=u[e],o.push(n))})):o=r,{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:t}},e.prototype.mapSignatureEntries=function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})},e.prototype.mapNode=function(e){var t=EU(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=XU(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=XU(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=rV(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=rV(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=QU(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=QU(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=nV(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=nV(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=$U(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=$U(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=iV(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=iV(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=tV(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=tV(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=aV(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=aV(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=JU(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=JU(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=ZU(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ZU(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+e.op)}return t[n.name]={value:a,type:r},t}),{})),n},e}();function KU(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=qC().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function XU(e,t,n,r){void 0===r&&(r=!1);var a=e[t];return null!=a?KU(a.s,r):n}function $U(e,t,n){var r=e[t];return r?r.b:n}function QU(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function YU(e){switch("string"==typeof e&&(e=gU[e]),e){case gU.DT_FLOAT:return"float32";case gU.DT_INT32:case gU.DT_INT64:case gU.DT_INT8:case gU.DT_UINT8:return"int32";case gU.DT_BOOL:return"bool";case gU.DT_DOUBLE:return"float32";case gU.DT_STRING:return"string";default:return null}}function JU(e,t,n){var r=e[t];return r&&r.type?YU(r.type):n}function ZU(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return YU(e)})):n}function eV(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"==typeof e.size?e.size:parseInt(e.size,10)})):[]}function tV(e,t,n){var r=e[t];return r&&r.shape?eV(r.shape):n}function nV(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"==typeof e?e:parseInt(e,10)})):n}function rV(e,t,n,r){void 0===r&&(r=!1);var a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return KU(e,r)})):n}function aV(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return eV(e)})):n}function iV(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var oV=function(){function e(e,t,n){var r=this;this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((function(e){return r.getInput(e)})),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((function(e,t){return e[t]=r.getAttr(t),e}),{}))}return e.prototype.getInput=function(e){return CU(e,this.tensorMap,this.context)},e.prototype.getAttr=function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return CU(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return QU(this.node.rawAttrs,e,t);if(null!=n.s)return XU(this.node.rawAttrs,e,t);if(null!=n.b)return $U(this.node.rawAttrs,e,t);if(null!=n.shape)return tV(this.node.rawAttrs,e,t);if(null!=n.type)return JU(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return nV(this.node.rawAttrs,e,t);if(null!=n.list.s)return rV(this.node.rawAttrs,e,t);if(null!=n.list.shape)return aV(this.node.rawAttrs,e,t);if(null!=n.list.b)return iV(this.node.rawAttrs,e,t);if(null!=n.list.type)return ZU(this.node.rawAttrs,e,t)}return t},e}(),sV=function(){function e(t,n,r,a,i,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach((function(e){return e.tensor.dispose()})),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.tensors.length)throw new Error("Tried to read from index "+e+", but array size is: "+this.tensors.length);var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},e.prototype.readMany=function(e){var t=this;return e.map((function(e){return t.read(e)}))},e.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+",\n          because the value dtype is "+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");n.tensor=t,n.written=!0,this.tensors[e]=n},e.prototype.writeMany=function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+e.length+" is not the same as tensors size: "+t.length+".");e.forEach((function(e,r){return n.write(e,t[r])}))},e.prototype.gather=function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(!e){e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return WT([],[0].concat(this.elementShape));var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),yN(r,0)},e.prototype.concat=function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(0===this.size())return WT([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),rN(r,0)},e.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var n=Math.max.apply(Math,e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(e,bN(t,0))},e.prototype.split=function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];kT((function(){t=t.reshape([1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],i];o[s]=dF(t,u,c).reshape(n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)},e.prototype.assertShapesMatchAllowUndefinedSize=function(e,t,n){void 0===n&&(n=""),HI.assert(this.shapesEqualAllowUndefinedSize(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))},e.prototype.shapesEqualAllowUndefinedSize=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0},e.nextId=0,e}();function uV(e,t,n){var r=function(e,t,n){switch(e.category){case"arithmetic":return kT((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[DN(SU("a",e,t,n),SU("b",e,t,n))];case"AddN":return[TP(SU("tensors",e,t,n))];case"FloorMod":case"Mod":return[CR(SU("a",e,t,n),SU("b",e,t,n))];case"Mul":return[_R(SU("a",e,t,n),SU("b",e,t,n))];case"RealDiv":case"Div":return[PR(SU("a",e,t,n),SU("b",e,t,n))];case"DivNoNan":return[JP(SU("a",e,t,n),SU("b",e,t,n))];case"FloorDiv":return[xR(SU("a",e,t,n),SU("b",e,t,n))];case"Sub":return[OR(SU("a",e,t,n),SU("b",e,t,n))];case"Minimum":return[ER(SU("a",e,t,n),SU("b",e,t,n))];case"Maximum":return[wR(SU("a",e,t,n),SU("b",e,t,n))];case"Pow":return[NR(SU("a",e,t,n),SU("b",e,t,n))];case"SquaredDifference":return[bM(SU("a",e,t,n),SU("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"basic_math":return kT((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[LN(SU("x",e,t,n))];case"Acos":return[BN(SU("x",e,t,n))];case"Acosh":return[UN(SU("x",e,t,n))];case"Asin":return[VN(SU("x",e,t,n))];case"Asinh":return[zN(SU("x",e,t,n))];case"Atan":return[jN(SU("x",e,t,n))];case"Atan2":return[yR(SU("x",e,t,n),SU("y",e,t,n))];case"Atanh":return[WN(SU("x",e,t,n))];case"Ceil":return[HN(SU("x",e,t,n))];case"Complex":return[VT(SU("real",e,t,n),SU("imag",e,t,n))];case"Cos":return[GN(SU("x",e,t,n))];case"Cosh":return[KN(SU("x",e,t,n))];case"Elu":return[RF(SU("x",e,t,n))];case"Erf":return[XN(SU("x",e,t,n))];case"Exp":return[$N(SU("x",e,t,n))];case"Expm1":return[QN(SU("x",e,t,n))];case"Floor":return[YN(SU("x",e,t,n))];case"Log":return[JN(SU("x",e,t,n))];case"Log1p":return[ZN(SU("x",e,t,n))];case"Imag":return[jT(SU("x",e,t,n))];case"Neg":return[tR(SU("x",e,t,n))];case"Reciprocal":return[nR(SU("x",e,t,n))];case"Real":return[zT(SU("x",e,t,n))];case"Relu":return[DF(SU("x",e,t,n))];case"Round":return[rR(SU("x",e,t,n))];case"Selu":return[MF(SU("x",e,t,n))];case"Sigmoid":return[iR(SU("x",e,t,n))];case"Sin":return[lR(SU("x",e,t,n))];case"Sign":return[oR(SU("x",e,t,n))];case"Sinh":return[fR(SU("x",e,t,n))];case"Softplus":return[hR(SU("x",e,t,n))];case"Sqrt":return[dR(SU("x",e,t,n))];case"Square":return[yM(SU("x",e,t,n))];case"Tanh":return[mR(SU("x",e,t,n))];case"Tan":return[vR(SU("x",e,t,n))];case"Relu6":case"ClipByValue":return[qN(SU("x",e,t,n),SU("clipValueMin",e,t,n),SU("clipValueMax",e,t,n))];case"Rsqrt":return[aR(CU(e.inputNames[0],t,n))];case"Prod":return[NF(SU("x",e,t,n),SU("axes",e,t,n))];case"LeakyRelu":return[AF(SU("x",e,t,n),SU("alpha",e,t,n))];case"Prelu":return[OF(SU("x",e,t,n),SU("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"control":return function(e,t,n){return xU(void 0,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,d,p,v,m,g,y,b,x,w,k,E,S,C,I,_,T,N,R,A,O,D,P,M,F;return wU(this,(function(L){switch(L.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[SU("pred",e,t,n).clone()]];case 2:return r=SU("pred",e,t,n),a=SU("data",e,t,n),[4,r.data()];case 3:return[2,L.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(i=e.inputNames.find((function(e){return void 0!==CU(e,t,n)})))?[CU(i,t,n).clone()]:void 0];case 5:return o=SU("frameName",e,t,n),s=SU("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=SU("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return c=SU("tensor",e,t,n),n.nextIteration(),[2,[c.clone()]];case 8:return l=SU("size",e,t,n),f=SU("dtype",e,t,n),h=SU("elementShape",e,t,n),d=SU("dynamicSize",e,t,n),p=SU("clearAfterRead",e,t,n),v=SU("identicalElementShapes",e,t,n),m=SU("name",e,t,n),g=new sV(m,f,l,h,v,d,p),n.addTensorArray(g),[2,[qT(g.id),qT(1)]];case 9:return y=SU("tensorArrayId",e,t,n),b=SU("index",e,t,n),x=SU("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[qT(1)]];case 10:return w=SU("tensorArrayId",e,t,n),k=SU("index",e,t,n),[2,[n.getTensorArray(w).read(k)]];case 11:return E=SU("tensorArrayId",e,t,n),S=SU("indices",e,t,n),C=SU("dtype",e,t,n),[2,[n.getTensorArray(E).gather(S,C)]];case 12:return I=SU("tensorArrayId",e,t,n),_=SU("indices",e,t,n),T=SU("tensor",e,t,n),n.getTensorArray(I).scatter(_,T),[2,[qT(1)]];case 13:return N=SU("tensorArrayId",e,t,n),R=n.getTensorArray(N),A=SU("dtype",e,t,n),[2,[R.concat(A)]];case 14:return O=SU("tensorArrayId",e,t,n),D=SU("tensor",e,t,n),P=SU("lengths",e,t,n),n.getTensorArray(O).split(P,D),[2,[qT(1)]];case 15:return M=SU("tensorArrayId",e,t,n),[2,[qT(n.getTensorArray(M).size(),"int32")]];case 16:return F=SU("tensorArrayId",e,t,n),n.getTensorArray(F).clearAndClose(),[2,[qT(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}(e,t,n);case"convolution":return kT((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=SU("stride",e,t,n),a=SU("pad",e,t,n),i=SU("dataFormat",e,t,n).toUpperCase(),o=SU("dilation",e,t,n);return[VM(SU("x",e,t,n),SU("filter",e,t,n),r,a,i,o)];case"Conv2D":r=SU("strides",e,t,n),a=SU("pad",e,t,n),i=SU("dataFormat",e,t,n).toUpperCase();var s=SU("dilations",e,t,n);return[zM(SU("x",e,t,n),SU("filter",e,t,n),[r[1],r[2]],a,i,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=SU("fusedOps",e,t,n),c=u[0],l=u[1],f="biasadd"===c,h="prelu"===l,d="fusedbatchnorm"===c,p=SU("numArgs",e,t,n);if(f){if(h&&2!==p)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!h&&1!==p)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(d)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=SU("strides",e,t,n),a=SU("pad",e,t,n),i=SU("dataFormat",e,t,n).toUpperCase(),s=SU("dilations",e,t,n);var v=SU("args",e,t,n),m=v[0],g=v[1];return[("_FusedConv2D"===e.op?ML.conv2d:ML.depthwiseConv2d)({x:SU("x",e,t,n),filter:SU("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[s[1],s[2]],bias:m,activation:l,preluActivationWeights:g})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=SU("outputShape",e,t,n);return r=SU("strides",e,t,n),a=SU("pad",e,t,n),[$M(SU("x",e,t,n),SU("filter",e,t,n),y,[r[1],r[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=SU("strides",e,t,n),a=SU("pad",e,t,n),s=SU("dilations",e,t,n),i=SU("dataFormat",e,t,n).toUpperCase(),[qM(SU("input",e,t,n),SU("filter",e,t,n),[r[1],r[2]],a,i,[s[1],s[2]])];case"Conv3D":return r=SU("strides",e,t,n),a=SU("pad",e,t,n),i=SU("dataFormat",e,t,n).toUpperCase(),s=SU("dilations",e,t,n),[jM(SU("x",e,t,n),SU("filter",e,t,n),[r[1],r[2],r[3]],a,i,[s[1],s[2],s[3]])];case"AvgPool":r=SU("strides",e,t,n),a=SU("pad",e,t,n);var b=SU("kernelSize",e,t,n);return[uF(SU("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a)];case"MaxPool":return r=SU("strides",e,t,n),a=SU("pad",e,t,n),b=SU("kernelSize",e,t,n),[sF(SU("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a)];case"MaxPoolWithArgmax":r=SU("strides",e,t,n),a=SU("pad",e,t,n),b=SU("kernelSize",e,t,n);var x=SU("includeBatchInIndex",e,t,n),w=hF(SU("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a,x);return[w.result,w.indexes];case"AvgPool3D":return r=SU("strides",e,t,n),a=SU("pad",e,t,n),b=SU("kernelSize",e,t,n),[fF(SU("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],a)];case"MaxPool3D":return r=SU("strides",e,t,n),a=SU("pad",e,t,n),b=SU("kernelSize",e,t,n),[lF(SU("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],a)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"creation":return kT((function(){return function(e,t,n){switch(e.op){case"Fill":var r=SU("shape",e,t,n),a=SU("dtype",e,t,n);return[JT(r,SU("value",e,t,n),a)];case"LinSpace":var i=SU("start",e,t,n);return[ZT(i,SU("stop",e,t,n),SU("num",e,t,n))];case"Multinomial":var o=SU("logits",e,t,n),s=SU("numSamples",e,t,n),u=SU("seed",e,t,n);return[tM(o,s,u)];case"OneHot":var c=SU("indices",e,t,n),l=SU("depth",e,t,n),f=SU("onValue",e,t,n),h=SU("offValue",e,t,n);return[nM(c,l,f,h)];case"Ones":return[QT(SU("shape",e,t,n),SU("dtype",e,t,n))];case"OnesLike":return[tN(SU("x",e,t,n))];case"RandomUniform":return[gM(SU("shape",e,t,n),SU("minval",e,t,n),SU("maxval",e,t,n),SU("dtype",e,t,n))];case"Range":return[eN(i=SU("start",e,t,n),SU("stop",e,t,n),SU("step",e,t,n),SU("dtype",e,t,n))];case"TruncatedNormal":r=SU("shape",e,t,n);var d=SU("mean",e,t,n),p=SU("stdDev",e,t,n);return u=SU("seed",e,t,n),[xM(r,d,p,SU("dtype",e,t,n),u)];case"Zeros":return[YT(SU("shape",e,t,n),SU("dtype",e,t,n))];case"ZerosLike":return[nN(SU("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"dynamic":return function(e,t,n){return xU(void 0,void 0,void 0,(function(){var r,a,i,o,s,u,c,l;return wU(this,(function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=SU("boxes",e,t,n),a=SU("scores",e,t,n),i=SU("maxOutputSize",e,t,n),o=SU("iouThreshold",e,t,n),s=SU("scoreThreshold",e,t,n),"NonMaxSuppressionV5"!==e.op?[3,3]:(u=SU("softNmsSigma",e,t,n),[4,_L.nonMaxSuppressionWithScoreAsync(r,a,i,o,s,u)]);case 2:return[2,[(l=f.sent()).selectedIndices,l.selectedScores]];case 3:return[4,_L.nonMaxSuppressionAsync(r,a,i,o,s)];case 4:return[2,[f.sent()]];case 5:return c=SU("condition",e,t,n).asType("bool"),[4,YP(c)];case 6:return l=[f.sent()],c.dispose(),[2,l];case 7:return[2,xN(SU("x",e,t,n),SU("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}(e,t,n);case"evaluation":return kT((function(){return function(e,t,n){if("TopKV2"===e.op){var r=SU("x",e,t,n),a=SU("k",e,t,n),i=SU("sorted",e,t,n),o=jF(r,a,i);return[o.values,o.indices]}throw TypeError("Node type "+e.op+" is not implemented")}(e,t,n)}));case"image":return kT((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=SU("images",e,t,n),a=SU("size",e,t,n),i=SU("alignCorners",e,t,n);return[_L.resizeBilinear(r,[a[0],a[1]],i)];case"ResizeNearestNeighbor":return r=SU("images",e,t,n),a=SU("size",e,t,n),i=SU("alignCorners",e,t,n),[_L.resizeNearestNeighbor(r,[a[0],a[1]],i)];case"CropAndResize":var o=SU("image",e,t,n),s=SU("boxes",e,t,n),u=SU("boxInd",e,t,n),c=SU("cropSize",e,t,n),l=SU("method",e,t,n),f=SU("extrapolationValue",e,t,n);return[_L.cropAndResize(o,s,u,c,l,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"graph":return kT((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=SU("default",e,t,n);return[CU(e.name,t,n)||r];case"Placeholder":return[CU(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[SU("x",e,t,n).clone()];case"IdentityN":return SU("x",e,t,n).map((function(e){return e.clone()}));case"Shape":return[GT(SU("x",e,t,n).shape,"int32")];case"ShapeN":return SU("x",e,t,n).map((function(e){return GT(e.shape)}));case"Size":return[qT(SU("x",e,t,n).size,"int32")];case"Rank":return[qT(SU("x",e,t,n).rank,"int32")];case"NoOp":return[qT(1)];case"Print":var a=SU("x",e,t,n),i=SU("data",e,t,n),o=SU("message",e,t,n),s=SU("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"logical":return kT((function(){return function(e,t,n){switch(e.op){case"Equal":return[wM(SU("a",e,t,n),SU("b",e,t,n))];case"NotEqual":return[AM(SU("a",e,t,n),SU("b",e,t,n))];case"Greater":return[EM(SU("a",e,t,n),SU("b",e,t,n))];case"GreaterEqual":return[SM(SU("a",e,t,n),SU("b",e,t,n))];case"Less":return[_M(SU("a",e,t,n),SU("b",e,t,n))];case"LessEqual":return[TM(SU("a",e,t,n),SU("b",e,t,n))];case"LogicalAnd":return[GP(SU("a",e,t,n),SU("b",e,t,n))];case"LogicalNot":return[KP(SU("a",e,t,n))];case"LogicalOr":return[XP(SU("a",e,t,n),SU("b",e,t,n))];case"Select":case"SelectV2":return[QP(SU("condition",e,t,n),SU("a",e,t,n),SU("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"matrices":return kT((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[YM(SU("a",e,t,n),SU("b",e,t,n),SU("transposeA",e,t,n),SU("transposeB",e,t,n))];case"Transpose":return[QR(SU("x",e,t,n),SU("perm",e,t,n))];case"_FusedMatMul":var r=SU("fusedOps",e,t,n),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u=SU("numArgs",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=SU("args",e,t,n),l=c[0],f=c[1];return[ML.matMul({a:SU("a",e,t,n),b:SU("b",e,t,n),transposeA:SU("transposeA",e,t,n),transposeB:SU("transposeB",e,t,n),bias:l,activation:i,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"normalization":return kT((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[PP(SU("x",e,t,n),SU("mean",e,t,n),SU("variance",e,t,n),SU("offset",e,t,n),SU("scale",e,t,n),SU("epsilon",e,t,n))];case"LRN":return[FF(SU("x",e,t,n),SU("radius",e,t,n),SU("bias",e,t,n),SU("alpha",e,t,n),SU("beta",e,t,n))];case"Softmax":return[XR(SU("x",e,t,n))];case"LogSoftmax":return[$R(SU("x",e,t,n))];case"SparseToDense":return[$F(SU("sparseIndices",e,t,n),SU("outputShape",e,t,n),SU("sparseValues",e,t,n),SU("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"reduction":return kT((function(){return function(e,t,n){switch(e.op){case"Max":var r=SU("axis",e,t,n),a=SU("keepDims",e,t,n);return[SF(SU("x",e,t,n),r,a)];case"Mean":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[CF(SU("x",e,t,n),r,a)];case"Min":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[IF(SU("x",e,t,n),r,a)];case"Sum":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[TF(SU("x",e,t,n),r,a)];case"All":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[bF(SU("x",e,t,n),r,a)];case"Any":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[xF(SU("x",e,t,n),r,a)];case"ArgMax":return r=SU("axis",e,t,n),[wF(SU("x",e,t,n),r)];case"ArgMin":return r=SU("axis",e,t,n),[kF(SU("x",e,t,n),r)];case"Prod":return r=SU("axis",e,t,n),a=SU("keepDims",e,t,n),[NF(SU("x",e,t,n),r,a)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"slice_join":return kT((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=SU("n",e,t,n),a=SU("axis",e,t,n),i=SU("tensors",e,t,n);return i=i.slice(0,r),[rN(i,a)];case"GatherV2":case"Gather":a=SU("axis",e,t,n);var o=SU("x",e,t,n),s=SU("indices",e,t,n);return[MM(o,s.asType("int32"),a)];case"ReverseV2":case"Reverse":return a=SU("axis",e,t,n),o=SU("x",e,t,n),[eF(o,a)];case"Slice":var u=SU("begin",e,t,n),c=SU("size",e,t,n);return[dF(SU("x",e,t,n),u,c)];case"StridedSlice":u=SU("begin",e,t,n);var l=SU("end",e,t,n),f=SU("strides",e,t,n),h=SU("beginMask",e,t,n),d=SU("endMask",e,t,n),p=SU("ellipsisMask",e,t,n),v=SU("newAxisMask",e,t,n),m=SU("shrinkAxisMask",e,t,n),g=SU("x",e,t,n);if(1===u.length&&g.shape.length>1)for(var y=1;y<g.shape.length;y++)u.push(0),l.push(g.shape[y]),f.push(f[0]);return[zF(g,u,l,f,h,d,p,v,m)];case"Pack":return kT((function(){var r=SU("axis",e,t,n),a=SU("tensors",e,t,n),i=a[0].shape,o=a[0].squeeze().shape,s=a.map((function(e){var t=HI.arraysEqual(e.shape,i);if(!t&&!HI.arraysEqual(e.squeeze().shape,o))throw new Error("the input tensors shape does not match");return t?e:e.reshape(i)}));return[yN(s,r)]}));case"Unpack":return kT((function(){var r=SU("axis",e,t,n),a=SU("tensor",e,t,n);return bN(a,r)}));case"Tile":var b=SU("reps",e,t,n);return[ZP(SU("x",e,t,n),b)];case"Split":case"SplitV":a=SU("axis",e,t,n);var x=SU("numOrSizeSplits",e,t,n);return uN(SU("x",e,t,n),x,a);case"ScatterNd":s=SU("indices",e,t,n);var w=SU("values",e,t,n),k=SU("shape",e,t,n);return[WF(s,w,k)];case"GatherNd":var E=SU("x",e,t,n);return s=SU("indices",e,t,n),[QF(E,s)];case"SparseToDense":s=SU("sparseIndices",e,t,n),k=SU("outputShape",e,t,n);var S=SU("sparseValues",e,t,n),C=SU("defaultValue",e,t,n);return[$F(s,S,k,S.dtype===C.dtype?C:C.asType(S.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"spectral":return kT((function(){return function(e,t,n){switch(e.op){case"FFT":return[HF(SU("x",e,t,n))];case"IFFT":return[qF(SU("x",e,t,n))];case"RFFT":return[GF(SU("x",e,t,n))];case"IRFFT":return[KF(SU("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"transformation":return kT((function(){return function(e,t,n){switch(e.op){case"Cast":return[fN(SU("x",e,t,n),SU("dtype",e,t,n))];case"ExpandDims":var r=SU("axis",e,t,n);return[pN(SU("x",e,t,n),r)];case"Squeeze":return r=SU("axis",e,t,n),[gN(SU("x",e,t,n),r)];case"Reshape":return[vN(SU("x",e,t,n),SU("shape",e,t,n))];case"PadV2":case"Pad":return[rM(SU("x",e,t,n),NU(SU("padding",e,t,n),2),SU("constantValue",e,t,n))];case"SpaceToBatchND":var a=SU("blockShape",e,t,n),i=NU(SU("paddings",e,t,n),2);return[mN(SU("x",e,t,n),a,i)];case"BatchToSpaceND":a=SU("blockShape",e,t,n);var o=NU(SU("crops",e,t,n),2);return[lN(SU("x",e,t,n),a,o)];case"DepthToSpace":var s=SU("blockSize",e,t,n),u=SU("dataFormat",e,t,n).toUpperCase();return[dN(SU("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"custom":var r=EU(e.op);if(r&&r.customExecutor)return r.customExecutor(new oV(e,t,n));throw TypeError("Custom op "+e.op+" is not registered.");default:throw TypeError("Unknown op '"+e.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then((function(e){return[].concat(e)})):[].concat(r)}var cV=function(){function e(e,t){this.weightMap=e,this.tensorArrayMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e},e.prototype.contextIdforContexts=function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":e.frameName+"-"+e.iterationId})).join("/"):""},e.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(e){return this.weightMap[e]},e.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},e.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},e}();function lV(e,t,n){for(var r=new Set,a=[],i=null,o=null,s=new Set,u=Object.keys(e).map((function(e){return TU(e)[0]})),c=t.slice();c.length>0;){var l=c.pop();(dV(l)||pV(l))&&null==i&&(o=(i=l).children.map((function(e){return e.name})).filter((function(e){return r.has(e)}))),r.add(l.name),null==n[l.name]&&-1===u.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(e){s.has(e.name)||(s.add(e.name),c.push(e))})):a.push(l.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}var fV=["Switch","Merge","Enter","Exit","NextIteration"],hV=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function dV(e){return fV.indexOf(e.op)>=0}function pV(e){return hV.indexOf(e.op)>=0}var vV=function(){function e(e){this.graph=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=e.outputs,this._inputs=e.inputs,this._signature=e.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map((function(e){return e.signatureKey||e.name}))},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},e.prototype.compile=function(e,t){var n=lV(e,t,this.weightMap),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+i+"]");if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[];Object.keys(a).map((function(e){return TU(e)[0]})).map((function(t){return e.nodes[t]})).forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var o=new Set,s=[];i.length>0;){var u=i.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach((function(e){!o.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return o.has(e.name)}))&&i.push(e)}))}return s}(this.graph,this.weightMap,n)},e.prototype.execute=function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[TU(e)[0]]})),i=t.map((function(e){return n.graph.nodes[TU(e)[0]]})),o=this.getCompilationKey(a,i),s=this.compiledMap.get(o);null==s&&(s=this.compile(e,i),this.compiledMap.set(o,s));var u={};return kT((function(){var r=new cV(n._weightMap,u),a=bU({},n.weightMap);Object.keys(e).forEach((function(t){var n=TU(t),r=n[0],i=[];i[n[1]]=e[t],a[r]=i}));for(var i=n.getFrozenTensorIds(a),o={},c=0;c<s.length;c++){var l=s[c];if(!a[l.name]){var f=uV(l,a,r);if(f instanceof Promise)throw new Error("The execution of the op '"+l.op+"' returned a promise. Please use model.executeAsync() instead.");a[l.name]=f,n.checkTensorForDisposal(l.name,l,a,r,i,t,o)}}return t.map((function(e){return CU(e,a,r)}))}))},e.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)},e.prototype.checkTensorForDisposal=function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[_U(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))},e.prototype.executeAsync=function(e,t){return xU(this,void 0,void 0,(function(){var n,r,a,i,o,s,u=this;return wU(this,(function(c){switch(c.label){case 0:return e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t),n={},r=new cV(this._weightMap,n),[4,this.executeWithControlFlow(e,r,t)];case 1:return a=c.sent(),i=t.map((function(e){return CU(e,a,r)})),o=new Set(i.map((function(e){return e.id}))),s=new Set(Object.keys(e).map((function(t){return e[t].id}))),Object.keys(a).forEach((function(e){a[e].forEach((function(e){!e||e.isDisposed||o.has(e.id)||s.has(e.id)||-1!==u.weightIds.indexOf(e.id)||e.dispose()}))})),[2,i]}}))}))},e.prototype.executeWithControlFlow=function(e,t,n){return xU(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,d,p,v,m,g,y,b=this;return wU(this,(function(x){switch(x.label){case 0:r=Object.keys(e),a=r.map((function(e){return b.graph.nodes[TU(e)[0]]})),i=n.map((function(e){return b.graph.nodes[TU(e)[0]]})),o=lV(e,i,this.weightMap),s=o.usedNodes,u=o.missingInputs,c=o.dynamicNode,l=o.syncInputs,f=a.concat(this.graph.weights).map((function(e){return{node:e,contexts:t.currentContext}})),h=bU({},this.weightMap),Object.keys(e).forEach((function(t){var n=TU(t),r=n[0],a=[];a[n[1]]=e[t],h[r]=a})),d={},p=this.getFrozenTensorIds(h),v={},x.label=1;case 1:return f.length>0?(m=this.processStack(a,f,t,h,v,p,n,d,s),[4,Promise.all(m)]):[3,3];case 2:return x.sent(),[3,1];case 3:if(null==c&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(g=i.filter((function(e){return!dV(e)&&!CU(e.name,h,t)})).map((function(e){return e.name}))).length>0)throw y="",null!=c&&(y="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+l+"]"),new Error("Cannot compute the outputs ["+g+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+u+"]. "+y);return[2,h]}}))}))},e.prototype.processStack=function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],f=function(){var f=t.pop();n.currentContext=f.contexts;var d="";if("Enter"===f.node.op&&SU("isConstant",f.node,r,n)&&(d=IU(f.node.name,n)[0]),-1===e.indexOf(f.node)){var p=uV(f.node,r,n);d||(d=IU(f.node.name,n)[0]);var v=n.currentContext;p instanceof Promise?l.push(p.then((function(e){return r[d]=e,n.currentContext=v,c.checkTensorForDisposal(d,f.node,r,n,i,o,s),c.processChildNodes(f.node,t,n,r,a,u),e}))):(r[d]=p,h.checkTensorForDisposal(d,f.node,r,n,i,o,s),h.processChildNodes(f.node,t,n,r,a,u))}else h.processChildNodes(f.node,t,n,r,a,u)},h=this;t.length>0;)f();return l},e.prototype.processChildNodes=function(e,t,n,r,a,i){e.children.forEach((function(e){var o=IU(e.name,n)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!CU(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!CU(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))},e.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))},e.prototype.checkInputShapeAndType=function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=TU(n)[0],i=t.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((function(e,t){return-1===o[t]||o[t]===e}));HI.assert(s,(function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+o+"], but was ["+r.shape+"]"}))}i.attrParams.dtype&&i.attrParams.dtype.value&&HI.assert(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+r.dtype}))}))},e.prototype.mapInputs=function(e){var t={};for(var n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t},e.prototype.checkInputs=function(e){var t=this,n=Object.keys(e).filter((function(e){var n=TU(e)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},e.prototype.mapOutputs=function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})},e.prototype.checkOutputs=function(e){var t=this;e.forEach((function(e){var n=TU(e)[0];if(!t.graph.nodes[n])throw new Error("The output '"+e+"' is not found in the graph")}))},e}(),mV=function(){function e(e,t){void 0===t&&(t={}),this.modelUrl=e,this.loadOptions=t,this.version="n/a",null==t&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=nU.browserHTTPRequest(e,this.loadOptions);else{var t=nU.getLoadHandlers(e,this.loadOptions.onProgress);if(0===t.length)t.push(nU.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for URL '"+[e]+"'");this.handler=t[0]}},e.prototype.load=function(){return xU(this,void 0,void 0,(function(){var e,t,n,r;return wU(this,(function(a){switch(a.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return e=this,[4,this.handler.load()];case 1:return e.artifacts=a.sent(),t=this.artifacts.modelTopology,n={},null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=t.versions.producer+"."+t.versions.minConsumer,r=nU.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new vV(GU.Instance.transformGraph(t,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},e.prototype.save=function(e,t){return xU(this,void 0,void 0,(function(){var t;return wU(this,(function(n){if("string"==typeof e){if(0===(t=nU.getSaveHandlers(e)).length)throw new Error("Cannot find any save handlers for URL '"+e+"'");if(t.length>1)throw new Error("Found more than one ("+t.length+") save handlers for URL '"+e+"'");e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,e.save(this.artifacts)]}))}))},e.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},e.prototype.normalizeInputs=function(e){if(!(e instanceof e_||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+e.length+" input tensors.");return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})},e.prototype.normalizeOutputs=function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]},e.prototype.execute=function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]},e.prototype.executeAsync=function(e,t){return xU(this,void 0,void 0,(function(){var n;return wU(this,(function(r){switch(r.label){case 0:return e=this.normalizeInputs(e),t=this.normalizeOutputs(t),[4,this.executor.executeAsync(e,t)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},e.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})},e.prototype.dispose=function(){this.executor.dispose()},e}();function gV(e,t){return void 0===t&&(t={}),xU(this,void 0,void 0,(function(){var n;return wU(this,(function(r){switch(r.label){case 0:if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==t&&(t={}),t.fromTFHub&&null==e.load&&(e.endsWith("/")||(e+="/"),e+="model.json?tfjs-format=file"),[4,(n=new mV(e,t)).load()];case 1:return r.sent(),[2,n]}}))}))}function yV(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function bV(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function xV(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function wV(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var kV=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var a=r[n];t.push(a)}return t},EV=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},SV=function(){function e(){this.root=new EV}return e.prototype.insert=function(e,t,n){for(var r=this.root,a=kV(e),i=0;i<a.length;i++)r.children[a[i]]||(r.children[a[i]]=new EV,r.children[a[i]].parent=r,r.children[a[i]].word[0]=r.word[0].concat(a[i])),r=r.children[a[i]],i===a.length-1&&(r.end=!0,r.word[1]=t,r.word[2]=n)},e.prototype.commonPrefixSearch=function(e){for(var t=[],n=this.root.children[e[0]],r=0;r<e.length&&n;r++)n.end&&t.push(n.word),n=n.children[e[r+1]];return t.length||t.push([[e[0]],0,0]),t},e}();var CV=function(){function e(e){this.vocabulary=e,this.trie=new SV;for(var t=6;t<this.vocabulary.length;t++)this.trie.insert(this.vocabulary[t][0],this.vocabulary[t][1],t)}return e.prototype.encode=function(e){var t=[],n=[],r=[];e=function(e){return"\u2581"+e.normalize("NFKC").replace(/ /g,"\u2581")}(e);for(var a=kV(e),i=0;i<=a.length;i++)t.push({}),n.push(0),r.push(0);for(i=0;i<a.length;i++)for(var o=this.trie.commonPrefixSearch(a.slice(i)),s=0;s<o.length;s++){var u=o[s],c={key:u[0],score:u[1],index:u[2]};null==t[i+(l=u[0].length)][i]&&(t[i+l][i]=[]),t[i+l][i].push(c)}for(var l=0;l<=a.length;l++)for(var f in t[l]){var h=t[l][f];for(s=0;s<h.length;s++){var d=h[s],p=d.score+r[l-d.key.length];(0===r[l]||p>=r[l])&&(r[l]=p,n[l]=h[s].index)}}for(var v=[],m=n.length-1;m>0;)v.push(n[m]),m-=this.vocabulary[n[m]][0].length;var g=[],y=!1;for(i=0;i<v.length;i++){var b=v[i];y&&0===b||g.push(b),y=0===b}return g.reverse()},e}();function IV(e){return xV(this,void 0,void 0,(function(){var t;return wV(this,(function(n){switch(n.label){case 0:return[4,_V(e)];case 1:return t=n.sent(),[2,new CV(t)]}}))}))}function _V(e){return void 0===e&&(e="https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/vocab.json"),xV(this,void 0,void 0,(function(){return wV(this,(function(t){switch(t.label){case 0:return[4,HI.fetch(e)];case 1:return[2,t.sent().json()]}}))}))}function TV(e,t){return yV(this,void 0,void 0,(function(){var n;return bV(this,(function(r){switch(r.label){case 0:return[4,(n=new VV(e,t)).load()];case 1:return r.sent(),[2,n]}}))}))}var NV,RV,AV,OV,DV,PV,MV,FV,LV,BV,UV,VV=function(){function e(e,t){void 0===e&&(e=.85),void 0===t&&(t=[]),this.threshold=e,this.toxicityLabels=t}return e.prototype.loadModel=function(){return yV(this,void 0,void 0,(function(){return bV(this,(function(e){return[2,gV("https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1",{fromTFHub:!0})]}))}))},e.prototype.loadTokenizer=function(){return yV(this,void 0,void 0,(function(){return bV(this,(function(e){return[2,IV()]}))}))},e.prototype.load=function(){return yV(this,void 0,void 0,(function(){var e,t,n,r=this;return bV(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.loadModel(),this.loadTokenizer()])];case 1:return e=a.sent(),t=e[0],n=e[1],this.model=t,this.tokenizer=n,this.labels=t.outputs.map((function(e){return e.name.split("/")[0]})),0===this.toxicityLabels.length?this.toxicityLabels=this.labels:HI.assert(this.toxicityLabels.every((function(e){return r.labels.indexOf(e)>-1})),(function(){return"toxicityLabels argument must contain only items from the model heads "+r.labels.join(", ")+", got "+r.toxicityLabels.join(", ")})),[2]}}))}))},e.prototype.classify=function(e){return yV(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u=this;return bV(this,(function(c){switch(c.label){case 0:for("string"==typeof e&&(e=[e]),t=e.map((function(e){return u.tokenizer.encode(e)})),n=t.map((function(e,t){return e.map((function(e,n){return[t,n]}))})),r=[],a=0;a<n.length;a++)r=r.concat(n[a]);return i=KT(r,[r.length,2],"int32"),o=GT(HI.flatten(t),"int32"),[4,this.model.executeAsync({Placeholder_1:i,Placeholder:o})];case 1:return s=c.sent(),i.dispose(),o.dispose(),[2,s.map((function(e,t){return{data:e,headIndex:t}})).filter((function(e){return u.toxicityLabels.indexOf(u.labels[e.headIndex])>-1})).map((function(t){for(var n=t.data.dataSync(),r=[],a=0;a<e.length;a++){var i=n.slice(2*a,2*a+2),o=null;Math.max(i[0],i[1])>u.threshold&&(o=i[0]<i[1]),r.push({probabilities:i,match:o})}return{label:u.labels[t.headIndex],results:r}}))]}}))}))},e}(),zV=function(){var e=s((0,t.useState)(""),2),n=e[0],r=e[1],a=s((0,t.useState)(!1),2),i=(a[0],a[1]),o=s((0,t.useState)(!1),2),u=o[0],c=o[1],l=s((0,t.useState)(!1),2),f=l[0],h=l[1],d=s((0,t.useState)(!1),2),p=d[0],v=d[1],m=s((0,t.useState)(!1),2),g=m[0],y=m[1],b=(0,t.useRef)(null),x=(0,t.useContext)(sw).currentUser,w=(0,t.useContext)(aC).data,k=function(){var e=Ge(He().mark((function e(){var t,a,o,s;return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c(!0),v(!0),e.next=5,b.current.classify([n]);case 5:if(t=e.sent,v(!1),a=t[6].results[0].match,h(a),a){e.next=16;break}return e.next=12,Yx(Pb(iw,"threads",w.threadId),{messages:nw({id:BC(),text:n,senderId:x.uid,date:id.now()})});case 12:return e.next=14,Yx(Pb(iw,"chats",x.uid),(Ke(o={},w.threadId+".lastMessage",{text:n}),Ke(o,w.threadId+".date",tw()),o));case 14:return e.next=16,Yx(Pb(iw,"chats",w.user.uid),(Ke(s={},w.threadId+".lastMessage",{text:n}),Ke(s,w.threadId+".date",tw()),s));case 16:r(""),i(!1),c(!1),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0),i(!0),c(!1);case 26:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){function e(){return(e=Ge(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return.9,console.log("Loading model..."),e.next=4,TV(.9);case 4:b.current=e.sent,y(!0),console.log("Model loaded");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,ow.jsxs)(xC,{className:"null"===w.threadId&&"empty",children:[(0,ow.jsx)(wC,{type:"text",id:"text",value:n,placeholder:"null"!==w.threadId?"Send a message...":" ",onChange:function(e){r(e.target.value),h(!1)}}),f&&(0,ow.jsx)(kC,{children:"Pls be kind."}),(0,ow.jsx)("button",{disabled:u||!g||p||"null"===w.threadId,onClick:k,children:u?(0,ow.jsx)(xw,{}):(0,ow.jsx)(gw,{})})]})},jV=function(){var e,n=(0,t.useContext)(aC).data;return(0,ow.jsxs)(lC,{children:[(0,ow.jsx)(fC,{children:(0,ow.jsx)(hC,{children:null===(e=n.user)||void 0===e?void 0:e.displayName})}),(0,ow.jsx)(RC,{}),(0,ow.jsx)(zV,{})]})},WV=_E.div(NV||(NV=Ew(["\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),HV=_E.div(RV||(RV=Ew(["\n  border: 1px solid var(--slate-100);\n  border-radius: 10px;\n  overflow: hidden;\n  width: 90%;\n  height: 80%;\n  display: flex;\n  box-shadow: 0 4px 4px 0 var(--slate-200);\n\n  @media screen and (",") {\n    height: 95%;\n    width: 95%;\n  }\n"])),US.mobile),qV=function(){return(0,ow.jsx)(WV,{children:(0,ow.jsxs)(HV,{children:[(0,ow.jsx)(cC,{}),(0,ow.jsx)(jV,{})]})})},GV=_E.div(AV||(AV=Ew(["\n  background: linear-gradient(to left, var(--emerald-200), var(--emerald-600));\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;\n  margin: 0;\n"]))),KV=_E.div(OV||(OV=Ew(["\n  background-color: var(--emerald-100);\n  border-radius: 1rem;\n  padding: 2rem 1rem;\n  max-width: 80%;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1), 0 6px 6px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  @media screen and (",") {\n    max-width: 50%;\n  }\n"])),US.laptop),XV=_E.h1(DV||(DV=Ew(["\n  color: var(--emerald-900);\n  font-family: var(--logo-font);\n  font-size: 2rem;\n  font-weight: 700;\n  margin: 1rem;\n"]))),$V=_E.div(PV||(PV=Ew(["\n  width: 60%;\n\n  @media screen and (",") {\n    width: 100%;\n  }\n"])),US.mobile),QV=_E.div(MV||(MV=Ew(["\n  display: flex;\n  gap: 0.5rem;\n  align-items: center;\n\n  &.user {\n    flex-direction: row-reverse;\n  }\n"]))),YV=_E.div(FV||(FV=Ew(["\n  max-width: 80%;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n\n  &.user {\n    align-items: flex-end;\n  }\n"]))),JV=_E.div(LV||(LV=Ew(["\n  background-color: var(--slate-200);\n  padding: 0.6rem 0.8rem;\n  margin: 0.5rem 0;\n  border-radius: 10px 10px 10px 0px;\n  max-width: max-content;\n  font-size: small;\n  display: flex;\n  flex-direction: column;\n\n  &.user {\n    background-color: var(--emerald-600);\n    color: white;\n    border-radius: 10px 10px 0px 10px;\n  }\n"]))),ZV=_E.div(BV||(BV=Ew(["\n  margin-top: 1rem;\n\n  a {\n    margin: 1rem;\n    color: var(--slate-800);\n  }\n"]))),ez=function(){return(0,ow.jsx)(GV,{children:(0,ow.jsxs)(KV,{children:[(0,ow.jsx)(XV,{children:"notox"}),(0,ow.jsxs)($V,{children:[(0,ow.jsx)(QV,{children:(0,ow.jsx)(YV,{children:(0,ow.jsx)(JV,{children:"What is notox?"})})}),(0,ow.jsx)(QV,{className:"user",children:(0,ow.jsx)(YV,{children:(0,ow.jsx)(JV,{className:"user",children:"Notox is a chat application that uses AI to prevent rude and toxic messages from being sent."})})}),(0,ow.jsx)(QV,{children:(0,ow.jsx)(YV,{children:(0,ow.jsx)(JV,{children:"Why are you using AI? Can't you just filter out words?"})})}),(0,ow.jsx)(QV,{className:"user",children:(0,ow.jsx)(YV,{children:(0,ow.jsxs)(JV,{className:"user",children:["Through AI, the context is analyzed to measure the potential toxicity of a message. Consider the following sentences:",(0,ow.jsxs)("ul",{children:[(0,ow.jsxs)("li",{children:['"The weather is ',(0,ow.jsx)("strong",{children:"horrible"}),'."']}),(0,ow.jsxs)("li",{children:['"You are ',(0,ow.jsx)("strong",{children:"horrible"}),'."']})]}),'If a dictionary-based approach is used, both sentences would raise a flag for the use of the word "horrible". However with AI, the context is distinguished so only the second sentence would be flagged.']})})})]}),(0,ow.jsxs)(ZV,{children:[(0,ow.jsx)("a",{href:"https://github.com/gmlunesa/notox",target:"_blank",rel:"noreferrer",children:(0,ow.jsx)(mw,{})}),(0,ow.jsx)("a",{href:"https://gmlunesa.com",target:"_blank",rel:"noreferrer",children:(0,ow.jsx)(yw,{})}),(0,ow.jsx)(Be,{to:"/login",children:(0,ow.jsx)(bw,{})})]})]})})},tz=function(e){var t=e.children;return e.currentUser?t:(0,ow.jsx)(Te,{to:"/about"})},nz=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=Uk.apply(void 0,[e].concat(r)),o="sc-global-"+Hk(JSON.stringify(i)),s=new eE(i,o);function u(e){var n=_k(),r=Tk(),a=(0,t.useContext)(Qk),i=(0,t.useRef)(n.allocateGSInstance(o)).current;return n.server&&c(i,e,n,a,r),(0,t.useLayoutEffect)((function(){if(!n.server)return c(i,e,n,a,r),function(){return s.removeStyles(i,n)}}),[i,e,n,a,r]),null}function c(e,t,n,r,a){if(s.isStatic)s.renderStyles(e,qw,n,a);else{var i=Pw({},t,{theme:Vk(t,r,u.defaultProps)});s.renderStyles(e,i,n,a)}}return t.memo(u)}(UV||(UV=Ew(["\n  html {\n    --emerald-50: #ECFDF5;\n    --emerald-100: #D1FAE5;\n    --emerald-200: #A7F3D0;\n    --emerald-300: #6EE7B7;\n    --emerald-400: #34D399;\n    --emerald-500: #10B981;\n    --emerald-600: #059669;\n    --emerald-700: #047857;\n    --emerald-800: #065F46;\n    --emerald-900: #064E3B;\n\n    --slate-50: #F8FAFC;\n    --slate-100: #F1F5F9;\n    --slate-200: #E2E8F0;\n    --slate-300: #CBD5E1;\n    --slate-400: #94A3B8;\n    --slate-500: #64748B;\n    --slate-600: #475569;\n    --slate-700: #334155;\n    --slate-800: #1E293B;\n    --slate-900: #0F172A;\n\n    --primary-font: 'Inter', sans-serif;\n    --logo-font: 'Work Sans', sans-serif;\n  }\n\n  body {\n    background-color: var(--slate-100);\n    margin: 0;\n    font-family: var(--primary-font);\n    font-weight: 400;\n  }\n\n  input,\n  button {\n    font-family: var(--primary-font);\n  }\n\n  button {\n    background-color: var(--emerald-700);\n    border-radius: 4px;\n    color: white;\n    padding: 0.5rem;\n    font-weight: bold;\n    border: none;\n    cursor: pointer;\n\n    &:disabled {\n      background-color: var(--emerald-500);\n      cursor: not-allowed;\n    }\n  }\n"]))),rz=nz;var az=function(){var e=(0,t.useContext)(sw).currentUser;return(0,ow.jsxs)(Le,{children:[(0,ow.jsx)(rz,{}),(0,ow.jsx)(Ae,{children:(0,ow.jsxs)(Ne,{path:"/",children:[(0,ow.jsx)(Ne,{index:!0,element:(0,ow.jsx)(tz,{currentUser:e,children:(0,ow.jsx)(qV,{})})}),(0,ow.jsx)(Ne,{path:"login",element:(0,ow.jsx)(FS,{})}),(0,ow.jsx)(Ne,{path:"register",element:(0,ow.jsx)(MS,{})}),(0,ow.jsx)(Ne,{path:"about",element:(0,ow.jsx)(ez,{})})]})})]})};a.createRoot(document.getElementById("root")).render((0,ow.jsx)(t.StrictMode,{children:(0,ow.jsx)(uw,{children:(0,ow.jsx)(iC,{children:(0,ow.jsx)(az,{})})})}))}()}();
//# sourceMappingURL=main.fc2c3d18.js.map